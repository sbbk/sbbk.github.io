function t(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}function e(t){return t&&t.__esModule?t.default:t}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},r={},s=n.parcelRequire9a2a;null==s&&((s=function(t){if(t in i)return i[t].exports;if(t in r){var e=r[t];delete r[t];var n={id:t,exports:{}};return i[t]=n,e.call(n.exports,n,n.exports),n.exports}var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(t,e){r[t]=e},n.parcelRequire9a2a=s),s.register("27Lyk",(function(e,n){var i,r;t(e.exports,"register",(()=>i),(t=>i=t)),t(e.exports,"resolve",(()=>r),(t=>r=t));var s={};i=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)s[e[n]]=t[e[n]]},r=function(t){var e=s[t];if(null==e)throw new Error("Could not resolve bundle with id "+t);return e}})),s.register("02Ztr",(function(t,e){var n=s("gpDEB"),i=s("kzBhd"),r=s("72a6v"),o=s("dIU5s");t.exports=function(t,e){return n(t)||i(t,e)||r(t,e)||o()},t.exports.__esModule=!0,t.exports.default=t.exports})),s.register("gpDEB",(function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports})),s.register("kzBhd",(function(t,e){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return s}},t.exports.__esModule=!0,t.exports.default=t.exports})),s.register("72a6v",(function(t,e){var n=s("2zZPz");t.exports=function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports})),s.register("2zZPz",(function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports})),s.register("dIU5s",(function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports})),s.register("fu0YK",(function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports})),s.register("lR7jo",(function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports})),s.register("6KOho",(function(t,e){
/*!
 * jQuery JavaScript Library v3.6.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2022-08-26T17:52Z
 */
!function(e,n){"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:t.exports,(function(t,e){var n=[],i=Object.getPrototypeOf,r=n.slice,s=n.flat?function(t){return n.flat.call(t)}:function(t){return n.concat.apply([],t)},o=n.push,a=n.indexOf,u={},c=u.toString,l=u.hasOwnProperty,h=l.toString,d=h.call(Object),p={},f=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},g=function(t){return null!=t&&t===t.window},m=t.document,v={type:!0,src:!0,nonce:!0,noModule:!0};function y(t,e,n){var i,r,s=(n=n||m).createElement("script");if(s.text=t,e)for(i in v)(r=e[i]||e.getAttribute&&e.getAttribute(i))&&s.setAttribute(i,r);n.head.appendChild(s).parentNode.removeChild(s)}function _(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?u[c.call(t)]||"object":typeof t}var w="3.6.1",b=function(t,e){return new b.fn.init(t,e)};function x(t){var e=!!t&&"length"in t&&t.length,n=_(t);return!f(t)&&!g(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}b.fn=b.prototype={jquery:w,constructor:b,length:0,toArray:function(){return r.call(this)},get:function(t){return null==t?r.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=b.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return b.each(this,t)},map:function(t){return this.pushStack(b.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(b.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(b.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:n.sort,splice:n.splice},b.extend=b.fn.extend=function(){var t,e,n,i,r,s,o=arguments[0]||{},a=1,u=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[a]||{},a++),"object"==typeof o||f(o)||(o={}),a===u&&(o=this,a--);a<u;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&o!==i&&(c&&i&&(b.isPlainObject(i)||(r=Array.isArray(i)))?(n=o[e],s=r&&!Array.isArray(n)?[]:r||b.isPlainObject(n)?n:{},r=!1,o[e]=b.extend(c,s,i)):void 0!==i&&(o[e]=i));return o},b.extend({expando:"jQuery"+(w+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==c.call(t))&&(!(e=i(t))||"function"==typeof(n=l.call(e,"constructor")&&e.constructor)&&h.call(n)===d)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){y(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,i=0;if(x(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(x(Object(t))?b.merge(n,"string"==typeof t?[t]:t):o.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:a.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,s=t.length,o=!n;r<s;r++)!e(t[r],r)!==o&&i.push(t[r]);return i},map:function(t,e,n){var i,r,o=0,a=[];if(x(t))for(i=t.length;o<i;o++)null!=(r=e(t[o],o,n))&&a.push(r);else for(o in t)null!=(r=e(t[o],o,n))&&a.push(r);return s(a)},guid:1,support:p}),"function"==typeof Symbol&&(b.fn[Symbol.iterator]=n[Symbol.iterator]),b.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){u["[object "+e+"]"]=e.toLowerCase()}));var S=
/*!
 * Sizzle CSS Selector Engine v2.3.6
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2021-02-16
 */
function(t){var e,n,i,r,s,o,a,u,c,l,h,d,p,f,g,m,v,y,_,w="sizzle"+1*new Date,b=t.document,x=0,S=0,T=ut(),C=ut(),E=ut(),A=ut(),k=function(t,e){return t===e&&(h=!0),0},F={}.hasOwnProperty,P=[],R=P.pop,I=P.push,D=P.push,O=P.slice,M=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},N="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",j="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",B="\\[[\\x20\\t\\r\\n\\f]*("+j+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+j+"))|)"+L+"*\\]",U=":("+j+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",V=new RegExp(L+"+","g"),H=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),q=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),W=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),K=new RegExp(L+"|>"),z=new RegExp(U),J=new RegExp("^"+j+"$"),G={ID:new RegExp("^#("+j+")"),CLASS:new RegExp("^\\.("+j+")"),TAG:new RegExp("^("+j+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+N+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,$=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},st=function(){d()},ot=wt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{D.apply(P=O.call(b.childNodes),b.childNodes),P[b.childNodes.length].nodeType}catch(t){D={apply:P.length?function(t,e){I.apply(t,O.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function at(t,e,i,r){var s,a,c,l,h,f,v,y=e&&e.ownerDocument,b=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==b&&9!==b&&11!==b)return i;if(!r&&(d(e),e=e||p,g)){if(11!==b&&(h=Q.exec(t)))if(s=h[1]){if(9===b){if(!(c=e.getElementById(s)))return i;if(c.id===s)return i.push(c),i}else if(y&&(c=y.getElementById(s))&&_(e,c)&&c.id===s)return i.push(c),i}else{if(h[2])return D.apply(i,e.getElementsByTagName(t)),i;if((s=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return D.apply(i,e.getElementsByClassName(s)),i}if(n.qsa&&!A[t+" "]&&(!m||!m.test(t))&&(1!==b||"object"!==e.nodeName.toLowerCase())){if(v=t,y=e,1===b&&(K.test(t)||W.test(t))){for((y=tt.test(t)&&vt(e.parentNode)||e)===e&&n.scope||((l=e.getAttribute("id"))?l=l.replace(it,rt):e.setAttribute("id",l=w)),a=(f=o(t)).length;a--;)f[a]=(l?"#"+l:":scope")+" "+_t(f[a]);v=f.join(",")}try{return D.apply(i,y.querySelectorAll(v)),i}catch(e){A(t,!0)}finally{l===w&&e.removeAttribute("id")}}}return u(t.replace(H,"$1"),e,i,r)}function ut(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function ct(t){return t[w]=!0,t}function lt(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function dt(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ot(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return ct((function(e){return e=+e,ct((function(n,i){for(var r,s=t([],n.length,e),o=s.length;o--;)n[r=s[o]]&&(n[r]=!(i[r]=n[r]))}))}))}function vt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=at.support={},s=at.isXML=function(t){var e=t&&t.namespaceURI,n=t&&(t.ownerDocument||t).documentElement;return!Y.test(e||n&&n.nodeName||"HTML")},d=at.setDocument=function(t){var e,r,o=t?t.ownerDocument||t:b;return o!=p&&9===o.nodeType&&o.documentElement?(f=(p=o).documentElement,g=!s(p),b!=p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",st,!1):r.attachEvent&&r.attachEvent("onunload",st)),n.scope=lt((function(t){return f.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),n.attributes=lt((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=lt((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=Z.test(p.getElementsByClassName),n.getById=lt((function(t){return f.appendChild(t).id=w,!p.getElementsByName||!p.getElementsByName(w).length})),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,i,r,s=e.getElementById(t);if(s){if((n=s.getAttributeNode("id"))&&n.value===t)return[s];for(r=e.getElementsByName(t),i=0;s=r[i++];)if((n=s.getAttributeNode("id"))&&n.value===t)return[s]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,s=e.getElementsByTagName(t);if("*"===t){for(;n=s[r++];)1===n.nodeType&&i.push(n);return i}return s},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},v=[],m=[],(n.qsa=Z.test(p.querySelectorAll))&&(lt((function(t){var e;f.appendChild(t).innerHTML="<a id='"+w+"'></a><select id='"+w+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+N+")"),t.querySelectorAll("[id~="+w+"-]").length||m.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+w+"+*").length||m.push(".#.+[+~]"),t.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),lt((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Z.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&lt((function(t){n.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),v.push("!=",U)})),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),e=Z.test(f.compareDocumentPosition),_=e||Z.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},k=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t==p||t.ownerDocument==b&&_(b,t)?-1:e==p||e.ownerDocument==b&&_(b,e)?1:l?M(l,t)-M(l,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,i=0,r=t.parentNode,s=e.parentNode,o=[t],a=[e];if(!r||!s)return t==p?-1:e==p?1:r?-1:s?1:l?M(l,t)-M(l,e):0;if(r===s)return dt(t,e);for(n=t;n=n.parentNode;)o.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;o[i]===a[i];)i++;return i?dt(o[i],a[i]):o[i]==b?-1:a[i]==b?1:0},p):p},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(d(t),n.matchesSelector&&g&&!A[e+" "]&&(!v||!v.test(e))&&(!m||!m.test(e)))try{var i=y.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){A(e,!0)}return at(e,p,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!=p&&d(t),_(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=p&&d(t);var r=i.attrHandle[e.toLowerCase()],s=r&&F.call(i.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==s?s:n.attributes||!g?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},at.escape=function(t){return(t+"").replace(it,rt)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,i=[],r=0,s=0;if(h=!n.detectDuplicates,l=!n.sortStable&&t.slice(0),t.sort(k),h){for(;e=t[s++];)e===t[s]&&(r=i.push(s));for(;r--;)t.splice(i[r],1)}return l=null,t},r=at.getText=function(t){var e,n="",i=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},i=at.selectors={cacheLength:50,createPseudo:ct,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return G.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&z.test(n)&&(e=o(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=T[t+" "];return e||(e=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+t+"("+L+"|$)"),T(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})))},ATTR:function(t,e,n){return function(i){var r=at.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(V," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var s="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,u){var c,l,h,d,p,f,g=s!==o?"nextSibling":"previousSibling",m=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!u&&!a,_=!1;if(m){if(s){for(;g;){for(d=e;d=d[g];)if(a?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?m.firstChild:m.lastChild],o&&y){for(_=(p=(c=(l=(h=(d=m)[w]||(d[w]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===x&&c[1])&&c[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(_=p=0)||f.pop();)if(1===d.nodeType&&++_&&d===e){l[t]=[x,p,_];break}}else if(y&&(_=p=(c=(l=(h=(d=e)[w]||(d[w]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===x&&c[1]),!1===_)for(;(d=++p&&d&&d[g]||(_=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++_||(y&&((l=(h=d[w]||(d[w]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[x,_]),d!==e)););return(_-=r)===i||_%i==0&&_/i>=0}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return r[w]?r(e):r.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?ct((function(t,n){for(var i,s=r(t,e),o=s.length;o--;)t[i=M(t,s[o])]=!(n[i]=s[o])})):function(t){return r(t,0,n)}):r}},pseudos:{not:ct((function(t){var e=[],n=[],i=a(t.replace(H,"$1"));return i[w]?ct((function(t,e,n,r){for(var s,o=i(t,null,r,[]),a=t.length;a--;)(s=o[a])&&(t[a]=!(e[a]=s))})):function(t,r,s){return e[0]=t,i(e,null,s,n),e[0]=null,!n.pop()}})),has:ct((function(t){return function(e){return at(t,e).length>0}})),contains:ct((function(t){return t=t.replace(et,nt),function(e){return(e.textContent||r(e)).indexOf(t)>-1}})),lang:ct((function(t){return J.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return X.test(t.nodeName)},input:function(t){return $.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((function(){return[0]})),last:mt((function(t,e){return[e-1]})),eq:mt((function(t,e,n){return[n<0?n+e:n]})),even:mt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:mt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:mt((function(t,e,n){for(var i=n<0?n+e:n>e?e:n;--i>=0;)t.push(i);return t})),gt:mt((function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t}))}},i.pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ft(e);function yt(){}function _t(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function wt(t,e,n){var i=e.dir,r=e.next,s=r||i,o=n&&"parentNode"===s,a=S++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||o)return t(e,n,r);return!1}:function(e,n,u){var c,l,h,d=[x,a];if(u){for(;e=e[i];)if((1===e.nodeType||o)&&t(e,n,u))return!0}else for(;e=e[i];)if(1===e.nodeType||o)if(l=(h=e[w]||(e[w]={}))[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((c=l[s])&&c[0]===x&&c[1]===a)return d[2]=c[2];if(l[s]=d,d[2]=t(e,n,u))return!0}return!1}}function bt(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function xt(t,e,n,i,r){for(var s,o=[],a=0,u=t.length,c=null!=e;a<u;a++)(s=t[a])&&(n&&!n(s,i,r)||(o.push(s),c&&e.push(a)));return o}function St(t,e,n,i,r,s){return i&&!i[w]&&(i=St(i)),r&&!r[w]&&(r=St(r,s)),ct((function(s,o,a,u){var c,l,h,d=[],p=[],f=o.length,g=s||function(t,e,n){for(var i=0,r=e.length;i<r;i++)at(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),m=!t||!s&&e?g:xt(g,d,t,a,u),v=n?r||(s?t:f||i)?[]:o:m;if(n&&n(m,v,a,u),i)for(c=xt(v,p),i(c,[],a,u),l=c.length;l--;)(h=c[l])&&(v[p[l]]=!(m[p[l]]=h));if(s){if(r||t){if(r){for(c=[],l=v.length;l--;)(h=v[l])&&c.push(m[l]=h);r(null,v=[],c,u)}for(l=v.length;l--;)(h=v[l])&&(c=r?M(s,h):d[l])>-1&&(s[c]=!(o[c]=h))}}else v=xt(v===o?v.splice(f,v.length):v),r?r(null,o,v,u):D.apply(o,v)}))}function Tt(t){for(var e,n,r,s=t.length,o=i.relative[t[0].type],a=o||i.relative[" "],u=o?1:0,l=wt((function(t){return t===e}),a,!0),h=wt((function(t){return M(e,t)>-1}),a,!0),d=[function(t,n,i){var r=!o&&(i||n!==c)||((e=n).nodeType?l(t,n,i):h(t,n,i));return e=null,r}];u<s;u++)if(n=i.relative[t[u].type])d=[wt(bt(d),n)];else{if((n=i.filter[t[u].type].apply(null,t[u].matches))[w]){for(r=++u;r<s&&!i.relative[t[r].type];r++);return St(u>1&&bt(d),u>1&&_t(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(H,"$1"),n,u<r&&Tt(t.slice(u,r)),r<s&&Tt(t=t.slice(r)),r<s&&_t(t))}d.push(n)}return bt(d)}return yt.prototype=i.filters=i.pseudos,i.setFilters=new yt,o=at.tokenize=function(t,e){var n,r,s,o,a,u,c,l=C[t+" "];if(l)return e?0:l.slice(0);for(a=t,u=[],c=i.preFilter;a;){for(o in n&&!(r=q.exec(a))||(r&&(a=a.slice(r[0].length)||a),u.push(s=[])),n=!1,(r=W.exec(a))&&(n=r.shift(),s.push({value:n,type:r[0].replace(H," ")}),a=a.slice(n.length)),i.filter)!(r=G[o].exec(a))||c[o]&&!(r=c[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?at.error(t):C(t,u).slice(0)},a=at.compile=function(t,e){var n,r=[],s=[],a=E[t+" "];if(!a){for(e||(e=o(t)),n=e.length;n--;)(a=Tt(e[n]))[w]?r.push(a):s.push(a);a=E(t,function(t,e){var n=e.length>0,r=t.length>0,s=function(s,o,a,u,l){var h,f,m,v=0,y="0",_=s&&[],w=[],b=c,S=s||r&&i.find.TAG("*",l),T=x+=null==b?1:Math.random()||.1,C=S.length;for(l&&(c=o==p||o||l);y!==C&&null!=(h=S[y]);y++){if(r&&h){for(f=0,o||h.ownerDocument==p||(d(h),a=!g);m=t[f++];)if(m(h,o||p,a)){u.push(h);break}l&&(x=T)}n&&((h=!m&&h)&&v--,s&&_.push(h))}if(v+=y,n&&y!==v){for(f=0;m=e[f++];)m(_,w,o,a);if(s){if(v>0)for(;y--;)_[y]||w[y]||(w[y]=R.call(u));w=xt(w)}D.apply(u,w),l&&!s&&w.length>0&&v+e.length>1&&at.uniqueSort(u)}return l&&(x=T,c=b),_};return n?ct(s):s}(s,r)),a.selector=t}return a},u=at.select=function(t,e,n,r){var s,u,c,l,h,d="function"==typeof t&&t,p=!r&&o(t=d.selector||t);if(n=n||[],1===p.length){if((u=p[0]=p[0].slice(0)).length>2&&"ID"===(c=u[0]).type&&9===e.nodeType&&g&&i.relative[u[1].type]){if(!(e=(i.find.ID(c.matches[0].replace(et,nt),e)||[])[0]))return n;d&&(e=e.parentNode),t=t.slice(u.shift().value.length)}for(s=G.needsContext.test(t)?0:u.length;s--&&(c=u[s],!i.relative[l=c.type]);)if((h=i.find[l])&&(r=h(c.matches[0].replace(et,nt),tt.test(u[0].type)&&vt(e.parentNode)||e))){if(u.splice(s,1),!(t=r.length&&_t(u)))return D.apply(n,r),n;break}}return(d||a(t,p))(r,e,!g,n,!e||tt.test(t)&&vt(e.parentNode)||e),n},n.sortStable=w.split("").sort(k).join("")===w,n.detectDuplicates=!!h,d(),n.sortDetached=lt((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),lt((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&lt((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),lt((function(t){return null==t.getAttribute("disabled")}))||ht(N,(function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),at}(t);b.find=S,b.expr=S.selectors,b.expr[":"]=b.expr.pseudos,b.uniqueSort=b.unique=S.uniqueSort,b.text=S.getText,b.isXMLDoc=S.isXML,b.contains=S.contains,b.escapeSelector=S.escape;var T=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&b(t).is(n))break;i.push(t)}return i},C=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},E=b.expr.match.needsContext;function A(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var k=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function F(t,e,n){return f(e)?b.grep(t,(function(t,i){return!!e.call(t,i,t)!==n})):e.nodeType?b.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?b.grep(t,(function(t){return a.call(e,t)>-1!==n})):b.filter(e,t,n)}b.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?b.find.matchesSelector(i,t)?[i]:[]:b.find.matches(t,b.grep(e,(function(t){return 1===t.nodeType})))},b.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(b(t).filter((function(){for(e=0;e<i;e++)if(b.contains(r[e],this))return!0})));for(n=this.pushStack([]),e=0;e<i;e++)b.find(t,r[e],n);return i>1?b.uniqueSort(n):n},filter:function(t){return this.pushStack(F(this,t||[],!1))},not:function(t){return this.pushStack(F(this,t||[],!0))},is:function(t){return!!F(this,"string"==typeof t&&E.test(t)?b(t):t||[],!1).length}});var P,R=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(b.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||P,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:R.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof b?e[0]:e,b.merge(this,b.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:m,!0)),k.test(i[1])&&b.isPlainObject(e))for(i in e)f(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=m.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):f(t)?void 0!==n.ready?n.ready(t):t(b):b.makeArray(t,this)}).prototype=b.fn,P=b(m);var I=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};function O(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}b.fn.extend({has:function(t){var e=b(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(b.contains(this,e[t]))return!0}))},closest:function(t,e){var n,i=0,r=this.length,s=[],o="string"!=typeof t&&b(t);if(!E.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&b.find.matchesSelector(n,t))){s.push(n);break}return this.pushStack(s.length>1?b.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?a.call(b(t),this[0]):a.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(b.uniqueSort(b.merge(this.get(),b(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),b.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return T(t,"parentNode")},parentsUntil:function(t,e,n){return T(t,"parentNode",n)},next:function(t){return O(t,"nextSibling")},prev:function(t){return O(t,"previousSibling")},nextAll:function(t){return T(t,"nextSibling")},prevAll:function(t){return T(t,"previousSibling")},nextUntil:function(t,e,n){return T(t,"nextSibling",n)},prevUntil:function(t,e,n){return T(t,"previousSibling",n)},siblings:function(t){return C((t.parentNode||{}).firstChild,t)},children:function(t){return C(t.firstChild)},contents:function(t){return null!=t.contentDocument&&i(t.contentDocument)?t.contentDocument:(A(t,"template")&&(t=t.content||t),b.merge([],t.childNodes))}},(function(t,e){b.fn[t]=function(n,i){var r=b.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=b.filter(i,r)),this.length>1&&(D[t]||b.uniqueSort(r),I.test(t)&&r.reverse()),this.pushStack(r)}}));var M=/[^\x20\t\r\n\f]+/g;function N(t){return t}function L(t){throw t}function j(t,e,n,i){var r;try{t&&f(r=t.promise)?r.call(t).done(e).fail(n):t&&f(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}b.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return b.each(t.match(M)||[],(function(t,n){e[n]=!0})),e}(t):b.extend({},t);var e,n,i,r,s=[],o=[],a=-1,u=function(){for(r=r||t.once,i=e=!0;o.length;a=-1)for(n=o.shift();++a<s.length;)!1===s[a].apply(n[0],n[1])&&t.stopOnFalse&&(a=s.length,n=!1);t.memory||(n=!1),e=!1,r&&(s=n?[]:"")},c={add:function(){return s&&(n&&!e&&(a=s.length-1,o.push(n)),function e(n){b.each(n,(function(n,i){f(i)?t.unique&&c.has(i)||s.push(i):i&&i.length&&"string"!==_(i)&&e(i)}))}(arguments),n&&!e&&u()),this},remove:function(){return b.each(arguments,(function(t,e){for(var n;(n=b.inArray(e,s,n))>-1;)s.splice(n,1),n<=a&&a--})),this},has:function(t){return t?b.inArray(t,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return r=o=[],s=n="",this},disabled:function(){return!s},lock:function(){return r=o=[],n||e||(s=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],o.push(n),e||u()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},b.extend({Deferred:function(e){var n=[["notify","progress",b.Callbacks("memory"),b.Callbacks("memory"),2],["resolve","done",b.Callbacks("once memory"),b.Callbacks("once memory"),0,"resolved"],["reject","fail",b.Callbacks("once memory"),b.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return b.Deferred((function(e){b.each(n,(function(n,i){var r=f(t[i[4]])&&t[i[4]];s[i[1]]((function(){var t=r&&r.apply(this,arguments);t&&f(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[i[0]+"With"](this,r?[t]:arguments)}))})),t=null})).promise()},then:function(e,i,r){var s=0;function o(e,n,i,r){return function(){var a=this,u=arguments,c=function(){var t,c;if(!(e<s)){if((t=i.apply(a,u))===n.promise())throw new TypeError("Thenable self-resolution");c=t&&("object"==typeof t||"function"==typeof t)&&t.then,f(c)?r?c.call(t,o(s,n,N,r),o(s,n,L,r)):(s++,c.call(t,o(s,n,N,r),o(s,n,L,r),o(s,n,N,n.notifyWith))):(i!==N&&(a=void 0,u=[t]),(r||n.resolveWith)(a,u))}},l=r?c:function(){try{c()}catch(t){b.Deferred.exceptionHook&&b.Deferred.exceptionHook(t,l.stackTrace),e+1>=s&&(i!==L&&(a=void 0,u=[t]),n.rejectWith(a,u))}};e?l():(b.Deferred.getStackHook&&(l.stackTrace=b.Deferred.getStackHook()),t.setTimeout(l))}}return b.Deferred((function(t){n[0][3].add(o(0,t,f(r)?r:N,t.notifyWith)),n[1][3].add(o(0,t,f(e)?e:N)),n[2][3].add(o(0,t,f(i)?i:L))})).promise()},promise:function(t){return null!=t?b.extend(t,r):r}},s={};return b.each(n,(function(t,e){var o=e[2],a=e[5];r[e[1]]=o.add,a&&o.add((function(){i=a}),n[3-t][2].disable,n[3-t][3].disable,n[0][2].lock,n[0][3].lock),o.add(e[3].fire),s[e[0]]=function(){return s[e[0]+"With"](this===s?void 0:this,arguments),this},s[e[0]+"With"]=o.fireWith})),r.promise(s),e&&e.call(s,s),s},when:function(t){var e=arguments.length,n=e,i=Array(n),s=r.call(arguments),o=b.Deferred(),a=function(t){return function(n){i[t]=this,s[t]=arguments.length>1?r.call(arguments):n,--e||o.resolveWith(i,s)}};if(e<=1&&(j(t,o.done(a(n)).resolve,o.reject,!e),"pending"===o.state()||f(s[n]&&s[n].then)))return o.then();for(;n--;)j(s[n],a(n),o.reject);return o.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;b.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&B.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},b.readyException=function(e){t.setTimeout((function(){throw e}))};var U=b.Deferred();function V(){m.removeEventListener("DOMContentLoaded",V),t.removeEventListener("load",V),b.ready()}b.fn.ready=function(t){return U.then(t).catch((function(t){b.readyException(t)})),this},b.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--b.readyWait:b.isReady)||(b.isReady=!0,!0!==t&&--b.readyWait>0||U.resolveWith(m,[b]))}}),b.ready.then=U.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?t.setTimeout(b.ready):(m.addEventListener("DOMContentLoaded",V),t.addEventListener("load",V));var H=function(t,e,n,i,r,s,o){var a=0,u=t.length,c=null==n;if("object"===_(n))for(a in r=!0,n)H(t,e,a,n[a],!0,s,o);else if(void 0!==i&&(r=!0,f(i)||(o=!0),c&&(o?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(b(t),n)})),e))for(;a<u;a++)e(t[a],n,o?i:i.call(t[a],a,e(t[a],n)));return r?t:c?e.call(t):u?e(t[0],n):s},q=/^-ms-/,W=/-([a-z])/g;function K(t,e){return e.toUpperCase()}function z(t){return t.replace(q,"ms-").replace(W,K)}var J=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function G(){this.expando=b.expando+G.uid++}G.uid=1,G.prototype={cache:function(t){var e=t[this.expando];return e||(e={},J(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[z(e)]=n;else for(i in e)r[z(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][z(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(z):(e=z(e))in i?[e]:e.match(M)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||b.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!b.isEmptyObject(e)}};var Y=new G,$=new G,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z=/[A-Z]/g;function Q(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(Z,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:X.test(t)?JSON.parse(t):t)}(n)}catch(t){}$.set(t,e,n)}else n=void 0;return n}b.extend({hasData:function(t){return $.hasData(t)||Y.hasData(t)},data:function(t,e,n){return $.access(t,e,n)},removeData:function(t,e){$.remove(t,e)},_data:function(t,e,n){return Y.access(t,e,n)},_removeData:function(t,e){Y.remove(t,e)}}),b.fn.extend({data:function(t,e){var n,i,r,s=this[0],o=s&&s.attributes;if(void 0===t){if(this.length&&(r=$.get(s),1===s.nodeType&&!Y.get(s,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(i=o[n].name).indexOf("data-")&&(i=z(i.slice(5)),Q(s,i,r[i]));Y.set(s,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){$.set(this,t)})):H(this,(function(e){var n;if(s&&void 0===e)return void 0!==(n=$.get(s,t))||void 0!==(n=Q(s,t))?n:void 0;this.each((function(){$.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){$.remove(this,t)}))}}),b.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=Y.get(t,e),n&&(!i||Array.isArray(n)?i=Y.access(t,e,b.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=b.queue(t,e),i=n.length,r=n.shift(),s=b._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete s.stop,r.call(t,(function(){b.dequeue(t,e)}),s)),!i&&s&&s.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Y.get(t,n)||Y.access(t,n,{empty:b.Callbacks("once memory").add((function(){Y.remove(t,[e+"queue",n])}))})}}),b.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?b.queue(this[0],t):void 0===e?this:this.each((function(){var n=b.queue(this,t,e);b._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&b.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){b.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=b.Deferred(),s=this,o=this.length,a=function(){--i||r.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)(n=Y.get(s[o],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),nt=["Top","Right","Bottom","Left"],it=m.documentElement,rt=function(t){return b.contains(t.ownerDocument,t)},st={composed:!0};it.getRootNode&&(rt=function(t){return b.contains(t.ownerDocument,t)||t.getRootNode(st)===t.ownerDocument});var ot=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&rt(t)&&"none"===b.css(t,"display")};function at(t,e,n,i){var r,s,o=20,a=i?function(){return i.cur()}:function(){return b.css(t,e,"")},u=a(),c=n&&n[3]||(b.cssNumber[e]?"":"px"),l=t.nodeType&&(b.cssNumber[e]||"px"!==c&&+u)&&et.exec(b.css(t,e));if(l&&l[3]!==c){for(u/=2,c=c||l[3],l=+u||1;o--;)b.style(t,e,l+c),(1-s)*(1-(s=a()/u||.5))<=0&&(o=0),l/=s;l*=2,b.style(t,e,l+c),n=n||[]}return n&&(l=+l||+u||0,r=n[1]?l+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=l,i.end=r)),r}var ut={};function ct(t){var e,n=t.ownerDocument,i=t.nodeName,r=ut[i];return r||(e=n.body.appendChild(n.createElement(i)),r=b.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ut[i]=r,r)}function lt(t,e){for(var n,i,r=[],s=0,o=t.length;s<o;s++)(i=t[s]).style&&(n=i.style.display,e?("none"===n&&(r[s]=Y.get(i,"display")||null,r[s]||(i.style.display="")),""===i.style.display&&ot(i)&&(r[s]=ct(i))):"none"!==n&&(r[s]="none",Y.set(i,"display",n)));for(s=0;s<o;s++)null!=r[s]&&(t[s].style.display=r[s]);return t}b.fn.extend({show:function(){return lt(this,!0)},hide:function(){return lt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ot(this)?b(this).show():b(this).hide()}))}});var ht,dt,pt=/^(?:checkbox|radio)$/i,ft=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,gt=/^$|^module$|\/(?:java|ecma)script/i;ht=m.createDocumentFragment().appendChild(m.createElement("div")),(dt=m.createElement("input")).setAttribute("type","radio"),dt.setAttribute("checked","checked"),dt.setAttribute("name","t"),ht.appendChild(dt),p.checkClone=ht.cloneNode(!0).cloneNode(!0).lastChild.checked,ht.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!ht.cloneNode(!0).lastChild.defaultValue,ht.innerHTML="<option></option>",p.option=!!ht.lastChild;var mt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function vt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&A(t,e)?b.merge([t],n):n}function yt(t,e){for(var n=0,i=t.length;n<i;n++)Y.set(t[n],"globalEval",!e||Y.get(e[n],"globalEval"))}mt.tbody=mt.tfoot=mt.colgroup=mt.caption=mt.thead,mt.th=mt.td,p.option||(mt.optgroup=mt.option=[1,"<select multiple='multiple'>","</select>"]);var _t=/<|&#?\w+;/;function wt(t,e,n,i,r){for(var s,o,a,u,c,l,h=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((s=t[p])||0===s)if("object"===_(s))b.merge(d,s.nodeType?[s]:s);else if(_t.test(s)){for(o=o||h.appendChild(e.createElement("div")),a=(ft.exec(s)||["",""])[1].toLowerCase(),u=mt[a]||mt._default,o.innerHTML=u[1]+b.htmlPrefilter(s)+u[2],l=u[0];l--;)o=o.lastChild;b.merge(d,o.childNodes),(o=h.firstChild).textContent=""}else d.push(e.createTextNode(s));for(h.textContent="",p=0;s=d[p++];)if(i&&b.inArray(s,i)>-1)r&&r.push(s);else if(c=rt(s),o=vt(h.appendChild(s),"script"),c&&yt(o),n)for(l=0;s=o[l++];)gt.test(s.type||"")&&n.push(s);return h}var bt=/^([^.]*)(?:\.(.+)|)/;function xt(){return!0}function St(){return!1}function Tt(t,e){return t===function(){try{return m.activeElement}catch(t){}}()==("focus"===e)}function Ct(t,e,n,i,r,s){var o,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=void 0),e)Ct(t,a,n,i,e[a],s);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=St;else if(!r)return t;return 1===s&&(o=r,r=function(t){return b().off(t),o.apply(this,arguments)},r.guid=o.guid||(o.guid=b.guid++)),t.each((function(){b.event.add(this,e,r,i,n)}))}function Et(t,e,n){n?(Y.set(t,e,!1),b.event.add(t,e,{namespace:!1,handler:function(t){var i,s,o=Y.get(this,e);if(1&t.isTrigger&&this[e]){if(o.length)(b.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=r.call(arguments),Y.set(this,e,o),i=n(this,e),this[e](),o!==(s=Y.get(this,e))||i?Y.set(this,e,!1):s={},o!==s)return t.stopImmediatePropagation(),t.preventDefault(),s&&s.value}else o.length&&(Y.set(this,e,{value:b.event.trigger(b.extend(o[0],b.Event.prototype),o.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Y.get(t,e)&&b.event.add(t,e,xt)}b.event={global:{},add:function(t,e,n,i,r){var s,o,a,u,c,l,h,d,p,f,g,m=Y.get(t);if(J(t))for(n.handler&&(n=(s=n).handler,r=s.selector),r&&b.find.matchesSelector(it,r),n.guid||(n.guid=b.guid++),(u=m.events)||(u=m.events=Object.create(null)),(o=m.handle)||(o=m.handle=function(e){return void 0!==b&&b.event.triggered!==e.type?b.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(M)||[""]).length;c--;)p=g=(a=bt.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p&&(h=b.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=b.event.special[p]||{},l=b.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&b.expr.match.needsContext.test(r),namespace:f.join(".")},s),(d=u[p])||((d=u[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,f,o)||t.addEventListener&&t.addEventListener(p,o)),h.add&&(h.add.call(t,l),l.handler.guid||(l.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,l):d.push(l),b.event.global[p]=!0)},remove:function(t,e,n,i,r){var s,o,a,u,c,l,h,d,p,f,g,m=Y.hasData(t)&&Y.get(t);if(m&&(u=m.events)){for(c=(e=(e||"").match(M)||[""]).length;c--;)if(p=g=(a=bt.exec(e[c])||[])[1],f=(a[2]||"").split(".").sort(),p){for(h=b.event.special[p]||{},d=u[p=(i?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=d.length;s--;)l=d[s],!r&&g!==l.origType||n&&n.guid!==l.guid||a&&!a.test(l.namespace)||i&&i!==l.selector&&("**"!==i||!l.selector)||(d.splice(s,1),l.selector&&d.delegateCount--,h.remove&&h.remove.call(t,l));o&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,f,m.handle)||b.removeEvent(t,p,m.handle),delete u[p])}else for(p in u)b.event.remove(t,p+e[c],n,i,!0);b.isEmptyObject(u)&&Y.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,s,o,a=new Array(arguments.length),u=b.event.fix(t),c=(Y.get(this,"events")||Object.create(null))[u.type]||[],l=b.event.special[u.type]||{};for(a[0]=u,e=1;e<arguments.length;e++)a[e]=arguments[e];if(u.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,u)){for(o=b.event.handlers.call(this,u,c),e=0;(r=o[e++])&&!u.isPropagationStopped();)for(u.currentTarget=r.elem,n=0;(s=r.handlers[n++])&&!u.isImmediatePropagationStopped();)u.rnamespace&&!1!==s.namespace&&!u.rnamespace.test(s.namespace)||(u.handleObj=s,u.data=s.data,void 0!==(i=((b.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,a))&&!1===(u.result=i)&&(u.preventDefault(),u.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,u),u.result}},handlers:function(t,e){var n,i,r,s,o,a=[],u=e.delegateCount,c=t.target;if(u&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(s=[],o={},n=0;n<u;n++)void 0===o[r=(i=e[n]).selector+" "]&&(o[r]=i.needsContext?b(r,this).index(c)>-1:b.find(r,this,null,[c]).length),o[r]&&s.push(i);s.length&&a.push({elem:c,handlers:s})}return c=this,u<e.length&&a.push({elem:c,handlers:e.slice(u)}),a},addProp:function(t,e){Object.defineProperty(b.Event.prototype,t,{enumerable:!0,configurable:!0,get:f(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[b.expando]?t:new b.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return pt.test(e.type)&&e.click&&A(e,"input")&&Et(e,"click",xt),!1},trigger:function(t){var e=this||t;return pt.test(e.type)&&e.click&&A(e,"input")&&Et(e,"click"),!0},_default:function(t){var e=t.target;return pt.test(e.type)&&e.click&&A(e,"input")&&Y.get(e,"click")||A(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},b.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},b.Event=function(t,e){if(!(this instanceof b.Event))return new b.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?xt:St,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&b.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[b.expando]=!0},b.Event.prototype={constructor:b.Event,isDefaultPrevented:St,isPropagationStopped:St,isImmediatePropagationStopped:St,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=xt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=xt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=xt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},b.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},b.event.addProp),b.each({focus:"focusin",blur:"focusout"},(function(t,e){b.event.special[t]={setup:function(){return Et(this,t,Tt),!1},trigger:function(){return Et(this,t),!0},_default:function(e){return Y.get(e.target,t)},delegateType:e}})),b.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){b.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,s=t.handleObj;return r&&(r===i||b.contains(i,r))||(t.type=s.origType,n=s.handler.apply(this,arguments),t.type=e),n}}})),b.fn.extend({on:function(t,e,n,i){return Ct(this,t,e,n,i)},one:function(t,e,n,i){return Ct(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,b(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=St),this.each((function(){b.event.remove(this,t,n,e)}))}});var At=/<script|<style|<link/i,kt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ft=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Pt(t,e){return A(t,"table")&&A(11!==e.nodeType?e:e.firstChild,"tr")&&b(t).children("tbody")[0]||t}function Rt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function It(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Dt(t,e){var n,i,r,s,o,a;if(1===e.nodeType){if(Y.hasData(t)&&(a=Y.get(t).events))for(r in Y.remove(e,"handle events"),a)for(n=0,i=a[r].length;n<i;n++)b.event.add(e,r,a[r][n]);$.hasData(t)&&(s=$.access(t),o=b.extend({},s),$.set(e,o))}}function Ot(t,e){var n=e.nodeName.toLowerCase();"input"===n&&pt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function Mt(t,e,n,i){e=s(e);var r,o,a,u,c,l,h=0,d=t.length,g=d-1,m=e[0],v=f(m);if(v||d>1&&"string"==typeof m&&!p.checkClone&&kt.test(m))return t.each((function(r){var s=t.eq(r);v&&(e[0]=m.call(this,r,s.html())),Mt(s,e,n,i)}));if(d&&(o=(r=wt(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(u=(a=b.map(vt(r,"script"),Rt)).length;h<d;h++)c=r,h!==g&&(c=b.clone(c,!0,!0),u&&b.merge(a,vt(c,"script"))),n.call(t[h],c,h);if(u)for(l=a[a.length-1].ownerDocument,b.map(a,It),h=0;h<u;h++)c=a[h],gt.test(c.type||"")&&!Y.access(c,"globalEval")&&b.contains(l,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?b._evalUrl&&!c.noModule&&b._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},l):y(c.textContent.replace(Ft,""),c,l))}return t}function Nt(t,e,n){for(var i,r=e?b.filter(e,t):t,s=0;null!=(i=r[s]);s++)n||1!==i.nodeType||b.cleanData(vt(i)),i.parentNode&&(n&&rt(i)&&yt(vt(i,"script")),i.parentNode.removeChild(i));return t}b.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var i,r,s,o,a=t.cloneNode(!0),u=rt(t);if(!(p.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||b.isXMLDoc(t)))for(o=vt(a),i=0,r=(s=vt(t)).length;i<r;i++)Ot(s[i],o[i]);if(e)if(n)for(s=s||vt(t),o=o||vt(a),i=0,r=s.length;i<r;i++)Dt(s[i],o[i]);else Dt(t,a);return(o=vt(a,"script")).length>0&&yt(o,!u&&vt(t,"script")),a},cleanData:function(t){for(var e,n,i,r=b.event.special,s=0;void 0!==(n=t[s]);s++)if(J(n)){if(e=n[Y.expando]){if(e.events)for(i in e.events)r[i]?b.event.remove(n,i):b.removeEvent(n,i,e.handle);n[Y.expando]=void 0}n[$.expando]&&(n[$.expando]=void 0)}}}),b.fn.extend({detach:function(t){return Nt(this,t,!0)},remove:function(t){return Nt(this,t)},text:function(t){return H(this,(function(t){return void 0===t?b.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Mt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Pt(this,t).appendChild(t)}))},prepend:function(){return Mt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Pt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Mt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Mt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(b.cleanData(vt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return b.clone(this,t,e)}))},html:function(t){return H(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!At.test(t)&&!mt[(ft.exec(t)||["",""])[1].toLowerCase()]){t=b.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(b.cleanData(vt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Mt(this,arguments,(function(e){var n=this.parentNode;b.inArray(this,t)<0&&(b.cleanData(vt(this)),n&&n.replaceChild(e,this))}),t)}}),b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){b.fn[t]=function(t){for(var n,i=[],r=b(t),s=r.length-1,a=0;a<=s;a++)n=a===s?this:this.clone(!0),b(r[a])[e](n),o.apply(i,n.get());return this.pushStack(i)}}));var Lt=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),jt=/^--/,Bt=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},Ut=function(t,e,n){var i,r,s={};for(r in e)s[r]=t.style[r],t.style[r]=e[r];for(r in i=n.call(t),e)t.style[r]=s[r];return i},Vt=new RegExp(nt.join("|"),"i"),Ht=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g");function qt(t,e,n){var i,r,s,o,a=jt.test(e),u=t.style;return(n=n||Bt(t))&&(o=n.getPropertyValue(e)||n[e],a&&(o=o.replace(Ht,"$1")),""!==o||rt(t)||(o=b.style(t,e)),!p.pixelBoxStyles()&&Lt.test(o)&&Vt.test(e)&&(i=u.width,r=u.minWidth,s=u.maxWidth,u.minWidth=u.maxWidth=u.width=o,o=n.width,u.width=i,u.minWidth=r,u.maxWidth=s)),void 0!==o?o+"":o}function Wt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",it.appendChild(c).appendChild(l);var e=t.getComputedStyle(l);i="1%"!==e.top,u=12===n(e.marginLeft),l.style.right="60%",o=36===n(e.right),r=36===n(e.width),l.style.position="absolute",s=12===n(l.offsetWidth/3),it.removeChild(c),l=null}}function n(t){return Math.round(parseFloat(t))}var i,r,s,o,a,u,c=m.createElement("div"),l=m.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===l.style.backgroundClip,b.extend(p,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),u},scrollboxSize:function(){return e(),s},reliableTrDimensions:function(){var e,n,i,r;return null==a&&(e=m.createElement("table"),n=m.createElement("tr"),i=m.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="border:1px solid",n.style.height="1px",i.style.height="9px",i.style.display="block",it.appendChild(e).appendChild(n).appendChild(i),r=t.getComputedStyle(n),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===n.offsetHeight,it.removeChild(e)),a}}))}();var Kt=["Webkit","Moz","ms"],zt=m.createElement("div").style,Jt={};function Gt(t){var e=b.cssProps[t]||Jt[t];return e||(t in zt?t:Jt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Kt.length;n--;)if((t=Kt[n]+e)in zt)return t}(t)||t)}var Yt=/^(none|table(?!-c[ea]).+)/,$t={position:"absolute",visibility:"hidden",display:"block"},Xt={letterSpacing:"0",fontWeight:"400"};function Zt(t,e,n){var i=et.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function Qt(t,e,n,i,r,s){var o="width"===e?1:0,a=0,u=0;if(n===(i?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(u+=b.css(t,n+nt[o],!0,r)),i?("content"===n&&(u-=b.css(t,"padding"+nt[o],!0,r)),"margin"!==n&&(u-=b.css(t,"border"+nt[o]+"Width",!0,r))):(u+=b.css(t,"padding"+nt[o],!0,r),"padding"!==n?u+=b.css(t,"border"+nt[o]+"Width",!0,r):a+=b.css(t,"border"+nt[o]+"Width",!0,r));return!i&&s>=0&&(u+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-s-u-a-.5))||0),u}function te(t,e,n){var i=Bt(t),r=(!p.boxSizingReliable()||n)&&"border-box"===b.css(t,"boxSizing",!1,i),s=r,o=qt(t,e,i),a="offset"+e[0].toUpperCase()+e.slice(1);if(Lt.test(o)){if(!n)return o;o="auto"}return(!p.boxSizingReliable()&&r||!p.reliableTrDimensions()&&A(t,"tr")||"auto"===o||!parseFloat(o)&&"inline"===b.css(t,"display",!1,i))&&t.getClientRects().length&&(r="border-box"===b.css(t,"boxSizing",!1,i),(s=a in t)&&(o=t[a])),(o=parseFloat(o)||0)+Qt(t,e,n||(r?"border":"content"),s,i,o)+"px"}function ee(t,e,n,i,r){return new ee.prototype.init(t,e,n,i,r)}b.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=qt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,o,a=z(e),u=jt.test(e),c=t.style;if(u||(e=Gt(a)),o=b.cssHooks[e]||b.cssHooks[a],void 0===n)return o&&"get"in o&&void 0!==(r=o.get(t,!1,i))?r:c[e];"string"===(s=typeof n)&&(r=et.exec(n))&&r[1]&&(n=at(t,e,r),s="number"),null!=n&&n==n&&("number"!==s||u||(n+=r&&r[3]||(b.cssNumber[a]?"":"px")),p.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),o&&"set"in o&&void 0===(n=o.set(t,n,i))||(u?c.setProperty(e,n):c[e]=n))}},css:function(t,e,n,i){var r,s,o,a=z(e);return jt.test(e)||(e=Gt(a)),(o=b.cssHooks[e]||b.cssHooks[a])&&"get"in o&&(r=o.get(t,!0,n)),void 0===r&&(r=qt(t,e,i)),"normal"===r&&e in Xt&&(r=Xt[e]),""===n||n?(s=parseFloat(r),!0===n||isFinite(s)?s||0:r):r}}),b.each(["height","width"],(function(t,e){b.cssHooks[e]={get:function(t,n,i){if(n)return!Yt.test(b.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?te(t,e,i):Ut(t,$t,(function(){return te(t,e,i)}))},set:function(t,n,i){var r,s=Bt(t),o=!p.scrollboxSize()&&"absolute"===s.position,a=(o||i)&&"border-box"===b.css(t,"boxSizing",!1,s),u=i?Qt(t,e,i,a,s):0;return a&&o&&(u-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-Qt(t,e,"border",!1,s)-.5)),u&&(r=et.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=b.css(t,e)),Zt(0,n,u)}}})),b.cssHooks.marginLeft=Wt(p.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(qt(t,"marginLeft"))||t.getBoundingClientRect().left-Ut(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),b.each({margin:"",padding:"",border:"Width"},(function(t,e){b.cssHooks[t+e]={expand:function(n){for(var i=0,r={},s="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+nt[i]+e]=s[i]||s[i-2]||s[0];return r}},"margin"!==t&&(b.cssHooks[t+e].set=Zt)})),b.fn.extend({css:function(t,e){return H(this,(function(t,e,n){var i,r,s={},o=0;if(Array.isArray(e)){for(i=Bt(t),r=e.length;o<r;o++)s[e[o]]=b.css(t,e[o],!1,i);return s}return void 0!==n?b.style(t,e,n):b.css(t,e)}),t,e,arguments.length>1)}}),b.Tween=ee,ee.prototype={constructor:ee,init:function(t,e,n,i,r,s){this.elem=t,this.prop=n,this.easing=r||b.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=s||(b.cssNumber[n]?"":"px")},cur:function(){var t=ee.propHooks[this.prop];return t&&t.get?t.get(this):ee.propHooks._default.get(this)},run:function(t){var e,n=ee.propHooks[this.prop];return this.options.duration?this.pos=e=b.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ee.propHooks._default.set(this),this}},ee.prototype.init.prototype=ee.prototype,ee.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=b.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){b.fx.step[t.prop]?b.fx.step[t.prop](t):1!==t.elem.nodeType||!b.cssHooks[t.prop]&&null==t.elem.style[Gt(t.prop)]?t.elem[t.prop]=t.now:b.style(t.elem,t.prop,t.now+t.unit)}}},ee.propHooks.scrollTop=ee.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},b.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},b.fx=ee.prototype.init,b.fx.step={};var ne,ie,re=/^(?:toggle|show|hide)$/,se=/queueHooks$/;function oe(){ie&&(!1===m.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(oe):t.setTimeout(oe,b.fx.interval),b.fx.tick())}function ae(){return t.setTimeout((function(){ne=void 0})),ne=Date.now()}function ue(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=nt[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function ce(t,e,n){for(var i,r=(le.tweeners[e]||[]).concat(le.tweeners["*"]),s=0,o=r.length;s<o;s++)if(i=r[s].call(n,e,t))return i}function le(t,e,n){var i,r,s=0,o=le.prefilters.length,a=b.Deferred().always((function(){delete u.elem})),u=function(){if(r)return!1;for(var e=ne||ae(),n=Math.max(0,c.startTime+c.duration-e),i=1-(n/c.duration||0),s=0,o=c.tweens.length;s<o;s++)c.tweens[s].run(i);return a.notifyWith(t,[c,i,n]),i<1&&o?n:(o||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:b.extend({},e),opts:b.extend(!0,{specialEasing:{},easing:b.easing._default},n),originalProperties:e,originalOptions:n,startTime:ne||ae(),duration:n.duration,tweens:[],createTween:function(e,n){var i=b.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)c.tweens[n].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),l=c.props;for(!function(t,e){var n,i,r,s,o;for(n in t)if(r=e[i=z(n)],s=t[n],Array.isArray(s)&&(r=s[1],s=t[n]=s[0]),n!==i&&(t[i]=s,delete t[n]),(o=b.cssHooks[i])&&"expand"in o)for(n in s=o.expand(s),delete t[i],s)n in t||(t[n]=s[n],e[n]=r);else e[i]=r}(l,c.opts.specialEasing);s<o;s++)if(i=le.prefilters[s].call(c,t,l,c.opts))return f(i.stop)&&(b._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return b.map(l,ce,c),f(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),b.fx.timer(b.extend(u,{elem:t,anim:c,queue:c.opts.queue})),c}b.Animation=b.extend(le,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return at(n.elem,t,et.exec(e),n),n}]},tweener:function(t,e){f(t)?(e=t,t=["*"]):t=t.match(M);for(var n,i=0,r=t.length;i<r;i++)n=t[i],le.tweeners[n]=le.tweeners[n]||[],le.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,s,o,a,u,c,l,h="width"in e||"height"in e,d=this,p={},f=t.style,g=t.nodeType&&ot(t),m=Y.get(t,"fxshow");for(i in n.queue||(null==(o=b._queueHooks(t,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,d.always((function(){d.always((function(){o.unqueued--,b.queue(t,"fx").length||o.empty.fire()}))}))),e)if(r=e[i],re.test(r)){if(delete e[i],s=s||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||b.style(t,i)}if((u=!b.isEmptyObject(e))||!b.isEmptyObject(p))for(i in h&&1===t.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(c=m&&m.display)&&(c=Y.get(t,"display")),"none"===(l=b.css(t,"display"))&&(c?l=c:(lt([t],!0),c=t.style.display||c,l=b.css(t,"display"),lt([t]))),("inline"===l||"inline-block"===l&&null!=c)&&"none"===b.css(t,"float")&&(u||(d.done((function(){f.display=c})),null==c&&(l=f.display,c="none"===l?"":l)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",d.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),u=!1,p)u||(m?"hidden"in m&&(g=m.hidden):m=Y.access(t,"fxshow",{display:c}),s&&(m.hidden=!g),g&&lt([t],!0),d.done((function(){for(i in g||lt([t]),Y.remove(t,"fxshow"),p)b.style(t,i,p[i])}))),u=ce(g?m[i]:0,i,d),i in m||(m[i]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(t,e){e?le.prefilters.unshift(t):le.prefilters.push(t)}}),b.speed=function(t,e,n){var i=t&&"object"==typeof t?b.extend({},t):{complete:n||!n&&e||f(t)&&t,duration:t,easing:n&&e||e&&!f(e)&&e};return b.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in b.fx.speeds?i.duration=b.fx.speeds[i.duration]:i.duration=b.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){f(i.old)&&i.old.call(this),i.queue&&b.dequeue(this,i.queue)},i},b.fn.extend({fadeTo:function(t,e,n,i){return this.filter(ot).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=b.isEmptyObject(t),s=b.speed(e,n,i),o=function(){var e=le(this,b.extend({},t),s);(r||Y.get(this,"finish"))&&e.stop(!0)};return o.finish=o,r||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",s=b.timers,o=Y.get(this);if(r)o[r]&&o[r].stop&&i(o[r]);else for(r in o)o[r]&&o[r].stop&&se.test(r)&&i(o[r]);for(r=s.length;r--;)s[r].elem!==this||null!=t&&s[r].queue!==t||(s[r].anim.stop(n),e=!1,s.splice(r,1));!e&&n||b.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=Y.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],s=b.timers,o=i?i.length:0;for(n.finish=!0,b.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;e<o;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),b.each(["toggle","show","hide"],(function(t,e){var n=b.fn[e];b.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(ue(e,!0),t,i,r)}})),b.each({slideDown:ue("show"),slideUp:ue("hide"),slideToggle:ue("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){b.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),b.timers=[],b.fx.tick=function(){var t,e=0,n=b.timers;for(ne=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||b.fx.stop(),ne=void 0},b.fx.timer=function(t){b.timers.push(t),b.fx.start()},b.fx.interval=13,b.fx.start=function(){ie||(ie=!0,oe())},b.fx.stop=function(){ie=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fn.delay=function(e,n){return e=b.fx&&b.fx.speeds[e]||e,n=n||"fx",this.queue(n,(function(n,i){var r=t.setTimeout(n,e);i.stop=function(){t.clearTimeout(r)}}))},function(){var t=m.createElement("input"),e=m.createElement("select").appendChild(m.createElement("option"));t.type="checkbox",p.checkOn=""!==t.value,p.optSelected=e.selected,(t=m.createElement("input")).value="t",t.type="radio",p.radioValue="t"===t.value}();var he,de=b.expr.attrHandle;b.fn.extend({attr:function(t,e){return H(this,b.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){b.removeAttr(this,t)}))}}),b.extend({attr:function(t,e,n){var i,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?b.prop(t,e,n):(1===s&&b.isXMLDoc(t)||(r=b.attrHooks[e.toLowerCase()]||(b.expr.match.bool.test(e)?he:void 0)),void 0!==n?null===n?void b.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=b.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!p.radioValue&&"radio"===e&&A(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(M);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),he={set:function(t,e,n){return!1===e?b.removeAttr(t,n):t.setAttribute(n,n),n}},b.each(b.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=de[e]||b.find.attr;de[e]=function(t,e,i){var r,s,o=e.toLowerCase();return i||(s=de[o],de[o]=r,r=null!=n(t,e,i)?o:null,de[o]=s),r}}));var pe=/^(?:input|select|textarea|button)$/i,fe=/^(?:a|area)$/i;function ge(t){return(t.match(M)||[]).join(" ")}function me(t){return t.getAttribute&&t.getAttribute("class")||""}function ve(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(M)||[]}b.fn.extend({prop:function(t,e){return H(this,b.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[b.propFix[t]||t]}))}}),b.extend({prop:function(t,e,n){var i,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&b.isXMLDoc(t)||(e=b.propFix[e]||e,r=b.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=b.find.attr(t,"tabindex");return e?parseInt(e,10):pe.test(t.nodeName)||fe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),p.optSelected||(b.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),b.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){b.propFix[this.toLowerCase()]=this})),b.fn.extend({addClass:function(t){var e,n,i,r,s,o;return f(t)?this.each((function(e){b(this).addClass(t.call(this,e,me(this)))})):(e=ve(t)).length?this.each((function(){if(i=me(this),n=1===this.nodeType&&" "+ge(i)+" "){for(s=0;s<e.length;s++)r=e[s],n.indexOf(" "+r+" ")<0&&(n+=r+" ");o=ge(n),i!==o&&this.setAttribute("class",o)}})):this},removeClass:function(t){var e,n,i,r,s,o;return f(t)?this.each((function(e){b(this).removeClass(t.call(this,e,me(this)))})):arguments.length?(e=ve(t)).length?this.each((function(){if(i=me(this),n=1===this.nodeType&&" "+ge(i)+" "){for(s=0;s<e.length;s++)for(r=e[s];n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");o=ge(n),i!==o&&this.setAttribute("class",o)}})):this:this.attr("class","")},toggleClass:function(t,e){var n,i,r,s,o=typeof t,a="string"===o||Array.isArray(t);return f(t)?this.each((function(n){b(this).toggleClass(t.call(this,n,me(this),e),e)})):"boolean"==typeof e&&a?e?this.addClass(t):this.removeClass(t):(n=ve(t),this.each((function(){if(a)for(s=b(this),r=0;r<n.length;r++)i=n[r],s.hasClass(i)?s.removeClass(i):s.addClass(i);else void 0!==t&&"boolean"!==o||((i=me(this))&&Y.set(this,"__className__",i),this.setAttribute&&this.setAttribute("class",i||!1===t?"":Y.get(this,"__className__")||""))})))},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+ge(me(n))+" ").indexOf(e)>-1)return!0;return!1}});var ye=/\r/g;b.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=f(t),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,b(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=b.map(r,(function(t){return null==t?"":t+""}))),(e=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=b.valHooks[r.type]||b.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(ye,""):null==n?"":n:void 0}}),b.extend({valHooks:{option:{get:function(t){var e=b.find.attr(t,"value");return null!=e?e:ge(b.text(t))}},select:{get:function(t){var e,n,i,r=t.options,s=t.selectedIndex,o="select-one"===t.type,a=o?null:[],u=o?s+1:r.length;for(i=s<0?u:o?s:0;i<u;i++)if(((n=r[i]).selected||i===s)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(e=b(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,s=b.makeArray(e),o=r.length;o--;)((i=r[o]).selected=b.inArray(b.valHooks.option.get(i),s)>-1)&&(n=!0);return n||(t.selectedIndex=-1),s}}}}),b.each(["radio","checkbox"],(function(){b.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=b.inArray(b(t).val(),e)>-1}},p.checkOn||(b.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),p.focusin="onfocusin"in t;var _e=/^(?:focusinfocus|focusoutblur)$/,we=function(t){t.stopPropagation()};b.extend(b.event,{trigger:function(e,n,i,r){var s,o,a,u,c,h,d,p,v=[i||m],y=l.call(e,"type")?e.type:e,_=l.call(e,"namespace")?e.namespace.split("."):[];if(o=p=a=i=i||m,3!==i.nodeType&&8!==i.nodeType&&!_e.test(y+b.event.triggered)&&(y.indexOf(".")>-1&&(_=y.split("."),y=_.shift(),_.sort()),c=y.indexOf(":")<0&&"on"+y,(e=e[b.expando]?e:new b.Event(y,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=_.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+_.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:b.makeArray(n,[e]),d=b.event.special[y]||{},r||!d.trigger||!1!==d.trigger.apply(i,n))){if(!r&&!d.noBubble&&!g(i)){for(u=d.delegateType||y,_e.test(u+y)||(o=o.parentNode);o;o=o.parentNode)v.push(o),a=o;a===(i.ownerDocument||m)&&v.push(a.defaultView||a.parentWindow||t)}for(s=0;(o=v[s++])&&!e.isPropagationStopped();)p=o,e.type=s>1?u:d.bindType||y,(h=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&h.apply(o,n),(h=c&&o[c])&&h.apply&&J(o)&&(e.result=h.apply(o,n),!1===e.result&&e.preventDefault());return e.type=y,r||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(v.pop(),n)||!J(i)||c&&f(i[y])&&!g(i)&&((a=i[c])&&(i[c]=null),b.event.triggered=y,e.isPropagationStopped()&&p.addEventListener(y,we),i[y](),e.isPropagationStopped()&&p.removeEventListener(y,we),b.event.triggered=void 0,a&&(i[c]=a)),e.result}},simulate:function(t,e,n){var i=b.extend(new b.Event,n,{type:t,isSimulated:!0});b.event.trigger(i,null,e)}}),b.fn.extend({trigger:function(t,e){return this.each((function(){b.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return b.event.trigger(t,e,n,!0)}}),p.focusin||b.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){b.event.simulate(e,t.target,b.event.fix(t))};b.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,r=Y.access(i,e);r||i.addEventListener(t,n,!0),Y.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=Y.access(i,e)-1;r?Y.access(i,e,r):(i.removeEventListener(t,n,!0),Y.remove(i,e))}}}));var be=t.location,xe={guid:Date.now()},Se=/\?/;b.parseXML=function(e){var n,i;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){}return i=n&&n.getElementsByTagName("parsererror")[0],n&&!i||b.error("Invalid XML: "+(i?b.map(i.childNodes,(function(t){return t.textContent})).join("\n"):e)),n};var Te=/\[\]$/,Ce=/\r?\n/g,Ee=/^(?:submit|button|image|reset|file)$/i,Ae=/^(?:input|select|textarea|keygen)/i;function ke(t,e,n,i){var r;if(Array.isArray(e))b.each(e,(function(e,r){n||Te.test(t)?i(t,r):ke(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)}));else if(n||"object"!==_(e))i(t,e);else for(r in e)ke(t+"["+r+"]",e[r],n,i)}b.param=function(t,e){var n,i=[],r=function(t,e){var n=f(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!b.isPlainObject(t))b.each(t,(function(){r(this.name,this.value)}));else for(n in t)ke(n,t[n],e,r);return i.join("&")},b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=b.prop(this,"elements");return t?b.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!b(this).is(":disabled")&&Ae.test(this.nodeName)&&!Ee.test(t)&&(this.checked||!pt.test(t))})).map((function(t,e){var n=b(this).val();return null==n?null:Array.isArray(n)?b.map(n,(function(t){return{name:e.name,value:t.replace(Ce,"\r\n")}})):{name:e.name,value:n.replace(Ce,"\r\n")}})).get()}});var Fe=/%20/g,Pe=/#.*$/,Re=/([?&])_=[^&]*/,Ie=/^(.*?):[ \t]*([^\r\n]*)$/gm,De=/^(?:GET|HEAD)$/,Oe=/^\/\//,Me={},Ne={},Le="*/".concat("*"),je=m.createElement("a");function Be(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,s=e.toLowerCase().match(M)||[];if(f(n))for(;i=s[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function Ue(t,e,n,i){var r={},s=t===Ne;function o(a){var u;return r[a]=!0,b.each(t[a]||[],(function(t,a){var c=a(e,n,i);return"string"!=typeof c||s||r[c]?s?!(u=c):void 0:(e.dataTypes.unshift(c),o(c),!1)})),u}return o(e.dataTypes[0])||!r["*"]&&o("*")}function Ve(t,e){var n,i,r=b.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&b.extend(!0,t,i),t}je.href=be.href,b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:be.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(be.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Le,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ve(Ve(t,b.ajaxSettings),e):Ve(b.ajaxSettings,t)},ajaxPrefilter:Be(Me),ajaxTransport:Be(Ne),ajax:function(e,n){"object"==typeof e&&(n=e,e=void 0),n=n||{};var i,r,s,o,a,u,c,l,h,d,p=b.ajaxSetup({},n),f=p.context||p,g=p.context&&(f.nodeType||f.jquery)?b(f):b.event,v=b.Deferred(),y=b.Callbacks("once memory"),_=p.statusCode||{},w={},x={},S="canceled",T={readyState:0,getResponseHeader:function(t){var e;if(c){if(!o)for(o={};e=Ie.exec(s);)o[e[1].toLowerCase()+" "]=(o[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=o[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?s:null},setRequestHeader:function(t,e){return null==c&&(t=x[t.toLowerCase()]=x[t.toLowerCase()]||t,w[t]=e),this},overrideMimeType:function(t){return null==c&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)T.always(t[T.status]);else for(e in t)_[e]=[_[e],t[e]];return this},abort:function(t){var e=t||S;return i&&i.abort(e),C(0,e),this}};if(v.promise(T),p.url=((e||p.url||be.href)+"").replace(Oe,be.protocol+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(M)||[""],null==p.crossDomain){u=m.createElement("a");try{u.href=p.url,u.href=u.href,p.crossDomain=je.protocol+"//"+je.host!=u.protocol+"//"+u.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),Ue(Me,p,n,T),c)return T;for(h in(l=b.event&&p.global)&&0==b.active++&&b.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!De.test(p.type),r=p.url.replace(Pe,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Fe,"+")):(d=p.url.slice(r.length),p.data&&(p.processData||"string"==typeof p.data)&&(r+=(Se.test(r)?"&":"?")+p.data,delete p.data),!1===p.cache&&(r=r.replace(Re,"$1"),d=(Se.test(r)?"&":"?")+"_="+xe.guid+++d),p.url=r+d),p.ifModified&&(b.lastModified[r]&&T.setRequestHeader("If-Modified-Since",b.lastModified[r]),b.etag[r]&&T.setRequestHeader("If-None-Match",b.etag[r])),(p.data&&p.hasContent&&!1!==p.contentType||n.contentType)&&T.setRequestHeader("Content-Type",p.contentType),T.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Le+"; q=0.01":""):p.accepts["*"]),p.headers)T.setRequestHeader(h,p.headers[h]);if(p.beforeSend&&(!1===p.beforeSend.call(f,T,p)||c))return T.abort();if(S="abort",y.add(p.complete),T.done(p.success),T.fail(p.error),i=Ue(Ne,p,n,T)){if(T.readyState=1,l&&g.trigger("ajaxSend",[T,p]),c)return T;p.async&&p.timeout>0&&(a=t.setTimeout((function(){T.abort("timeout")}),p.timeout));try{c=!1,i.send(w,C)}catch(t){if(c)throw t;C(-1,t)}}else C(-1,"No Transport");function C(e,n,o,u){var h,d,m,w,x,S=n;c||(c=!0,a&&t.clearTimeout(a),i=void 0,s=u||"",T.readyState=e>0?4:0,h=e>=200&&e<300||304===e,o&&(w=function(t,e,n){for(var i,r,s,o,a=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){u.unshift(r);break}if(u[0]in n)s=u[0];else{for(r in n){if(!u[0]||t.converters[r+" "+u[0]]){s=r;break}o||(o=r)}s=s||o}if(s)return s!==u[0]&&u.unshift(s),n[s]}(p,T,o)),!h&&b.inArray("script",p.dataTypes)>-1&&b.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),w=function(t,e,n,i){var r,s,o,a,u,c={},l=t.dataTypes.slice();if(l[1])for(o in t.converters)c[o.toLowerCase()]=t.converters[o];for(s=l.shift();s;)if(t.responseFields[s]&&(n[t.responseFields[s]]=e),!u&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=s,s=l.shift())if("*"===s)s=u;else if("*"!==u&&u!==s){if(!(o=c[u+" "+s]||c["* "+s]))for(r in c)if((a=r.split(" "))[1]===s&&(o=c[u+" "+a[0]]||c["* "+a[0]])){!0===o?o=c[r]:!0!==c[r]&&(s=a[0],l.unshift(a[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+u+" to "+s}}}return{state:"success",data:e}}(p,w,T,h),h?(p.ifModified&&((x=T.getResponseHeader("Last-Modified"))&&(b.lastModified[r]=x),(x=T.getResponseHeader("etag"))&&(b.etag[r]=x)),204===e||"HEAD"===p.type?S="nocontent":304===e?S="notmodified":(S=w.state,d=w.data,h=!(m=w.error))):(m=S,!e&&S||(S="error",e<0&&(e=0))),T.status=e,T.statusText=(n||S)+"",h?v.resolveWith(f,[d,S,T]):v.rejectWith(f,[T,S,m]),T.statusCode(_),_=void 0,l&&g.trigger(h?"ajaxSuccess":"ajaxError",[T,p,h?d:m]),y.fireWith(f,[T,S]),l&&(g.trigger("ajaxComplete",[T,p]),--b.active||b.event.trigger("ajaxStop")))}return T},getJSON:function(t,e,n){return b.get(t,e,n,"json")},getScript:function(t,e){return b.get(t,void 0,e,"script")}}),b.each(["get","post"],(function(t,e){b[e]=function(t,n,i,r){return f(n)&&(r=r||i,i=n,n=void 0),b.ajax(b.extend({url:t,type:e,dataType:r,data:n,success:i},b.isPlainObject(t)&&t))}})),b.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),b._evalUrl=function(t,e,n){return b.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){b.globalEval(t,e,n)}})},b.fn.extend({wrapAll:function(t){var e;return this[0]&&(f(t)&&(t=t.call(this[0])),e=b(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return f(t)?this.each((function(e){b(this).wrapInner(t.call(this,e))})):this.each((function(){var e=b(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=f(t);return this.each((function(n){b(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){b(this).replaceWith(this.childNodes)})),this}}),b.expr.pseudos.hidden=function(t){return!b.expr.pseudos.visible(t)},b.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},b.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var He={0:200,1223:204},qe=b.ajaxSettings.xhr();p.cors=!!qe&&"withCredentials"in qe,p.ajax=qe=!!qe,b.ajaxTransport((function(e){var n,i;if(p.cors||qe&&!e.crossDomain)return{send:function(r,s){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(o,r[o]);n=function(t){return function(){n&&(n=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(He[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),i=a.onerror=a.ontimeout=n("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&t.setTimeout((function(){n&&i()}))},n=n("abort");try{a.send(e.hasContent&&e.data||null)}catch(t){if(n)throw t}},abort:function(){n&&n()}}})),b.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return b.globalEval(t),t}}}),b.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),b.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,r){e=b("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),m.head.appendChild(e[0])},abort:function(){n&&n()}}}));var We,Ke=[],ze=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ke.pop()||b.expando+"_"+xe.guid++;return this[t]=!0,t}}),b.ajaxPrefilter("json jsonp",(function(e,n,i){var r,s,o,a=!1!==e.jsonp&&(ze.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&ze.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=f(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(ze,"$1"+r):!1!==e.jsonp&&(e.url+=(Se.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||b.error(r+" was not called"),o[0]},e.dataTypes[0]="json",s=t[r],t[r]=function(){o=arguments},i.always((function(){void 0===s?b(t).removeProp(r):t[r]=s,e[r]&&(e.jsonpCallback=n.jsonpCallback,Ke.push(r)),o&&f(s)&&s(o[0]),o=s=void 0})),"script"})),p.createHTMLDocument=((We=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===We.childNodes.length),b.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(p.createHTMLDocument?((i=(e=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,e.head.appendChild(i)):e=m),s=!n&&[],(r=k.exec(t))?[e.createElement(r[1])]:(r=wt([t],e,s),s&&s.length&&b(s).remove(),b.merge([],r.childNodes)));var i,r,s},b.fn.load=function(t,e,n){var i,r,s,o=this,a=t.indexOf(" ");return a>-1&&(i=ge(t.slice(a)),t=t.slice(0,a)),f(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),o.length>0&&b.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){s=arguments,o.html(i?b("<div>").append(b.parseHTML(t)).find(i):t)})).always(n&&function(t,e){o.each((function(){n.apply(this,s||[t.responseText,e,t])}))}),this},b.expr.pseudos.animated=function(t){return b.grep(b.timers,(function(e){return t===e.elem})).length},b.offset={setOffset:function(t,e,n){var i,r,s,o,a,u,c=b.css(t,"position"),l=b(t),h={};"static"===c&&(t.style.position="relative"),a=l.offset(),s=b.css(t,"top"),u=b.css(t,"left"),("absolute"===c||"fixed"===c)&&(s+u).indexOf("auto")>-1?(o=(i=l.position()).top,r=i.left):(o=parseFloat(s)||0,r=parseFloat(u)||0),f(e)&&(e=e.call(t,n,b.extend({},a))),null!=e.top&&(h.top=e.top-a.top+o),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):l.css(h)}},b.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){b.offset.setOffset(this,t,e)}));var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===b.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===b.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((r=b(t).offset()).top+=b.css(t,"borderTopWidth",!0),r.left+=b.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-b.css(i,"marginTop",!0),left:e.left-r.left-b.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===b.css(t,"position");)t=t.offsetParent;return t||it}))}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;b.fn[t]=function(i){return H(this,(function(t,i,r){var s;if(g(t)?s=t:9===t.nodeType&&(s=t.defaultView),void 0===r)return s?s[e]:t[i];s?s.scrollTo(n?s.pageXOffset:r,n?r:s.pageYOffset):t[i]=r}),t,i,arguments.length)}})),b.each(["top","left"],(function(t,e){b.cssHooks[e]=Wt(p.pixelPosition,(function(t,n){if(n)return n=qt(t,e),Lt.test(n)?b(t).position()[e]+"px":n}))})),b.each({Height:"height",Width:"width"},(function(t,e){b.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){b.fn[i]=function(r,s){var o=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===s?"margin":"border");return H(this,(function(e,n,r){var s;return g(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===r?b.css(e,n,a):b.style(e,n,r,a)}),e,o?r:void 0,o)}}))})),b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){b.fn[e]=function(t){return this.on(e,t)}})),b.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),b.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){b.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}));var Je=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;b.proxy=function(t,e){var n,i,s;if("string"==typeof e&&(n=t[e],e=t,t=n),f(t))return i=r.call(arguments,2),s=function(){return t.apply(e||this,i.concat(r.call(arguments)))},s.guid=t.guid=t.guid||b.guid++,s},b.holdReady=function(t){t?b.readyWait++:b.ready(!0)},b.isArray=Array.isArray,b.parseJSON=JSON.parse,b.nodeName=A,b.isFunction=f,b.isWindow=g,b.camelCase=z,b.type=_,b.now=Date.now,b.isNumeric=function(t){var e=b.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},b.trim=function(t){return null==t?"":(t+"").replace(Je,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return b}));var Ge=t.jQuery,Ye=t.$;return b.noConflict=function(e){return t.$===b&&(t.$=Ye),e&&t.jQuery===b&&(t.jQuery=Ge),b},void 0===e&&(t.jQuery=t.$=b),b}))})),s.register("chAV5",(function(t,e){t.exports=JSON.parse('{"name":"pads","version":"0.1.10","description":"","scripts":{"dev":"parcel serve -p 2000 ./src/index.html","build":"parcel build --no-cache ./src/index.html"},"author":"kbbs","license":"ISC","dependencies":{"@vertx/auth":"^1.0.0-preview.1","@vertx/jsx":"^1.0.0","babylonjs":"^5.27.0","babylonjs-gui":"^5.27.0","com.visr-vr.vertex.jsclient":"^0.3.2-dev0","parcel":"^2.7.0","soundcloud":"^3.3.2","toastr":"^2.1.4","tone":"^14.7.77","uuid":"^9.0.0"},"devDependencies":{"@parcel/resolver-glob":"^2.7.0","@parcel/transformer-sass":"^2.7.0","@parcel/transformer-typescript-tsc":"^2.7.0","@types/node":"^18.8.3"}}')})),s("27Lyk").register(JSON.parse('{"4z5y2":"index.98b81278.js","h651o":"audio-file.68caaea5.svg","hA8qP":"Kick.a2d78bcc.mp3","020Q8":"sponge.625e5271.mp3","cMaNj":"index.eb0b4fda.css"}'));var o,a={};function u(t,e){try{var n=t()}catch(t){return e(t)}return n&&n.then?n.then(void 0,e):n}o=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=22)}([function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r={debug:function(){},info:function(){},warn:function(){},error:function(){}},s=void 0,o=void 0;(e.Log=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.reset=function(){o=3,s=r},t.debug=function(){if(o>=4){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.debug.apply(s,Array.from(e))}},t.info=function(){if(o>=3){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.info.apply(s,Array.from(e))}},t.warn=function(){if(o>=2){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.warn.apply(s,Array.from(e))}},t.error=function(){if(o>=1){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];s.error.apply(s,Array.from(e))}},i(t,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return o},set:function(t){if(!(0<=t&&t<=4))throw new Error("Invalid log level");o=t}},{key:"logger",get:function(){return s},set:function(t){if(!t.debug&&t.info&&(t.debug=t.info),!(t.debug&&t.info&&t.warn&&t.error))throw new Error("Invalid logger");s=t}}]),t}()).reset()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r={setInterval:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return setInterval(t,e)})),clearInterval:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return clearInterval(t)}))},s=!1,o=null;e.Global=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t._testing=function(){s=!0},t.setXMLHttpRequest=function(t){o=t},i(t,null,[{key:"location",get:function(){if(!s)return location}},{key:"localStorage",get:function(){if(!s&&"undefined"!=typeof window)return localStorage}},{key:"sessionStorage",get:function(){if(!s&&"undefined"!=typeof window)return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!s&&"undefined"!=typeof window)return o||XMLHttpRequest}},{key:"timer",get:function(){if(!s)return r}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.MetadataService=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),s=n(7);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=".well-known/openid-configuration";e.MetadataService=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.JsonService;if(o(this,t),!e)throw r.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=e,this._jsonService=new n(["application/jwk-set+json"])}return t.prototype.resetSigningKeys=function(){this._settings=this._settings||{},this._settings.signingKeys=void 0},t.prototype.getMetadata=function(){var t=this;return this._settings.metadata?(r.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(r.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then((function(e){r.Log.debug("MetadataService.getMetadata: json received");var n=t._settings.metadataSeed||{};return t._settings.metadata=Object.assign({},n,e),t._settings.metadata}))):(r.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},t.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},t.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},t.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},t.prototype.getTokenEndpoint=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",t)},t.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},t.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},t.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},t.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},t.prototype._getMetadataProperty=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.Log.debug("MetadataService.getMetadataProperty for: "+t),this.getMetadata().then((function(n){if(r.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),void 0===n[t]){if(!0===e)return void r.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+t);throw r.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+t),new Error("Metadata does not contain property "+t)}return n[t]}))},t.prototype.getSigningKeys=function(){var t=this;return this._settings.signingKeys?(r.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then((function(e){return r.Log.debug("MetadataService.getSigningKeys: jwks_uri received",e),t._jsonService.getJson(e).then((function(e){if(r.Log.debug("MetadataService.getSigningKeys: key set received",e),!e.keys)throw r.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return t._settings.signingKeys=e.keys,t._settings.signingKeys}))}))},i(t,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(a)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=a))),this._metadataUrl}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.UrlUtility=void 0;var i=n(0),r=n(1);e.UrlUtility=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.addQueryParam=function(t,e,n){return t.indexOf("?")<0&&(t+="?"),"?"!==t[t.length-1]&&(t+="&"),t+=encodeURIComponent(e),(t+="=")+encodeURIComponent(n)},t.parseUrlFragment=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.Global;"string"!=typeof t&&(t=n.location.href);var s=t.lastIndexOf(e);s>=0&&(t=t.substr(s+1)),"?"===e&&(s=t.indexOf("#"))>=0&&(t=t.substr(0,s));for(var o,a={},u=/([^&=]+)=([^&]*)/g,c=0;o=u.exec(t);)if(a[decodeURIComponent(o[1])]=decodeURIComponent(o[2].replace(/\+/g," ")),c++>50)return i.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",t),{error:"Response exceeded expected number of parameters"};for(var l in a)return a;return{}},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.JoseUtil=void 0;var i=n(26),r=function(t){return t&&t.__esModule?t:{default:t}}(n(33));e.JoseUtil=(0,r.default)({jws:i.jws,KeyUtil:i.KeyUtil,X509:i.X509,crypto:i.crypto,hextob64u:i.hextob64u,b64tohex:i.b64tohex,AllowedSigningAlgs:i.AllowedSigningAlgs})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.OidcClientSettings=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(0),o=n(23),a=n(6),u=n(24),c=n(2);function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var h=".well-known/openid-configuration",d="id_token",p="openid",f="client_secret_post";e.OidcClientSettings=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.authority,r=e.metadataUrl,s=e.metadata,h=e.signingKeys,g=e.metadataSeed,m=e.client_id,v=e.client_secret,y=e.response_type,_=void 0===y?d:y,w=e.scope,b=void 0===w?p:w,x=e.redirect_uri,S=e.post_logout_redirect_uri,T=e.client_authentication,C=void 0===T?f:T,E=e.prompt,A=e.display,k=e.max_age,F=e.ui_locales,P=e.acr_values,R=e.resource,I=e.response_mode,D=e.filterProtocolClaims,O=void 0===D||D,M=e.loadUserInfo,N=void 0===M||M,L=e.staleStateAge,j=void 0===L?900:L,B=e.clockSkew,U=void 0===B?300:B,V=e.clockService,H=void 0===V?new o.ClockService:V,q=e.userInfoJwtIssuer,W=void 0===q?"OP":q,K=e.mergeClaims,z=void 0!==K&&K,J=e.stateStore,G=void 0===J?new a.WebStorageStateStore:J,Y=e.ResponseValidatorCtor,$=void 0===Y?u.ResponseValidator:Y,X=e.MetadataServiceCtor,Z=void 0===X?c.MetadataService:X,Q=e.extraQueryParams,tt=void 0===Q?{}:Q,et=e.extraTokenParams,nt=void 0===et?{}:et;l(this,t),this._authority=n,this._metadataUrl=r,this._metadata=s,this._metadataSeed=g,this._signingKeys=h,this._client_id=m,this._client_secret=v,this._response_type=_,this._scope=b,this._redirect_uri=x,this._post_logout_redirect_uri=S,this._client_authentication=C,this._prompt=E,this._display=A,this._max_age=k,this._ui_locales=F,this._acr_values=P,this._resource=R,this._response_mode=I,this._filterProtocolClaims=!!O,this._loadUserInfo=!!N,this._staleStateAge=j,this._clockSkew=U,this._clockService=H,this._userInfoJwtIssuer=W,this._mergeClaims=!!z,this._stateStore=G,this._validator=new $(this),this._metadataService=new Z(this),this._extraQueryParams="object"===(void 0===tt?"undefined":i(tt))?tt:{},this._extraTokenParams="object"===(void 0===nt?"undefined":i(nt))?nt:{}}return t.prototype.getEpochTime=function(){return this._clockService.getEpochTime()},r(t,[{key:"client_id",get:function(){return this._client_id},set:function(t){if(this._client_id)throw s.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=t}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"client_authentication",get:function(){return this._client_authentication}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(t){if(this._authority)throw s.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=t}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(h)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=h)),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(t){this._metadata=t}},{key:"metadataSeed",get:function(){return this._metadataSeed},set:function(t){this._metadataSeed=t}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(t){this._signingKeys=t}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"mergeClaims",get:function(){return this._mergeClaims}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(t){"object"===(void 0===t?"undefined":i(t))?this._extraQueryParams=t:this._extraQueryParams={}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(t){"object"===(void 0===t?"undefined":i(t))?this._extraTokenParams=t:this._extraTokenParams={}}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.WebStorageStateStore=void 0;var i=n(0),r=n(1);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.WebStorageStateStore=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.prefix,i=void 0===n?"oidc.":n,o=e.store,a=void 0===o?r.Global.localStorage:o;s(this,t),this._store=a,this._prefix=i}return t.prototype.set=function(t,e){return i.Log.debug("WebStorageStateStore.set",t),t=this._prefix+t,this._store.setItem(t,e),Promise.resolve()},t.prototype.get=function(t){i.Log.debug("WebStorageStateStore.get",t),t=this._prefix+t;var e=this._store.getItem(t);return Promise.resolve(e)},t.prototype.remove=function(t){i.Log.debug("WebStorageStateStore.remove",t),t=this._prefix+t;var e=this._store.getItem(t);return this._store.removeItem(t),Promise.resolve(e)},t.prototype.getAllKeys=function(){i.Log.debug("WebStorageStateStore.getAllKeys");for(var t=[],e=0;e<this._store.length;e++){var n=this._store.key(e);0===n.indexOf(this._prefix)&&t.push(n.substr(this._prefix.length))}return Promise.resolve(t)},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.JsonService=void 0;var i=n(0),r=n(1);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.JsonService=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Global.XMLHttpRequest,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;s(this,t),e&&Array.isArray(e)?this._contentTypes=e.slice():this._contentTypes=[],this._contentTypes.push("application/json"),i&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=n,this._jwtHandler=i}return t.prototype.getJson=function(t,e){var n=this;if(!t)throw i.Log.error("JsonService.getJson: No url passed"),new Error("url");return i.Log.debug("JsonService.getJson, url: ",t),new Promise((function(r,s){var o=new n._XMLHttpRequest;o.open("GET",t);var a=n._contentTypes,u=n._jwtHandler;o.onload=function(){if(i.Log.debug("JsonService.getJson: HTTP response received, status",o.status),200===o.status){var e=o.getResponseHeader("Content-Type");if(e){var n=a.find((function(t){if(e.startsWith(t))return!0}));if("application/jwt"==n)return void u(o).then(r,s);if(n)try{return void r(JSON.parse(o.responseText))}catch(t){return i.Log.error("JsonService.getJson: Error parsing JSON response",t.message),void s(t)}}s(Error("Invalid response Content-Type: "+e+", from URL: "+t))}else s(Error(o.statusText+" ("+o.status+")"))},o.onerror=function(){i.Log.error("JsonService.getJson: network error"),s(Error("Network Error"))},e&&(i.Log.debug("JsonService.getJson: token passed, setting Authorization header"),o.setRequestHeader("Authorization","Bearer "+e)),o.send()}))},t.prototype.postForm=function(t,e,n){var r=this;if(!t)throw i.Log.error("JsonService.postForm: No url passed"),new Error("url");return i.Log.debug("JsonService.postForm, url: ",t),new Promise((function(s,o){var a=new r._XMLHttpRequest;a.open("POST",t);var u=r._contentTypes;a.onload=function(){if(i.Log.debug("JsonService.postForm: HTTP response received, status",a.status),200!==a.status){if(400===a.status&&(n=a.getResponseHeader("Content-Type"))&&u.find((function(t){if(n.startsWith(t))return!0})))try{var e=JSON.parse(a.responseText);if(e&&e.error)return i.Log.error("JsonService.postForm: Error from server: ",e.error),void o(new Error(e.error))}catch(t){return i.Log.error("JsonService.postForm: Error parsing JSON response",t.message),void o(t)}o(Error(a.statusText+" ("+a.status+")"))}else{var n;if((n=a.getResponseHeader("Content-Type"))&&u.find((function(t){if(n.startsWith(t))return!0})))try{return void s(JSON.parse(a.responseText))}catch(t){return i.Log.error("JsonService.postForm: Error parsing JSON response",t.message),void o(t)}o(Error("Invalid response Content-Type: "+n+", from URL: "+t))}},a.onerror=function(){i.Log.error("JsonService.postForm: network error"),o(Error("Network Error"))};var c="";for(var l in e){var h=e[l];h&&(c.length>0&&(c+="&"),c+=encodeURIComponent(l),c+="=",c+=encodeURIComponent(h))}a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),void 0!==n&&a.setRequestHeader("Authorization","Basic "+btoa(n)),a.send(c)}))},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SigninRequest=void 0;var i=n(0),r=n(3),s=n(13);e.SigninRequest=function(){function t(e){var n=e.url,o=e.client_id,a=e.redirect_uri,u=e.response_type,c=e.scope,l=e.authority,h=e.data,d=e.prompt,p=e.display,f=e.max_age,g=e.ui_locales,m=e.id_token_hint,v=e.login_hint,y=e.acr_values,_=e.resource,w=e.response_mode,b=e.request,x=e.request_uri,S=e.extraQueryParams,T=e.request_type,C=e.client_secret,E=e.extraTokenParams,A=e.skipUserInfo;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!n)throw i.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!o)throw i.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!a)throw i.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!u)throw i.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!c)throw i.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!l)throw i.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var k=t.isOidc(u),F=t.isCode(u);w||(w=t.isCode(u)?"query":null),this.state=new s.SigninState({nonce:k,data:h,client_id:o,authority:l,redirect_uri:a,code_verifier:F,request_type:T,response_mode:w,client_secret:C,scope:c,extraTokenParams:E,skipUserInfo:A}),n=r.UrlUtility.addQueryParam(n,"client_id",o),n=r.UrlUtility.addQueryParam(n,"redirect_uri",a),n=r.UrlUtility.addQueryParam(n,"response_type",u),n=r.UrlUtility.addQueryParam(n,"scope",c),n=r.UrlUtility.addQueryParam(n,"state",this.state.id),k&&(n=r.UrlUtility.addQueryParam(n,"nonce",this.state.nonce)),F&&(n=r.UrlUtility.addQueryParam(n,"code_challenge",this.state.code_challenge),n=r.UrlUtility.addQueryParam(n,"code_challenge_method","S256"));var P={prompt:d,display:p,max_age:f,ui_locales:g,id_token_hint:m,login_hint:v,acr_values:y,resource:_,request:b,request_uri:x,response_mode:w};for(var R in P)P[R]&&(n=r.UrlUtility.addQueryParam(n,R,P[R]));for(var I in S)n=r.UrlUtility.addQueryParam(n,I,S[I]);this.url=n}return t.isOidc=function(t){return!!t.split(/\s+/g).filter((function(t){return"id_token"===t}))[0]},t.isOAuth=function(t){return!!t.split(/\s+/g).filter((function(t){return"token"===t}))[0]},t.isCode=function(t){return!!t.split(/\s+/g).filter((function(t){return"code"===t}))[0]},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.State=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),s=function(t){return t&&t.__esModule?t:{default:t}}(n(14));function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.State=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.id,i=e.data,r=e.created,a=e.request_type;o(this,t),this._id=n||(0,s.default)(),this._data=i,this._created="number"==typeof r&&r>0?r:parseInt(Date.now()/1e3),this._request_type=a}return t.prototype.toStorageString=function(){return r.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},t.fromStorageString=function(e){return r.Log.debug("State.fromStorageString"),new t(JSON.parse(e))},t.clearStaleState=function(e,n){var i=Date.now()/1e3-n;return e.getAllKeys().then((function(n){r.Log.debug("State.clearStaleState: got keys",n);for(var s=[],o=function(o){var a=n[o];u=e.get(a).then((function(n){var s=!1;if(n)try{var o=t.fromStorageString(n);r.Log.debug("State.clearStaleState: got item from key: ",a,o.created),o.created<=i&&(s=!0)}catch(t){r.Log.error("State.clearStaleState: Error parsing state for key",a,t.message),s=!0}else r.Log.debug("State.clearStaleState: no item in storage for key: ",a),s=!0;if(s)return r.Log.debug("State.clearStaleState: removed item for key: ",a),e.remove(a)})),s.push(u)},a=0;a<n.length;a++){var u;o(a)}return r.Log.debug("State.clearStaleState: waiting on promise count:",s.length),Promise.all(s)}))},i(t,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.OidcClient=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),s=n(5),o=n(12),a=n(8),u=n(34),c=n(35),l=n(36),h=n(13),d=n(9);function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.OidcClient=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,t),e instanceof s.OidcClientSettings?this._settings=e:this._settings=new s.OidcClientSettings(e)}return t.prototype.createSigninRequest=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.response_type,i=e.scope,s=e.redirect_uri,o=e.data,u=e.state,c=e.prompt,l=e.display,h=e.max_age,d=e.ui_locales,p=e.id_token_hint,f=e.login_hint,g=e.acr_values,m=e.resource,v=e.request,y=e.request_uri,_=e.response_mode,w=e.extraQueryParams,b=e.extraTokenParams,x=e.request_type,S=e.skipUserInfo,T=arguments[1];r.Log.debug("OidcClient.createSigninRequest");var C=this._settings.client_id;n=n||this._settings.response_type,i=i||this._settings.scope,s=s||this._settings.redirect_uri,c=c||this._settings.prompt,l=l||this._settings.display,h=h||this._settings.max_age,d=d||this._settings.ui_locales,g=g||this._settings.acr_values,m=m||this._settings.resource,_=_||this._settings.response_mode,w=w||this._settings.extraQueryParams,b=b||this._settings.extraTokenParams;var E=this._settings.authority;return a.SigninRequest.isCode(n)&&"code"!==n?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then((function(e){r.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",e);var A=new a.SigninRequest({url:e,client_id:C,redirect_uri:s,response_type:n,scope:i,data:o||u,authority:E,prompt:c,display:l,max_age:h,ui_locales:d,id_token_hint:p,login_hint:f,acr_values:g,resource:m,request:v,request_uri:y,extraQueryParams:w,extraTokenParams:b,request_type:x,response_mode:_,client_secret:t._settings.client_secret,skipUserInfo:S}),k=A.state;return(T=T||t._stateStore).set(k.id,k.toStorageString()).then((function(){return A}))}))},t.prototype.readSigninResponseState=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r.Log.debug("OidcClient.readSigninResponseState");var i="query"===this._settings.response_mode||!this._settings.response_mode&&a.SigninRequest.isCode(this._settings.response_type),s=i?"?":"#",o=new u.SigninResponse(t,s);if(!o.state)return r.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response"));e=e||this._stateStore;var c=n?e.remove.bind(e):e.get.bind(e);return c(o.state).then((function(t){if(!t)throw r.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:h.SigninState.fromStorageString(t),response:o}}))},t.prototype.processSigninResponse=function(t,e){var n=this;return r.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState(t,e,!0).then((function(t){var e=t.state,i=t.response;return r.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),n._validator.validateSigninResponse(e,i)}))},t.prototype.createSignoutRequest=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.id_token_hint,i=e.data,s=e.state,o=e.post_logout_redirect_uri,a=e.extraQueryParams,u=e.request_type,l=arguments[1];return r.Log.debug("OidcClient.createSignoutRequest"),o=o||this._settings.post_logout_redirect_uri,a=a||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then((function(e){if(!e)throw r.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");r.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",e);var h=new c.SignoutRequest({url:e,id_token_hint:n,post_logout_redirect_uri:o,data:i||s,extraQueryParams:a,request_type:u}),d=h.state;return d&&(r.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(l=l||t._stateStore).set(d.id,d.toStorageString())),h}))},t.prototype.readSignoutResponseState=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r.Log.debug("OidcClient.readSignoutResponseState");var i=new l.SignoutResponse(t);if(!i.state)return r.Log.debug("OidcClient.readSignoutResponseState: No state in response"),i.error?(r.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",i.error),Promise.reject(new o.ErrorResponse(i))):Promise.resolve({state:void 0,response:i});var s=i.state;e=e||this._stateStore;var a=n?e.remove.bind(e):e.get.bind(e);return a(s).then((function(t){if(!t)throw r.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:d.State.fromStorageString(t),response:i}}))},t.prototype.processSignoutResponse=function(t,e){var n=this;return r.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState(t,e,!0).then((function(t){var e=t.state,i=t.response;return e?(r.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),n._validator.validateSignoutResponse(e,i)):(r.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),i)}))},t.prototype.clearStaleState=function(t){return r.Log.debug("OidcClient.clearStaleState"),t=t||this._stateStore,d.State.clearStaleState(t,this.settings.staleStateAge)},i(t,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.TokenClient=void 0;var i=n(7),r=n(2),s=n(0);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.TokenClient=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.JsonService,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.MetadataService;if(o(this,t),!e)throw s.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=e,this._jsonService=new n,this._metadataService=new a(this._settings)}return t.prototype.exchangeCode=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).grant_type=e.grant_type||"authorization_code",e.client_id=e.client_id||this._settings.client_id,e.client_secret=e.client_secret||this._settings.client_secret,e.redirect_uri=e.redirect_uri||this._settings.redirect_uri;var n=void 0,i=e._client_authentication||this._settings._client_authentication;return delete e._client_authentication,e.code?e.redirect_uri?e.code_verifier?e.client_id?e.client_secret||"client_secret_basic"!=i?("client_secret_basic"==i&&(n=e.client_id+":"+e.client_secret,delete e.client_id,delete e.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(i){return s.Log.debug("TokenClient.exchangeCode: Received token endpoint"),t._jsonService.postForm(i,e,n).then((function(t){return s.Log.debug("TokenClient.exchangeCode: response received"),t}))}))):(s.Log.error("TokenClient.exchangeCode: No client_secret passed"),Promise.reject(new Error("A client_secret is required"))):(s.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(s.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(s.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(s.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},t.prototype.exchangeRefreshToken=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).grant_type=e.grant_type||"refresh_token",e.client_id=e.client_id||this._settings.client_id,e.client_secret=e.client_secret||this._settings.client_secret;var n=void 0,i=e._client_authentication||this._settings._client_authentication;return delete e._client_authentication,e.refresh_token?e.client_id?("client_secret_basic"==i&&(n=e.client_id+":"+e.client_secret,delete e.client_id,delete e.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(i){return s.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),t._jsonService.postForm(i,e,n).then((function(t){return s.Log.debug("TokenClient.exchangeRefreshToken: response received"),t}))}))):(s.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(s.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorResponse=void 0;var i=n(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}e.ErrorResponse=function(t){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.error,a=n.error_description,u=n.error_uri,c=n.state,l=n.session_state;if(r(this,e),!o)throw i.Log.error("No error passed to ErrorResponse"),new Error("error");var h=s(this,t.call(this,a||o));return h.name="ErrorResponse",h.error=o,h.error_description=a,h.error_uri=u,h.state=c,h.session_state=l,h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(Error)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SigninState=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),s=n(9),o=n(4),a=function(t){return t&&t.__esModule?t:{default:t}}(n(14));function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}e.SigninState=function(t){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.nonce,r=n.authority,s=n.client_id,l=n.redirect_uri,h=n.code_verifier,d=n.response_mode,p=n.client_secret,f=n.scope,g=n.extraTokenParams,m=n.skipUserInfo;u(this,e);var v=c(this,t.call(this,arguments[0]));if(!0===i?v._nonce=(0,a.default)():i&&(v._nonce=i),!0===h?v._code_verifier=(0,a.default)()+(0,a.default)()+(0,a.default)():h&&(v._code_verifier=h),v.code_verifier){var y=o.JoseUtil.hashString(v.code_verifier,"SHA256");v._code_challenge=o.JoseUtil.hexToBase64Url(y)}return v._redirect_uri=l,v._authority=r,v._client_id=s,v._response_mode=d,v._client_secret=p,v._scope=f,v._extraTokenParams=g,v._skipUserInfo=m,v}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.toStorageString=function(){return r.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},e.fromStorageString=function(t){return r.Log.debug("SigninState.fromStorageString"),new e(JSON.parse(t))},i(e,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),e}(s.State)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return("undefined"!=i&&null!==i&&void 0!==i.getRandomValues?r:s)().replace(/-/g,"")};var i="undefined"!=typeof window?window.crypto||window.msCrypto:null;function r(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(t^i.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}function s(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(t){return(t^16*Math.random()>>t/4).toString(16)}))}t.exports=e.default},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.User=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0);e.User=function(){function t(e){var n=e.id_token,i=e.session_state,r=e.access_token,s=e.refresh_token,o=e.token_type,a=e.scope,u=e.profile,c=e.expires_at,l=e.state;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id_token=n,this.session_state=i,this.access_token=r,this.refresh_token=s,this.token_type=o,this.scope=a,this.profile=u,this.expires_at=c,this.state=l}return t.prototype.toStorageString=function(){return r.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},t.fromStorageString=function(e){return r.Log.debug("User.fromStorageString"),new t(JSON.parse(e))},i(t,[{key:"expires_in",get:function(){if(this.expires_at){var t=parseInt(Date.now()/1e3);return this.expires_at-t}},set:function(t){var e=parseInt(t);if("number"==typeof e&&e>0){var n=parseInt(Date.now()/1e3);this.expires_at=n+e}}},{key:"expired",get:function(){var t=this.expires_in;if(void 0!==t)return t<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.AccessTokenEvents=void 0;var i=n(0),r=n(46);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.AccessTokenEvents=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.accessTokenExpiringNotificationTime,i=void 0===n?60:n,o=e.accessTokenExpiringTimer,a=void 0===o?new r.Timer("Access token expiring"):o,u=e.accessTokenExpiredTimer,c=void 0===u?new r.Timer("Access token expired"):u;s(this,t),this._accessTokenExpiringNotificationTime=i,this._accessTokenExpiring=a,this._accessTokenExpired=c}return t.prototype.load=function(t){if(t.access_token&&void 0!==t.expires_in){var e=t.expires_in;if(i.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",e),e>0){var n=e-this._accessTokenExpiringNotificationTime;n<=0&&(n=1),i.Log.debug("AccessTokenEvents.load: registering expiring timer in:",n),this._accessTokenExpiring.init(n)}else i.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var r=e+1;i.Log.debug("AccessTokenEvents.load: registering expired timer in:",r),this._accessTokenExpired.init(r)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},t.prototype.unload=function(){i.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},t.prototype.addAccessTokenExpiring=function(t){this._accessTokenExpiring.addHandler(t)},t.prototype.removeAccessTokenExpiring=function(t){this._accessTokenExpiring.removeHandler(t)},t.prototype.addAccessTokenExpired=function(t){this._accessTokenExpired.addHandler(t)},t.prototype.removeAccessTokenExpired=function(t){this._accessTokenExpired.removeHandler(t)},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.Event=void 0;var i=n(0);e.Event=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e,this._callbacks=[]}return t.prototype.addHandler=function(t){this._callbacks.push(t)},t.prototype.removeHandler=function(t){var e=this._callbacks.findIndex((function(e){return e===t}));e>=0&&this._callbacks.splice(e,1)},t.prototype.raise=function(){i.Log.debug("Event: Raising event: "+this._name);for(var t=0;t<this._callbacks.length;t++){var e;(e=this._callbacks)[t].apply(e,arguments)}},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SessionMonitor=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),s=n(19),o=n(1);function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.SessionMonitor=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.CheckSessionIFrame,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.Global.timer;if(a(this,t),!e)throw r.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=e,this._CheckSessionIFrameCtor=i,this._timer=u,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),Promise.resolve(this._userManager.getUser().then((function(t){t?n._start(t):n._settings.monitorAnonymousSession&&n._userManager.querySessionStatus().then((function(t){var e={session_state:t.session_state};t.sub&&t.sid&&(e.profile={sub:t.sub,sid:t.sid}),n._start(e)})).catch((function(t){r.Log.error("SessionMonitor ctor: error from querySessionStatus:",t.message)}))})).catch((function(t){r.Log.error("SessionMonitor ctor: error from getUser:",t.message)})))}return t.prototype._start=function(t){var e=this,n=t.session_state;n&&(t.profile?(this._sub=t.profile.sub,this._sid=t.profile.sid,r.Log.debug("SessionMonitor._start: session_state:",n,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,r.Log.debug("SessionMonitor._start: session_state:",n,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(n):this._metadataService.getCheckSessionIframe().then((function(t){if(t){r.Log.debug("SessionMonitor._start: Initializing check session iframe");var i=e._client_id,s=e._checkSessionInterval,o=e._stopCheckSessionOnError;e._checkSessionIFrame=new e._CheckSessionIFrameCtor(e._callback.bind(e),i,t,s,o),e._checkSessionIFrame.load().then((function(){e._checkSessionIFrame.start(n)}))}else r.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")})).catch((function(t){r.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",t.message)})))},t.prototype._stop=function(){var t=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(r.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var e=this._timer.setInterval((function(){t._timer.clearInterval(e),t._userManager.querySessionStatus().then((function(e){var n={session_state:e.session_state};e.sub&&e.sid&&(n.profile={sub:e.sub,sid:e.sid}),t._start(n)})).catch((function(t){r.Log.error("SessionMonitor: error from querySessionStatus:",t.message)}))}),1e3)},t.prototype._callback=function(){var t=this;this._userManager.querySessionStatus().then((function(e){var n=!0;e?e.sub===t._sub?(n=!1,t._checkSessionIFrame.start(e.session_state),e.sid===t._sid?r.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",e.session_state):(r.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",e.session_state),t._userManager.events._raiseUserSessionChanged())):r.Log.debug("SessionMonitor._callback: Different subject signed into OP:",e.sub):r.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),n&&(t._sub?(r.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),t._userManager.events._raiseUserSignedOut()):(r.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),t._userManager.events._raiseUserSignedIn()))})).catch((function(e){t._sub&&(r.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",e.message),t._userManager.events._raiseUserSignedOut())}))},i(t,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.CheckSessionIFrame=void 0;var i=n(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.CheckSessionIFrame=function(){function t(e,n,i,s){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];r(this,t),this._callback=e,this._client_id=n,this._url=i,this._interval=s||2e3,this._stopOnError=o;var a=i.indexOf("/",i.indexOf("//")+2);this._frame_origin=i.substr(0,a),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.width=0,this._frame.height=0,this._frame.src=i}return t.prototype.load=function(){var t=this;return new Promise((function(e){t._frame.onload=function(){e()},window.document.body.appendChild(t._frame),t._boundMessageEvent=t._message.bind(t),window.addEventListener("message",t._boundMessageEvent,!1)}))},t.prototype._message=function(t){t.origin===this._frame_origin&&t.source===this._frame.contentWindow&&("error"===t.data?(i.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===t.data?(i.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):i.Log.debug("CheckSessionIFrame: "+t.data+" message from check session op iframe"))},t.prototype.start=function(t){var e=this;if(this._session_state!==t){i.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=t;var n=function(){e._frame.contentWindow.postMessage(e._client_id+" "+e._session_state,e._frame_origin)};n(),this._timer=window.setInterval(n,this._interval)}},t.prototype.stop=function(){this._session_state=null,this._timer&&(i.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.TokenRevocationClient=void 0;var i=n(0),r=n(2),s=n(1);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a="access_token",u="refresh_token";e.TokenRevocationClient=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.Global.XMLHttpRequest,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.MetadataService;if(o(this,t),!e)throw i.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=e,this._XMLHttpRequestCtor=n,this._metadataService=new a(this._settings)}return t.prototype.revoke=function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"access_token";if(!t)throw i.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if(r!==a&&r!=u)throw i.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then((function(s){if(s){i.Log.debug("TokenRevocationClient.revoke: Revoking "+r);var o=n._settings.client_id,a=n._settings.client_secret;return n._revoke(s,o,a,t,r)}if(e)throw i.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")}))},t.prototype._revoke=function(t,e,n,r,s){var o=this;return new Promise((function(a,u){var c=new o._XMLHttpRequestCtor;c.open("POST",t),c.onload=function(){i.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",c.status),200===c.status?a():u(Error(c.statusText+" ("+c.status+")"))},c.onerror=function(){i.Log.debug("TokenRevocationClient.revoke: Network Error."),u("Network Error")};var l="client_id="+encodeURIComponent(e);n&&(l+="&client_secret="+encodeURIComponent(n)),l+="&token_type_hint="+encodeURIComponent(s),l+="&token="+encodeURIComponent(r),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send(l)}))},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.CordovaPopupWindow=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0);e.CordovaPopupWindow=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._promise=new Promise((function(t,e){n._resolve=t,n._reject=e})),this.features=e.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=e.popupWindowTarget||"_blank",this.redirect_uri=e.startUrl,r.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return t.prototype._isInAppBrowserInstalled=function(t){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some((function(e){return t.hasOwnProperty(e)}))},t.prototype.navigate=function(t){if(t&&t.url){if(!window.cordova)return this._error("cordova is undefined");var e=window.cordova.require("cordova/plugin_list").metadata;if(!1===this._isInAppBrowserInstalled(e))return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(t.url,this.target,this.features),this._popup?(r.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},t.prototype._loadStartCallback=function(t){0===t.url.indexOf(this.redirect_uri)&&this._success({url:t.url})},t.prototype._exitCallback=function(t){this._error(t)},t.prototype._success=function(t){this._cleanup(),r.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(t)},t.prototype._error=function(t){this._cleanup(),r.Log.error(t),this._reject(new Error(t))},t.prototype.close=function(){this._cleanup()},t.prototype._cleanup=function(){this._popup&&(r.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},i(t,[{key:"promise",get:function(){return this._promise}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=n(10),s=n(5),o=n(6),a=n(37),u=n(38),c=n(16),l=n(2),h=n(48),d=n(49),p=n(19),f=n(20),g=n(18),m=n(1),v=n(15),y=n(50);e.default={Version:y.Version,Log:i.Log,OidcClient:r.OidcClient,OidcClientSettings:s.OidcClientSettings,WebStorageStateStore:o.WebStorageStateStore,InMemoryWebStorage:a.InMemoryWebStorage,UserManager:u.UserManager,AccessTokenEvents:c.AccessTokenEvents,MetadataService:l.MetadataService,CordovaPopupNavigator:h.CordovaPopupNavigator,CordovaIFrameNavigator:d.CordovaIFrameNavigator,CheckSessionIFrame:p.CheckSessionIFrame,TokenRevocationClient:f.TokenRevocationClient,SessionMonitor:g.SessionMonitor,Global:m.Global,User:v.User},t.exports=e.default},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.ClockService=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.getEpochTime=function(){return Promise.resolve(Date.now()/1e3|0)},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.ResponseValidator=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(0),s=n(2),o=n(25),a=n(11),u=n(12),c=n(4);function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var h=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];e.ResponseValidator=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.MetadataService,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.UserInfoService,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c.JoseUtil,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a.TokenClient;if(l(this,t),!e)throw r.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=e,this._metadataService=new n(this._settings),this._userInfoService=new i(this._settings),this._joseUtil=u,this._tokenClient=new h(this._settings)}return t.prototype.validateSigninResponse=function(t,e){var n=this;return r.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(t,e).then((function(e){return r.Log.debug("ResponseValidator.validateSigninResponse: state processed"),n._validateTokens(t,e).then((function(e){return r.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),n._processClaims(t,e).then((function(t){return r.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),t}))}))}))},t.prototype.validateSignoutResponse=function(t,e){return t.id!==e.state?(r.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(r.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),e.state=t.data,e.error?(r.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",e.error),Promise.reject(new u.ErrorResponse(e))):Promise.resolve(e))},t.prototype._processSigninParams=function(t,e){if(t.id!==e.state)return r.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!t.client_id)return r.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!t.authority)return r.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==t.authority)return r.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=t.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==t.client_id)return r.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=t.client_id;return r.Log.debug("ResponseValidator._processSigninParams: state validated"),e.state=t.data,e.error?(r.Log.warn("ResponseValidator._processSigninParams: Response was error",e.error),Promise.reject(new u.ErrorResponse(e))):t.nonce&&!e.id_token?(r.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!t.nonce&&e.id_token?(r.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):t.code_verifier&&!e.code?(r.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!t.code_verifier&&e.code?(r.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(e.scope||(e.scope=t.scope),Promise.resolve(e))},t.prototype._processClaims=function(t,e){var n=this;if(e.isOpenIdConnect){if(r.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),e.profile=this._filterProtocolClaims(e.profile),!0!==t.skipUserInfo&&this._settings.loadUserInfo&&e.access_token)return r.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(e.access_token).then((function(t){return r.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),t.sub!==e.profile.sub?(r.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in id_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in id_token"))):(e.profile=n._mergeClaims(e.profile,t),r.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",e.profile),e)}));r.Log.debug("ResponseValidator._processClaims: not loading user info")}else r.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(e)},t.prototype._mergeClaims=function(t,e){var n=Object.assign({},t);for(var r in e){var s=e[r];Array.isArray(s)||(s=[s]);for(var o=0;o<s.length;o++){var a=s[o];n[r]?Array.isArray(n[r])?n[r].indexOf(a)<0&&n[r].push(a):n[r]!==a&&("object"===(void 0===a?"undefined":i(a))&&this._settings.mergeClaims?n[r]=this._mergeClaims(n[r],a):n[r]=[n[r],a]):n[r]=a}}return n},t.prototype._filterProtocolClaims=function(t){r.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",t);var e=Object.assign({},t);return this._settings._filterProtocolClaims?(h.forEach((function(t){delete e[t]})),r.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",e)):r.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),e},t.prototype._validateTokens=function(t,e){return e.code?(r.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(t,e)):e.id_token?e.access_token?(r.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(t,e)):(r.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(t,e)):(r.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(e))},t.prototype._processCode=function(t,e){var n=this,s={client_id:t.client_id,client_secret:t.client_secret,code:e.code,redirect_uri:t.redirect_uri,code_verifier:t.code_verifier};return t.extraTokenParams&&"object"===i(t.extraTokenParams)&&Object.assign(s,t.extraTokenParams),this._tokenClient.exchangeCode(s).then((function(i){for(var s in i)e[s]=i[s];return e.id_token?(r.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),n._validateIdTokenAttributes(t,e)):(r.Log.debug("ResponseValidator._processCode: token response successful, returning response"),e)}))},t.prototype._validateIdTokenAttributes=function(t,e){var n=this;return this._metadataService.getIssuer().then((function(i){var s=t.client_id,o=n._settings.clockSkew;return r.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",o),n._settings.getEpochTime().then((function(a){return n._joseUtil.validateJwtAttributes(e.id_token,i,s,o,a).then((function(n){return t.nonce&&t.nonce!==n.nonce?(r.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):n.sub?(e.profile=n,e):(r.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))}))},t.prototype._validateIdTokenAndAccessToken=function(t,e){var n=this;return this._validateIdToken(t,e).then((function(t){return n._validateAccessToken(t)}))},t.prototype._getSigningKeyForJwt=function(t){var e=this;return this._metadataService.getSigningKeys().then((function(n){var i=t.header.kid;if(!n)return r.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));r.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var s=void 0;if(i)s=n.filter((function(t){return t.kid===i}))[0];else{if((n=e._filterByAlg(n,t.header.alg)).length>1)return r.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));s=n[0]}return Promise.resolve(s)}))},t.prototype._getSigningKeyForJwtWithSingleRetry=function(t){var e=this;return this._getSigningKeyForJwt(t).then((function(n){return n?Promise.resolve(n):(e._metadataService.resetSigningKeys(),e._getSigningKeyForJwt(t))}))},t.prototype._validateIdToken=function(t,e){var n=this;if(!t.nonce)return r.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var i=this._joseUtil.parseJwt(e.id_token);return i&&i.header&&i.payload?t.nonce!==i.payload.nonce?(r.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):this._metadataService.getIssuer().then((function(s){return r.Log.debug("ResponseValidator._validateIdToken: Received issuer"),n._getSigningKeyForJwtWithSingleRetry(i).then((function(o){if(!o)return r.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var a=t.client_id,u=n._settings.clockSkew;return r.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",u),n._joseUtil.validateJwt(e.id_token,o,s,a,u).then((function(){return r.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),i.payload.sub?(e.profile=i.payload,e):(r.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))})):(r.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",i),Promise.reject(new Error("Failed to parse id_token")))},t.prototype._filterByAlg=function(t,e){var n=null;if(e.startsWith("RS"))n="RSA";else if(e.startsWith("PS"))n="PS";else{if(!e.startsWith("ES"))return r.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",e),[];n="EC"}return r.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",n),t=t.filter((function(t){return t.kty===n})),r.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",n,t.length),t},t.prototype._validateAccessToken=function(t){if(!t.profile)return r.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!t.profile.at_hash)return r.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!t.id_token)return r.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var e=this._joseUtil.parseJwt(t.id_token);if(!e||!e.header)return r.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",e),Promise.reject(new Error("Failed to parse id_token"));var n=e.header.alg;if(!n||5!==n.length)return r.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",n),Promise.reject(new Error("Unsupported alg: "+n));var i=n.substr(2,3);if(!i)return r.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",n,i),Promise.reject(new Error("Unsupported alg: "+n));if(256!==(i=parseInt(i))&&384!==i&&512!==i)return r.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",n,i),Promise.reject(new Error("Unsupported alg: "+n));var s="sha"+i,o=this._joseUtil.hashString(t.access_token,s);if(!o)return r.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",s),Promise.reject(new Error("Failed to validate at_hash"));var a=o.substr(0,o.length/2),u=this._joseUtil.hexToBase64Url(a);return u!==t.profile.at_hash?(r.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",u,t.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(r.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(t))},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.UserInfoService=void 0;var i=n(7),r=n(2),s=n(0),o=n(4);function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.UserInfoService=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.JsonService,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.MetadataService,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.JoseUtil;if(a(this,t),!e)throw s.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=e,this._jsonService=new n(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new u(this._settings),this._joseUtil=c}return t.prototype.getClaims=function(t){var e=this;return t?this._metadataService.getUserInfoEndpoint().then((function(n){return s.Log.debug("UserInfoService.getClaims: received userinfo url",n),e._jsonService.getJson(n,t).then((function(t){return s.Log.debug("UserInfoService.getClaims: claims received",t),t}))})):(s.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},t.prototype._getClaimsFromJwt=function(t){var e=this;try{var n=this._joseUtil.parseJwt(t.responseText);if(!n||!n.header||!n.payload)return s.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",n),Promise.reject(new Error("Failed to parse id_token"));var i=n.header.kid,r=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":r=this._metadataService.getIssuer();break;case"ANY":r=Promise.resolve(n.payload.iss);break;default:r=Promise.resolve(this._settings.userInfoJwtIssuer)}return r.then((function(r){return s.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+r),e._metadataService.getSigningKeys().then((function(o){if(!o)return s.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));s.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var a=void 0;if(i)a=o.filter((function(t){return t.kid===i}))[0];else{if((o=e._filterByAlg(o,n.header.alg)).length>1)return s.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));a=o[0]}if(!a)return s.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var u=e._settings.client_id,c=e._settings.clockSkew;return s.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",c),e._joseUtil.validateJwt(t.responseText,a,r,u,c,void 0,!0).then((function(){return s.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),n.payload}))}))}))}catch(t){return s.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",t.message),void reject(t)}},t.prototype._filterByAlg=function(t,e){var n=null;if(e.startsWith("RS"))n="RSA";else if(e.startsWith("PS"))n="PS";else{if(!e.startsWith("ES"))return s.Log.debug("UserInfoService._filterByAlg: alg not supported: ",e),[];n="EC"}return s.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",n),t=t.filter((function(t){return t.kty===n})),s.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",n,t.length),t},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.AllowedSigningAlgs=e.b64tohex=e.hextob64u=e.crypto=e.X509=e.KeyUtil=e.jws=void 0;var i=n(27);e.jws=i.jws,e.KeyUtil=i.KEYUTIL,e.X509=i.X509,e.crypto=i.crypto,e.hextob64u=i.hextob64u,e.b64tohex=i.b64tohex,e.AllowedSigningAlgs=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"]},function(t,e,n){(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i={userAgent:!1},r={};
/*!
Copyright (c) 2011, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.9.0
*/if(void 0===s)var s={};s.lang={extend:function(t,e,n){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var r=function(){};if(r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),n){var s;for(s in n)t.prototype[s]=n[s];var o=function(){},a=["toString","valueOf"];try{/MSIE/.test(i.userAgent)&&(o=function(t,e){for(s=0;s<a.length;s+=1){var n=a[s],i=e[n];"function"==typeof i&&i!=Object.prototype[n]&&(t[n]=i)}})}catch(t){}o(t.prototype,n)}}};
/*! CryptoJS v3.1.2 core-fix.js
 * code.google.com/p/crypto-js
 * (c) 2009-2013 by Jeff Mott. All rights reserved.
 * code.google.com/p/crypto-js/wiki/License
 * THIS IS FIX of 'core.js' to fix Hmac issue.
 * https://code.google.com/p/crypto-js/issues/detail?id=84
 * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
 */
var o,a,u,c,l,h,d,p,f,g,m,v=v||(o=Math,u=(a={}).lib={},c=u.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var n=new t;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=u.WordArray=c.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||d).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var s=0;s<r;s++){var o=n[s>>>2]>>>24-s%4*8&255;e[i+s>>>2]|=o<<24-(i+s)%4*8}else for(s=0;s<r;s+=4)e[i+s>>>2]=n[s>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=o.ceil(e/4)},clone:function(){var t=c.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(4294967296*o.random()|0);return new l.init(e,t)}}),h=a.enc={},d=h.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new l.init(n,e/2)}},p=h.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new l.init(n,e)}},f=h.Utf8={stringify:function(t){try{return decodeURIComponent(escape(p.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return p.parse(unescape(encodeURIComponent(t)))}},g=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,n=e.words,i=e.sigBytes,r=this.blockSize,s=i/(4*r),a=(s=t?o.ceil(s):o.max((0|s)-this._minBufferSize,0))*r,u=o.min(4*a,i);if(a){for(var c=0;c<a;c+=r)this._doProcessBlock(n,c);var h=n.splice(0,a);e.sigBytes-=u}return new l.init(h,u)},clone:function(){var t=c.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),u.Hasher=g.extend({cfg:c.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new m.HMAC.init(t,n).finalize(e)}}}),m=a.algo={},a);!function(t){var e,n=(e=v).lib,i=n.Base,r=n.WordArray;(e=e.x64={}).Word=i.extend({init:function(t,e){this.high=t,this.low=e}}),e.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,n=[],i=0;i<e;i++){var s=t[i];n.push(s.high),n.push(s.low)}return r.create(n,this.sigBytes)},clone:function(){for(var t=i.clone.call(this),e=t.words=this.words.slice(0),n=e.length,r=0;r<n;r++)e[r]=e[r].clone();return t}})}(),function(){var t=v,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp(),t=[];for(var r=0;r<n;r+=3)for(var s=(e[r>>>2]>>>24-r%4*8&255)<<16|(e[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|e[r+2>>>2]>>>24-(r+2)%4*8&255,o=0;4>o&&r+.75*o<n;o++)t.push(i.charAt(s>>>6*(3-o)&63));if(e=i.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var n=t.length,i=this._map;(r=i.charAt(64))&&-1!=(r=t.indexOf(r))&&(n=r);for(var r=[],s=0,o=0;o<n;o++)if(o%4){var a=i.indexOf(t.charAt(o-1))<<o%4*2,u=i.indexOf(t.charAt(o))>>>6-o%4*2;r[s>>>2]|=(a|u)<<24-s%4*8,s++}return e.create(r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){for(var e=v,n=(r=e.lib).WordArray,i=r.Hasher,r=e.algo,s=[],o=[],a=function(t){return 4294967296*(t-(0|t))|0},u=2,c=0;64>c;){var l;t:{l=u;for(var h=t.sqrt(l),d=2;d<=h;d++)if(!(l%d)){l=!1;break t}l=!0}l&&(8>c&&(s[c]=a(t.pow(u,.5))),o[c]=a(t.pow(u,1/3)),c++),u++}var p=[];r=r.SHA256=i.extend({_doReset:function(){this._hash=new n.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],s=n[2],a=n[3],u=n[4],c=n[5],l=n[6],h=n[7],d=0;64>d;d++){if(16>d)p[d]=0|t[e+d];else{var f=p[d-15],g=p[d-2];p[d]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+p[d-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+p[d-16]}f=h+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+o[d]+p[d],g=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&s^r&s),h=l,l=c,c=u,u=a+f|0,a=s,s=r,r=i,i=f+g|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}}),e.SHA256=i._createHelper(r),e.HmacSHA256=i._createHmacHelper(r)}(Math),function(){function t(){return i.create.apply(i,arguments)}for(var e=v,n=e.lib.Hasher,i=(s=e.x64).Word,r=s.WordArray,s=e.algo,o=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],a=[],u=0;80>u;u++)a[u]=t();s=s.SHA512=n.extend({_doReset:function(){this._hash=new r.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var n=(h=this._hash.words)[0],i=h[1],r=h[2],s=h[3],u=h[4],c=h[5],l=h[6],h=h[7],d=n.high,p=n.low,f=i.high,g=i.low,m=r.high,v=r.low,y=s.high,_=s.low,w=u.high,b=u.low,x=c.high,S=c.low,T=l.high,C=l.low,E=h.high,A=h.low,k=d,F=p,P=f,R=g,I=m,D=v,O=y,M=_,N=w,L=b,j=x,B=S,U=T,V=C,H=E,q=A,W=0;80>W;W++){var K=a[W];if(16>W)var z=K.high=0|t[e+2*W],J=K.low=0|t[e+2*W+1];else{z=((J=(z=a[W-15]).high)>>>1|(G=z.low)<<31)^(J>>>8|G<<24)^J>>>7;var G=(G>>>1|J<<31)^(G>>>8|J<<24)^(G>>>7|J<<25),Y=((J=(Y=a[W-2]).high)>>>19|($=Y.low)<<13)^(J<<3|$>>>29)^J>>>6,$=($>>>19|J<<13)^($<<3|J>>>29)^($>>>6|J<<26),X=(J=a[W-7]).high,Z=(Q=a[W-16]).high,Q=Q.low;z=(z=(z=z+X+((J=G+J.low)>>>0<G>>>0?1:0))+Y+((J+=$)>>>0<$>>>0?1:0))+Z+((J+=Q)>>>0<Q>>>0?1:0),K.high=z,K.low=J}X=N&j^~N&U,Q=L&B^~L&V,K=k&P^k&I^P&I;var tt=F&R^F&D^R&D,et=(G=(k>>>28|F<<4)^(k<<30|F>>>2)^(k<<25|F>>>7),Y=(F>>>28|k<<4)^(F<<30|k>>>2)^(F<<25|k>>>7),($=o[W]).high),nt=$.low;Z=H+((N>>>14|L<<18)^(N>>>18|L<<14)^(N<<23|L>>>9))+(($=q+((L>>>14|N<<18)^(L>>>18|N<<14)^(L<<23|N>>>9)))>>>0<q>>>0?1:0),H=U,q=V,U=j,V=B,j=N,B=L,N=O+(Z=(Z=(Z=Z+X+(($+=Q)>>>0<Q>>>0?1:0))+et+(($+=nt)>>>0<nt>>>0?1:0))+z+(($+=J)>>>0<J>>>0?1:0))+((L=M+$|0)>>>0<M>>>0?1:0)|0,O=I,M=D,I=P,D=R,P=k,R=F,k=Z+(K=G+K+((J=Y+tt)>>>0<Y>>>0?1:0))+((F=$+J|0)>>>0<$>>>0?1:0)|0}p=n.low=p+F,n.high=d+k+(p>>>0<F>>>0?1:0),g=i.low=g+R,i.high=f+P+(g>>>0<R>>>0?1:0),v=r.low=v+D,r.high=m+I+(v>>>0<D>>>0?1:0),_=s.low=_+M,s.high=y+O+(_>>>0<M>>>0?1:0),b=u.low=b+L,u.high=w+N+(b>>>0<L>>>0?1:0),S=c.low=S+B,c.high=x+j+(S>>>0<B>>>0?1:0),C=l.low=C+V,l.high=T+U+(C>>>0<V>>>0?1:0),A=h.low=A+q,h.high=E+H+(A>>>0<q>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),e[31+(i+128>>>10<<5)]=n,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),e.SHA512=n._createHelper(s),e.HmacSHA512=n._createHmacHelper(s)}(),function(){var t=v,e=(r=t.x64).Word,n=r.WordArray,i=(r=t.algo).SHA512,r=r.SHA384=i.extend({_doReset:function(){this._hash=new n.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var t=i._doFinalize.call(this);return t.sigBytes-=16,t}});t.SHA384=i._createHelper(r),t.HmacSHA384=i._createHmacHelper(r)}();
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
var y,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function w(t){var e,n,i="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),i+=_.charAt(n>>6)+_.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),i+=_.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),i+=_.charAt(n>>2)+_.charAt((3&n)<<4));(3&i.length)>0;)i+="=";return i}function b(t){var e,n,i,r="",s=0;for(e=0;e<t.length&&"="!=t.charAt(e);++e)(i=_.indexOf(t.charAt(e)))<0||(0==s?(r+=k(i>>2),n=3&i,s=1):1==s?(r+=k(n<<2|i>>4),n=15&i,s=2):2==s?(r+=k(n),r+=k(i>>2),n=3&i,s=3):(r+=k(n<<2|i>>4),r+=k(15&i),s=0));return 1==s&&(r+=k(n<<2)),r}function x(t){var e,n=b(t),i=new Array;for(e=0;2*e<n.length;++e)i[e]=parseInt(n.substring(2*e,2*e+2),16);return i}function S(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function T(){return new S(null)}"Microsoft Internet Explorer"==i.appName?(S.prototype.am=function(t,e,n,i,r,s){for(var o=32767&e,a=e>>15;--s>=0;){var u=32767&this[t],c=this[t++]>>15,l=a*u+c*o;r=((u=o*u+((32767&l)<<15)+n[i]+(1073741823&r))>>>30)+(l>>>15)+a*c+(r>>>30),n[i++]=1073741823&u}return r},y=30):"Netscape"!=i.appName?(S.prototype.am=function(t,e,n,i,r,s){for(;--s>=0;){var o=e*this[t++]+n[i]+r;r=Math.floor(o/67108864),n[i++]=67108863&o}return r},y=26):(S.prototype.am=function(t,e,n,i,r,s){for(var o=16383&e,a=e>>14;--s>=0;){var u=16383&this[t],c=this[t++]>>14,l=a*u+c*o;r=((u=o*u+((16383&l)<<14)+n[i]+r)>>28)+(l>>14)+a*c,n[i++]=268435455&u}return r},y=28),S.prototype.DB=y,S.prototype.DM=(1<<y)-1,S.prototype.DV=1<<y,S.prototype.FV=Math.pow(2,52),S.prototype.F1=52-y,S.prototype.F2=2*y-52;var C,E,A=new Array;for(C="0".charCodeAt(0),E=0;E<=9;++E)A[C++]=E;for(C="a".charCodeAt(0),E=10;E<36;++E)A[C++]=E;for(C="A".charCodeAt(0),E=10;E<36;++E)A[C++]=E;function k(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function F(t,e){var n=A[t.charCodeAt(e)];return null==n?-1:n}function P(t){var e=T();return e.fromInt(t),e}function R(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function I(t){this.m=t}function D(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function O(t,e){return t&e}function M(t,e){return t|e}function N(t,e){return t^e}function L(t,e){return t&~e}function j(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function B(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function U(){}function V(t){return t}function H(t){this.r2=T(),this.q3=T(),S.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}I.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},I.prototype.revert=function(t){return t},I.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},I.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},I.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},D.prototype.convert=function(t){var e=T();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(S.ZERO)>0&&this.m.subTo(e,e),e},D.prototype.revert=function(t){var e=T();return t.copyTo(e),this.reduce(e),e},D.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],i=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},D.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},D.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},S.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},S.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},S.prototype.fromString=function(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var i=t.length,r=!1,s=0;--i>=0;){var o=8==n?255&t[i]:F(t,i);o<0?"-"==t.charAt(i)&&(r=!0):(r=!1,0==s?this[this.t++]=o:s+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),r&&S.ZERO.subTo(this,this)},S.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},S.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},S.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},S.prototype.lShiftTo=function(t,e){var n,i=t%this.DB,r=this.DB-i,s=(1<<r)-1,o=Math.floor(t/this.DB),a=this.s<<i&this.DM;for(n=this.t-1;n>=0;--n)e[n+o+1]=this[n]>>r|a,a=(this[n]&s)<<i;for(n=o-1;n>=0;--n)e[n]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()},S.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var i=t%this.DB,r=this.DB-i,s=(1<<i)-1;e[0]=this[n]>>i;for(var o=n+1;o<this.t;++o)e[o-n-1]|=(this[o]&s)<<r,e[o-n]=this[o]>>i;i>0&&(e[this.t-n-1]|=(this.s&s)<<r),e.t=this.t-n,e.clamp()}},S.prototype.subTo=function(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]-t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i-=t[n],e[n++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[n++]=this.DV+i:i>0&&(e[n++]=i),e.t=n,e.clamp()},S.prototype.multiplyTo=function(t,e){var n=this.abs(),i=t.abs(),r=n.t;for(e.t=r+i.t;--r>=0;)e[r]=0;for(r=0;r<i.t;++r)e[r+n.t]=n.am(0,i[r],e,r,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&S.ZERO.subTo(e,e)},S.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var i=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,i,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},S.prototype.divRemTo=function(t,e,n){var i=t.abs();if(!(i.t<=0)){var r=this.abs();if(r.t<i.t)return null!=e&&e.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=T());var s=T(),o=this.s,a=t.s,u=this.DB-R(i[i.t-1]);u>0?(i.lShiftTo(u,s),r.lShiftTo(u,n)):(i.copyTo(s),r.copyTo(n));var c=s.t,l=s[c-1];if(0!=l){var h=l*(1<<this.F1)+(c>1?s[c-2]>>this.F2:0),d=this.FV/h,p=(1<<this.F1)/h,f=1<<this.F2,g=n.t,m=g-c,v=null==e?T():e;for(s.dlShiftTo(m,v),n.compareTo(v)>=0&&(n[n.t++]=1,n.subTo(v,n)),S.ONE.dlShiftTo(c,v),v.subTo(s,s);s.t<c;)s[s.t++]=0;for(;--m>=0;){var y=n[--g]==l?this.DM:Math.floor(n[g]*d+(n[g-1]+f)*p);if((n[g]+=s.am(0,y,n,m,0,c))<y)for(s.dlShiftTo(m,v),n.subTo(v,n);n[g]<--y;)n.subTo(v,n)}null!=e&&(n.drShiftTo(c,e),o!=a&&S.ZERO.subTo(e,e)),n.t=c,n.clamp(),u>0&&n.rShiftTo(u,n),o<0&&S.ZERO.subTo(n,n)}}},S.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},S.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},S.prototype.exp=function(t,e){if(t>4294967295||t<1)return S.ONE;var n=T(),i=T(),r=e.convert(this),s=R(t)-1;for(r.copyTo(n);--s>=0;)if(e.sqrTo(n,i),(t&1<<s)>0)e.mulTo(i,r,n);else{var o=n;n=i,i=o}return e.revert(n)},S.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,i=(1<<e)-1,r=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this[o]>>a)>0&&(r=!0,s=k(n));o>=0;)a<e?(n=(this[o]&(1<<a)-1)<<e-a,n|=this[--o]>>(a+=this.DB-e)):(n=this[o]>>(a-=e)&i,a<=0&&(a+=this.DB,--o)),n>0&&(r=!0),r&&(s+=k(n));return r?s:"0"},S.prototype.negate=function(){var t=T();return S.ZERO.subTo(this,t),t},S.prototype.abs=function(){return this.s<0?this.negate():this},S.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},S.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+R(this[this.t-1]^this.s&this.DM)},S.prototype.mod=function(t){var e=T();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(S.ZERO)>0&&t.subTo(e,e),e},S.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new I(e):new D(e),this.exp(t,n)},S.ZERO=P(0),S.ONE=P(1),U.prototype.convert=V,U.prototype.revert=V,U.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},U.prototype.sqrTo=function(t,e){t.squareTo(e)},H.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=T();return t.copyTo(e),this.reduce(e),e},H.prototype.revert=function(t){return t},H.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},H.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},H.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var q,W,K,z=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],J=67108864/z[z.length-1];
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function G(){this.i=0,this.j=0,this.S=new Array}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function Y(){!function(t){W[K++]^=255&t,W[K++]^=t>>8&255,W[K++]^=t>>16&255,W[K++]^=t>>24&255,K>=256&&(K-=256)}((new Date).getTime())}if(S.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},S.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),i=P(n),r=T(),s=T(),o="";for(this.divRemTo(i,r,s);r.signum()>0;)o=(n+s.intValue()).toString(t).substr(1)+o,r.divRemTo(i,r,s);return s.intValue().toString(t)+o},S.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),i=Math.pow(e,n),r=!1,s=0,o=0,a=0;a<t.length;++a){var u=F(t,a);u<0?"-"==t.charAt(a)&&0==this.signum()&&(r=!0):(o=e*o+u,++s>=n&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),r&&S.ZERO.subTo(this,this)},S.prototype.fromNumber=function(t,e,n){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(S.ONE.shiftLeft(t-1),M,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(S.ONE.shiftLeft(t-1),this);else{var i=new Array,r=7&t;i.length=1+(t>>3),e.nextBytes(i),r>0?i[0]&=(1<<r)-1:i[0]=0,this.fromString(i,256)}},S.prototype.bitwiseTo=function(t,e,n){var i,r,s=Math.min(t.t,this.t);for(i=0;i<s;++i)n[i]=e(this[i],t[i]);if(t.t<this.t){for(r=t.s&this.DM,i=s;i<this.t;++i)n[i]=e(this[i],r);n.t=this.t}else{for(r=this.s&this.DM,i=s;i<t.t;++i)n[i]=e(r,t[i]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},S.prototype.changeBit=function(t,e){var n=S.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n},S.prototype.addTo=function(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]+t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i+=t[n],e[n++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e[n++]=i:i<-1&&(e[n++]=this.DV+i),e.t=n,e.clamp()},S.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},S.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},S.prototype.multiplyLowerTo=function(t,e,n){var i,r=Math.min(this.t+t.t,e);for(n.s=0,n.t=r;r>0;)n[--r]=0;for(i=n.t-this.t;r<i;++r)n[r+this.t]=this.am(0,t[r],n,r,0,this.t);for(i=Math.min(t.t,e);r<i;++r)this.am(0,t[r],n,r,0,e-r);n.clamp()},S.prototype.multiplyUpperTo=function(t,e,n){--e;var i=n.t=this.t+t.t-e;for(n.s=0;--i>=0;)n[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)n[this.t+i-e]=this.am(e-i,t[i],n,0,0,this.t+i-e);n.clamp(),n.drShiftTo(1,n)},S.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var i=this.t-1;i>=0;--i)n=(e*n+this[i])%t;return n},S.prototype.millerRabin=function(t){var e=this.subtract(S.ONE),n=e.getLowestSetBit();if(n<=0)return!1;var i=e.shiftRight(n);(t=t+1>>1)>z.length&&(t=z.length);for(var r=T(),s=0;s<t;++s){r.fromInt(z[Math.floor(Math.random()*z.length)]);var o=r.modPow(i,this);if(0!=o.compareTo(S.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<n&&0!=o.compareTo(e);)if(0==(o=o.modPowInt(2,this)).compareTo(S.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0},S.prototype.clone=
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function(){var t=T();return this.copyTo(t),t},S.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},S.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},S.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},S.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},S.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var n,i=this.DB-t*this.DB%8,r=0;if(t-- >0)for(i<this.DB&&(n=this[t]>>i)!=(this.s&this.DM)>>i&&(e[r++]=n|this.s<<this.DB-i);t>=0;)i<8?(n=(this[t]&(1<<i)-1)<<8-i,n|=this[--t]>>(i+=this.DB-8)):(n=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(e[r++]=n);return e},S.prototype.equals=function(t){return 0==this.compareTo(t)},S.prototype.min=function(t){return this.compareTo(t)<0?this:t},S.prototype.max=function(t){return this.compareTo(t)>0?this:t},S.prototype.and=function(t){var e=T();return this.bitwiseTo(t,O,e),e},S.prototype.or=function(t){var e=T();return this.bitwiseTo(t,M,e),e},S.prototype.xor=function(t){var e=T();return this.bitwiseTo(t,N,e),e},S.prototype.andNot=function(t){var e=T();return this.bitwiseTo(t,L,e),e},S.prototype.not=function(){for(var t=T(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},S.prototype.shiftLeft=function(t){var e=T();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},S.prototype.shiftRight=function(t){var e=T();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},S.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+j(this[t]);return this.s<0?this.t*this.DB:-1},S.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=B(this[n]^e);return t},S.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},S.prototype.setBit=function(t){return this.changeBit(t,M)},S.prototype.clearBit=function(t){return this.changeBit(t,L)},S.prototype.flipBit=function(t){return this.changeBit(t,N)},S.prototype.add=function(t){var e=T();return this.addTo(t,e),e},S.prototype.subtract=function(t){var e=T();return this.subTo(t,e),e},S.prototype.multiply=function(t){var e=T();return this.multiplyTo(t,e),e},S.prototype.divide=function(t){var e=T();return this.divRemTo(t,e,null),e},S.prototype.remainder=function(t){var e=T();return this.divRemTo(t,null,e),e},S.prototype.divideAndRemainder=function(t){var e=T(),n=T();return this.divRemTo(t,e,n),new Array(e,n)},S.prototype.modPow=function(t,e){var n,i,r=t.bitLength(),s=P(1);if(r<=0)return s;n=r<18?1:r<48?3:r<144?4:r<768?5:6,i=r<8?new I(e):e.isEven()?new H(e):new D(e);var o=new Array,a=3,u=n-1,c=(1<<n)-1;if(o[1]=i.convert(this),n>1){var l=T();for(i.sqrTo(o[1],l);a<=c;)o[a]=T(),i.mulTo(l,o[a-2],o[a]),a+=2}var h,d,p=t.t-1,f=!0,g=T();for(r=R(t[p])-1;p>=0;){for(r>=u?h=t[p]>>r-u&c:(h=(t[p]&(1<<r+1)-1)<<u-r,p>0&&(h|=t[p-1]>>this.DB+r-u)),a=n;0==(1&h);)h>>=1,--a;if((r-=a)<0&&(r+=this.DB,--p),f)o[h].copyTo(s),f=!1;else{for(;a>1;)i.sqrTo(s,g),i.sqrTo(g,s),a-=2;a>0?i.sqrTo(s,g):(d=s,s=g,g=d),i.mulTo(g,o[h],s)}for(;p>=0&&0==(t[p]&1<<r);)i.sqrTo(s,g),d=s,s=g,g=d,--r<0&&(r=this.DB-1,--p)}return i.revert(s)},S.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return S.ZERO;for(var n=t.clone(),i=this.clone(),r=P(1),s=P(0),o=P(0),a=P(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(r.isEven()&&s.isEven()||(r.addTo(this,r),s.subTo(t,s)),r.rShiftTo(1,r)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);n.compareTo(i)>=0?(n.subTo(i,n),e&&r.subTo(o,r),s.subTo(a,s)):(i.subTo(n,i),e&&o.subTo(r,o),a.subTo(s,a))}return 0!=i.compareTo(S.ONE)?S.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a},S.prototype.pow=function(t){return this.exp(t,new U)},S.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var i=e;e=n,n=i}var r=e.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return e;for(r<s&&(s=r),s>0&&(e.rShiftTo(s,e),n.rShiftTo(s,n));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n},S.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=z[z.length-1]){for(e=0;e<z.length;++e)if(n[0]==z[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<z.length;){for(var i=z[e],r=e+1;r<z.length&&i<J;)i*=z[r++];for(i=n.modInt(i);e<r;)if(i%z[e++]==0)return!1}return n.millerRabin(t)},S.prototype.square=function(){var t=T();return this.squareTo(t),t},G.prototype.init=function(t){var e,n,i;for(e=0;e<256;++e)this.S[e]=e;for(n=0,e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,i=this.S[e],this.S[e]=this.S[n],this.S[n]=i;this.i=0,this.j=0},G.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]},null==W){var $;if(W=new Array,K=0,void 0!==r&&(void 0!==r.crypto||void 0!==r.msCrypto)){var X=r.crypto||r.msCrypto;if(X.getRandomValues){var Z=new Uint8Array(32);for(X.getRandomValues(Z),$=0;$<32;++$)W[K++]=Z[$]}else if("Netscape"==i.appName&&i.appVersion<"5"){var Q=r.crypto.random(32);for($=0;$<Q.length;++$)W[K++]=255&Q.charCodeAt($)}}for(;K<256;)$=Math.floor(65536*Math.random()),W[K++]=$>>>8,W[K++]=255&$;K=0,Y()}function tt(){if(null==q){for(Y(),(q=new G).init(W),K=0;K<W.length;++K)W[K]=0;K=0}return q.next()}function et(){}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function nt(t,e){return new S(t,e)}function it(t,e,n){for(var i="",r=0;i.length<e;)i+=n(String.fromCharCode.apply(String,t.concat([(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r]))),r+=1;return i}function rt(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */}function st(t,e){this.x=e,this.q=t}function ot(t,e,n,i){this.curve=t,this.x=e,this.y=n,this.z=null==i?S.ONE:i,this.zinv=null}function at(t,e,n){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(n),this.infinity=new ot(this,null,null)}et.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=tt()},rt.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},rt.prototype.setPublic=function(t,e){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=e;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA public key";this.n=nt(t,16),this.e=parseInt(e,16)}},rt.prototype.encrypt=function(t){var e=function(t,e){if(e<t.length+11)throw"Message too long for RSA";for(var n=new Array,i=t.length-1;i>=0&&e>0;){var r=t.charCodeAt(i--);r<128?n[--e]=r:r>127&&r<2048?(n[--e]=63&r|128,n[--e]=r>>6|192):(n[--e]=63&r|128,n[--e]=r>>6&63|128,n[--e]=r>>12|224)}n[--e]=0;for(var s=new et,o=new Array;e>2;){for(o[0]=0;0==o[0];)s.nextBytes(o);n[--e]=o[0]}return n[--e]=2,n[--e]=0,new S(n)}(t,this.n.bitLength()+7>>3);if(null==e)return null;var n=this.doPublic(e);if(null==n)return null;var i=n.toString(16);return 0==(1&i.length)?i:"0"+i},rt.prototype.encryptOAEP=function(t,e,n){var i=function(t,e,n,i){var r=ct.crypto.MessageDigest,s=ct.crypto.Util,o=null;if(n||(n="sha1"),"string"==typeof n&&(o=r.getCanonicalAlgName(n),i=r.getHashLength(o),n=function(t){return St(s.hashHex(Tt(t),o))}),t.length+2*i+2>e)throw"Message too long for RSA";var a,u="";for(a=0;a<e-t.length-2*i-2;a+=1)u+="\0";var c=n("")+u+""+t,l=new Array(i);(new et).nextBytes(l);var h=it(l,c.length,n),d=[];for(a=0;a<c.length;a+=1)d[a]=c.charCodeAt(a)^h.charCodeAt(a);var p=it(d,l.length,n),f=[0];for(a=0;a<l.length;a+=1)f[a+1]=l[a]^p.charCodeAt(a);return new S(f.concat(d))}(t,this.n.bitLength()+7>>3,e,n);if(null==i)return null;var r=this.doPublic(i);if(null==r)return null;var s=r.toString(16);return 0==(1&s.length)?s:"0"+s},rt.prototype.type="RSA",st.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},st.prototype.toBigInteger=function(){return this.x},st.prototype.negate=function(){return new st(this.q,this.x.negate().mod(this.q))},st.prototype.add=function(t){return new st(this.q,this.x.add(t.toBigInteger()).mod(this.q))},st.prototype.subtract=function(t){return new st(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},st.prototype.multiply=function(t){return new st(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},st.prototype.square=function(){return new st(this.q,this.x.square().mod(this.q))},st.prototype.divide=function(t){return new st(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},ot.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ot.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ot.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(S.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(S.ZERO))},ot.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(S.ZERO)&&!this.y.toBigInteger().equals(S.ZERO)},ot.prototype.negate=function(){return new ot(this.curve,this.x,this.y.negate(),this.z)},ot.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),n=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(S.ZERO.equals(n))return S.ZERO.equals(e)?this.twice():this.curve.getInfinity();var i=new S("3"),r=this.x.toBigInteger(),s=this.y.toBigInteger(),o=(t.x.toBigInteger(),t.y.toBigInteger(),n.square()),a=o.multiply(n),u=r.multiply(o),c=e.square().multiply(this.z),l=c.subtract(u.shiftLeft(1)).multiply(t.z).subtract(a).multiply(n).mod(this.curve.q),h=u.multiply(i).multiply(e).subtract(s.multiply(a)).subtract(c.multiply(e)).multiply(t.z).add(e.multiply(a)).mod(this.curve.q),d=a.multiply(this.z).multiply(t.z).mod(this.curve.q);return new ot(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(h),d)},ot.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new S("3"),e=this.x.toBigInteger(),n=this.y.toBigInteger(),i=n.multiply(this.z),r=i.multiply(n).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=e.square().multiply(t);S.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s)));var a=(o=o.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(r)).shiftLeft(1).multiply(i).mod(this.curve.q),u=o.multiply(t).multiply(e).subtract(r.shiftLeft(1)).shiftLeft(2).multiply(r).subtract(o.square().multiply(o)).mod(this.curve.q),c=i.square().multiply(i).shiftLeft(3).mod(this.curve.q);return new ot(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(u),c)},ot.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,n=t,i=n.multiply(new S("3")),r=this.negate(),s=this,o=this.curve.q.subtract(t),a=o.multiply(new S("3")),u=new ot(this.curve,this.x,this.y),c=u.negate();for(e=i.bitLength()-2;e>0;--e){s=s.twice();var l=i.testBit(e);l!=n.testBit(e)&&(s=s.add(l?this:r))}for(e=a.bitLength()-2;e>0;--e){u=u.twice();var h=a.testBit(e);h!=o.testBit(e)&&(u=u.add(h?u:c))}return s},ot.prototype.multiplyTwo=function(t,e,n){var i;i=t.bitLength()>n.bitLength()?t.bitLength()-1:n.bitLength()-1;for(var r=this.curve.getInfinity(),s=this.add(e);i>=0;)r=r.twice(),t.testBit(i)?r=n.testBit(i)?r.add(s):r.add(this):n.testBit(i)&&(r=r.add(e)),--i;return r},at.prototype.getQ=function(){return this.q},at.prototype.getA=function(){return this.a},at.prototype.getB=function(){return this.b},at.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},at.prototype.getInfinity=function(){return this.infinity},at.prototype.fromBigInteger=function(t){return new st(this.q,t)},at.prototype.decodePointHex=function(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:default:return null;case 4:case 6:case 7:var e=(t.length-2)/2,n=t.substr(2,e),i=t.substr(e+2,e);return new ot(this,this.fromBigInteger(new S(n,16)),this.fromBigInteger(new S(i,16)))}},
/*! (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
 */
st.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ot.prototype.getEncoded=function(t){var e=function(t,e){var n=t.toByteArrayUnsigned();if(e<n.length)n=n.slice(n.length-e);else for(;e>n.length;)n.unshift(0);return n},n=this.getX().toBigInteger(),i=this.getY().toBigInteger(),r=e(n,32);return t?i.isEven()?r.unshift(2):r.unshift(3):(r.unshift(4),r=r.concat(e(i,32))),r},ot.decodeFrom=function(t,e){e[0];var n=e.length-1,i=e.slice(1,1+n/2),r=e.slice(1+n/2,1+n);i.unshift(0),r.unshift(0);var s=new S(i),o=new S(r);return new ot(t,t.fromBigInteger(s),t.fromBigInteger(o))},ot.decodeFromHex=function(t,e){e.substr(0,2);var n=e.length-2,i=e.substr(2,n/2),r=e.substr(2+n/2,n/2),s=new S(i,16),o=new S(r,16);return new ot(t,t.fromBigInteger(s),t.fromBigInteger(o))},ot.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),n=t.y.subtract(this.y).divide(e),i=n.square().subtract(this.x).subtract(t.x),r=n.multiply(this.x.subtract(i)).subtract(this.y);return new ot(this.curve,i,r)},ot.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(S.valueOf(2)),e=this.curve.fromBigInteger(S.valueOf(3)),n=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),i=n.square().subtract(this.x.multiply(t)),r=n.multiply(this.x.subtract(i)).subtract(this.y);return new ot(this.curve,i,r)},ot.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,n=t,i=n.multiply(new S("3")),r=this.negate(),s=this;for(e=i.bitLength()-2;e>0;--e){s=s.twice();var o=i.testBit(e);o!=n.testBit(e)&&(s=s.add2D(o?this:r))}return s},ot.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),n=this.curve.getA().toBigInteger(),i=this.curve.getB().toBigInteger(),r=this.curve.getQ(),s=e.multiply(e).mod(r),o=t.multiply(t).multiply(t).add(n.multiply(t)).add(i).mod(r);return s.equals(o)},ot.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ot.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),n=this.getY().toBigInteger();if(e.compareTo(S.ONE)<0||e.compareTo(t.subtract(S.ONE))>0)throw new Error("x coordinate out of bounds");if(n.compareTo(S.ONE)<0||n.compareTo(t.subtract(S.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};
/*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
 */
var ut=function(){var t=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),e=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),i={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function r(t,e,n){return e?i[e]:String.fromCharCode(parseInt(n,16))}var s=new String(""),o=Object.hasOwnProperty;return function(i,a){var u,c,l=i.match(t),h=l[0],d=!1;"{"===h?u={}:"["===h?u=[]:(u=[],d=!0);for(var p=[u],f=1-d,g=l.length;f<g;++f){var m;switch((h=l[f]).charCodeAt(0)){default:(m=p[0])[c||m.length]=+h,c=void 0;break;case 34:if(-1!==(h=h.substring(1,h.length-1)).indexOf("\\")&&(h=h.replace(e,r)),m=p[0],!c){if(!(m instanceof Array)){c=h||s;break}c=m.length}m[c]=h,c=void 0;break;case 91:m=p[0],p.unshift(m[c||m.length]=[]),c=void 0;break;case 93:case 125:p.shift();break;case 102:(m=p[0])[c||m.length]=!1,c=void 0;break;case 110:(m=p[0])[c||m.length]=null,c=void 0;break;case 116:(m=p[0])[c||m.length]=!0,c=void 0;break;case 123:m=p[0],p.unshift(m[c||m.length]={}),c=void 0}}if(d){if(1!==p.length)throw new Error;u=u[0]}else if(p.length)throw new Error;return a&&(u=function t(e,i){var r=e[i];if(r&&"object"===(void 0===r?"undefined":n(r))){var s=null;for(var u in r)if(o.call(r,u)&&r!==e){var c=t(r,u);void 0!==c?r[u]=c:(s||(s=[]),s.push(u))}if(s)for(var l=s.length;--l>=0;)delete r[s[l]]}return a.call(e,i,r)}({"":u},"")),u}}();void 0!==ct&&ct||(e.KJUR=ct={}),void 0!==ct.asn1&&ct.asn1||(ct.asn1={}),ct.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=e.substr(1).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var i="",r=0;r<n;r++)i+="f";e=new S(i,16).xor(t).add(S.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return kt(t,e)},this.newObject=function(t){var e=ct.asn1,n=e.ASN1Object,i=e.DERBoolean,r=e.DERInteger,s=e.DERBitString,o=e.DEROctetString,a=e.DERNull,u=e.DERObjectIdentifier,c=e.DEREnumerated,l=e.DERUTF8String,h=e.DERNumericString,d=e.DERPrintableString,p=e.DERTeletexString,f=e.DERIA5String,g=e.DERUTCTime,m=e.DERGeneralizedTime,v=e.DERVisibleString,y=e.DERBMPString,_=e.DERSequence,w=e.DERSet,b=e.DERTaggedObject,x=e.ASN1Util.newObject;if(t instanceof e.ASN1Object)return t;var S=Object.keys(t);if(1!=S.length)throw new Error("key of param shall be only one.");var T=S[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+T+":"))throw new Error("undefined key: "+T);if("bool"==T)return new i(t[T]);if("int"==T)return new r(t[T]);if("bitstr"==T)return new s(t[T]);if("octstr"==T)return new o(t[T]);if("null"==T)return new a(t[T]);if("oid"==T)return new u(t[T]);if("enum"==T)return new c(t[T]);if("utf8str"==T)return new l(t[T]);if("numstr"==T)return new h(t[T]);if("prnstr"==T)return new d(t[T]);if("telstr"==T)return new p(t[T]);if("ia5str"==T)return new f(t[T]);if("utctime"==T)return new g(t[T]);if("gentime"==T)return new m(t[T]);if("visstr"==T)return new v(t[T]);if("bmpstr"==T)return new y(t[T]);if("asn1"==T)return new n(t[T]);if("seq"==T){for(var C=t[T],E=[],A=0;A<C.length;A++){var k=x(C[A]);E.push(k)}return new _({array:E})}if("set"==T){for(C=t[T],E=[],A=0;A<C.length;A++)k=x(C[A]),E.push(k);return new w({array:E})}if("tag"==T){var F=t[T];if("[object Array]"===Object.prototype.toString.call(F)&&3==F.length){var P=x(F[2]);return new b({tag:F[0],explicit:F[1],obj:P})}return new b(F)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},ct.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",n=parseInt(t.substr(0,2),16),i=(e=Math.floor(n/40)+"."+n%40,""),r=2;r<t.length;r+=2){var s=("00000000"+parseInt(t.substr(r,2),16).toString(2)).slice(-8);i+=s.substr(1,7),"0"==s.substr(0,1)&&(e=e+"."+new S(i,2).toString(10),i="")}return e},ct.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",i=new S(t,10).toString(2),r=7-i.length%7;7==r&&(r=0);for(var s="",o=0;o<r;o++)s+="0";for(i=s+i,o=0;o<i.length-1;o+=7){var a=i.substr(o,7);o!=i.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);i+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)i+=n(r[o]);return i},ct.asn1.ASN1Object=function(t){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n=0,v="+this.hV);var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var n=e.length/2;if(n>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(t){this.params=t},null!=t&&null!=t.tlv&&(this.hTLV=t.tlv,this.isModified=!1)},ct.asn1.DERAbstractString=function(t){ct.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=bt(this.s).toLowerCase()},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},s.lang.extend(ct.asn1.DERAbstractString,ct.asn1.ASN1Object),ct.asn1.DERAbstractTime=function(t){ct.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){var e=t.getTime()+6e4*t.getTimezoneOffset();return new Date(e)},this.formatDate=function(t,e,n){var i=this.zeroPadding,r=this.localDateToUTC(t),s=String(r.getFullYear());"utc"==e&&(s=s.substr(2,2));var o=s+i(String(r.getMonth()+1),2)+i(String(r.getDate()),2)+i(String(r.getHours()),2)+i(String(r.getMinutes()),2)+i(String(r.getSeconds()),2);if(!0===n){var a=r.getMilliseconds();if(0!=a){var u=i(String(a),3);o=o+"."+(u=u.replace(/[0]+$/,""))}}return o+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=mt(t)},this.setByDateValue=function(t,e,n,i,r,s){var o=new Date(Date.UTC(t,e-1,n,i,r,s,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},s.lang.extend(ct.asn1.DERAbstractTime,ct.asn1.ASN1Object),ct.asn1.DERAbstractStructured=function(t){ct.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},s.lang.extend(ct.asn1.DERAbstractStructured,ct.asn1.ASN1Object),ct.asn1.DERBoolean=function(t){ct.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==t?"010100":"0101ff"},s.lang.extend(ct.asn1.DERBoolean,ct.asn1.ASN1Object),ct.asn1.DERInteger=function(t){ct.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=ct.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new S(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},s.lang.extend(ct.asn1.DERInteger,ct.asn1.ASN1Object),ct.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=ct.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}ct.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.hTLV=null,this.isModified=!0,this.hV=n+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var n=0;n<=e;n++)t+="0";var i="";for(n=0;n<t.length-1;n+=8){var r=t.substr(n,8),s=parseInt(r,2).toString(16);1==s.length&&(s="0"+s),i+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+i},this.setByBooleanArray=function(t){for(var e="",n=0;n<t.length;n++)1==t[n]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},s.lang.extend(ct.asn1.DERBitString,ct.asn1.ASN1Object),ct.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=ct.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}ct.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},s.lang.extend(ct.asn1.DEROctetString,ct.asn1.DERAbstractString),ct.asn1.DERNull=function(){ct.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},s.lang.extend(ct.asn1.DERNull,ct.asn1.ASN1Object),ct.asn1.DERObjectIdentifier=function(t){ct.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){var e=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",i=parseInt(t,10).toString(2),r=7-i.length%7;7==r&&(r=0);for(var s="",o=0;o<r;o++)s+="0";for(i=s+i,o=0;o<i.length-1;o+=7){var a=i.substr(o,7);o!=i.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};try{if(!t.match(/^[0-9.]+$/))return null;var i="",r=t.split("."),s=40*parseInt(r[0],10)+parseInt(r[1],10);i+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)i+=n(r[o]);return i}catch(t){return null}}(t);if(null==e)throw new Error("malformed oid string: "+t);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueName=function(t){var e=ct.asn1.x509.OID.name2oid(t);if(""===e)throw new Error("DERObjectIdentifier oidName undefined: "+t);this.setValueOidString(e)},this.setValueNameOrOid=function(t){t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(t){"string"==typeof t?this.setValueNameOrOid(t):void 0!==t.oid?this.setValueNameOrOid(t.oid):void 0!==t.name?this.setValueNameOrOid(t.name):void 0!==t.hex&&this.setValueHex(t.hex)},void 0!==t&&this.setByParam(t)},s.lang.extend(ct.asn1.DERObjectIdentifier,ct.asn1.ASN1Object),ct.asn1.DEREnumerated=function(t){ct.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=ct.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new S(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},s.lang.extend(ct.asn1.DEREnumerated,ct.asn1.ASN1Object),ct.asn1.DERUTF8String=function(t){ct.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},s.lang.extend(ct.asn1.DERUTF8String,ct.asn1.DERAbstractString),ct.asn1.DERNumericString=function(t){ct.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},s.lang.extend(ct.asn1.DERNumericString,ct.asn1.DERAbstractString),ct.asn1.DERPrintableString=function(t){ct.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},s.lang.extend(ct.asn1.DERPrintableString,ct.asn1.DERAbstractString),ct.asn1.DERTeletexString=function(t){ct.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},s.lang.extend(ct.asn1.DERTeletexString,ct.asn1.DERAbstractString),ct.asn1.DERIA5String=function(t){ct.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},s.lang.extend(ct.asn1.DERIA5String,ct.asn1.DERAbstractString),ct.asn1.DERVisibleString=function(t){ct.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="1a"},s.lang.extend(ct.asn1.DERVisibleString,ct.asn1.DERAbstractString),ct.asn1.DERBMPString=function(t){ct.asn1.DERBMPString.superclass.constructor.call(this,t),this.hT="1e"},s.lang.extend(ct.asn1.DERBMPString,ct.asn1.DERAbstractString),ct.asn1.DERUTCTime=function(t){ct.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=mt(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=mt(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},s.lang.extend(ct.asn1.DERUTCTime,ct.asn1.DERAbstractTime),ct.asn1.DERGeneralizedTime=function(t){ct.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=mt(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=mt(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},s.lang.extend(ct.asn1.DERGeneralizedTime,ct.asn1.DERAbstractTime),ct.asn1.DERSequence=function(t){ct.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++)t+=this.asn1Array[e].getEncodedHex();return this.hV=t,this.hV}},s.lang.extend(ct.asn1.DERSequence,ct.asn1.DERAbstractStructured),ct.asn1.DERSet=function(t){ct.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var n=this.asn1Array[e];t.push(n.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},s.lang.extend(ct.asn1.DERSet,ct.asn1.DERAbstractStructured),ct.asn1.DERTaggedObject=function(t){ct.asn1.DERTaggedObject.superclass.constructor.call(this);var e=ct.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,n){this.hT=e,this.isExplicit=t,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(t){null!=t.tag&&(this.hT=t.tag),null!=t.explicit&&(this.isExplicit=t.explicit),null!=t.tage&&(this.hT=t.tage,this.isExplicit=!0),null!=t.tagi&&(this.hT=t.tagi,this.isExplicit=!1),null!=t.obj&&(t.obj instanceof e.ASN1Object?(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):"object"==n(t.obj)&&(this.asn1Object=e.ASN1Util.newObject(t.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},null!=t&&this.setByParam(t)},s.lang.extend(ct.asn1.DERTaggedObject,ct.asn1.ASN1Object);var ct,lt,ht,dt=new function(){};function pt(t){for(var e=new Array,n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function ft(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}function gt(t){for(var e="",n=0;n<t.length;n++){var i=t[n].toString(16);1==i.length&&(i="0"+i),e+=i}return e}function mt(t){return gt(pt(t))}function vt(t){return(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function yt(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function _t(t){return t.length%2==1&&(t="0"+t),vt(w(t))}function wt(t){return b(yt(t))}function bt(t){return It(Lt(t))}function xt(t){return decodeURIComponent(Dt(t))}function St(t){for(var e="",n=0;n<t.length-1;n+=2)e+=String.fromCharCode(parseInt(t.substr(n,2),16));return e}function Tt(t){for(var e="",n=0;n<t.length;n++)e+=("0"+t.charCodeAt(n).toString(16)).slice(-2);return e}function Ct(t){return w(t)}function Et(t){var e=Ct(t).replace(/(.{64})/g,"$1\r\n");return e.replace(/\r\n$/,"")}function At(t){return b(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}function kt(t,e){return"-----BEGIN "+e+"-----\r\n"+Et(t)+"\r\n-----END "+e+"-----\r\n"}function Ft(t,e){if(-1==t.indexOf("-----BEGIN "))throw"can't find PEM header: "+e;return At(t=void 0!==e?(t=t.replace(new RegExp("^[^]*-----BEGIN "+e+"-----"),"")).replace(new RegExp("-----END "+e+"-----[^]*$"),""):(t=t.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function Pt(t){var e,n,i,r,s,o,a,u,c,l,h;if(h=t.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=h[1],e=parseInt(u),2===u.length&&(50<=e&&e<100?e=1900+e:0<=e&&e<50&&(e=2e3+e)),n=parseInt(h[2])-1,i=parseInt(h[3]),r=parseInt(h[4]),s=parseInt(h[5]),o=parseInt(h[6]),a=0,""!==(c=h[7])&&(l=(c.substr(1)+"00").substr(0,3),a=parseInt(l)),Date.UTC(e,n,i,r,s,o,a);throw"unsupported zulu format: "+t}function Rt(t){return~~(Pt(t)/1e3)}function It(t){return t.replace(/%/g,"")}function Dt(t){return t.replace(/(..)/g,"%$1")}function Ot(t){var e="malformed IPv6 address";if(!t.match(/^[0-9A-Fa-f:]+$/))throw e;var n=(t=t.toLowerCase()).split(":").length-1;if(n<2)throw e;var i=":".repeat(7-n+2),r=(t=t.replace("::",i)).split(":");if(8!=r.length)throw e;for(var s=0;s<8;s++)r[s]=("0000"+r[s]).slice(-4);return r.join("")}function Mt(t){if(!t.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var e=(t=t.toLowerCase()).match(/.{1,4}/g),n=0;n<8;n++)e[n]=e[n].replace(/^0+/,""),""==e[n]&&(e[n]="0");var i=(t=":"+e.join(":")+":").match(/:(0:){2,}/g);if(null===i)return t.slice(1,-1);var r="";for(n=0;n<i.length;n++)i[n].length>r.length&&(r=i[n]);return(t=t.replace(r,"::")).slice(1,-1)}function Nt(t){var e="malformed hex value";if(!t.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(8!=t.length)return 32==t.length?Mt(t):t;try{return parseInt(t.substr(0,2),16)+"."+parseInt(t.substr(2,2),16)+"."+parseInt(t.substr(4,2),16)+"."+parseInt(t.substr(6,2),16)}catch(t){throw e}}function Lt(t){for(var e=encodeURIComponent(t),n="",i=0;i<e.length;i++)"%"==e[i]?(n+=e.substr(i,3),i+=2):n=n+"%"+mt(e[i]);return n}function jt(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))}function Bt(t){return t.length%2==1?"0"+t:t.substr(0,1)>"7"?"00"+t:t}dt.getLblen=function(t,e){if("8"!=t.substr(e+2,1))return 1;var n=parseInt(t.substr(e+3,1));return 0==n?-1:0<n&&n<10?n+1:-2},dt.getL=function(t,e){var n=dt.getLblen(t,e);return n<1?"":t.substr(e+2,2*n)},dt.getVblen=function(t,e){var n;return""==(n=dt.getL(t,e))?-1:("8"===n.substr(0,1)?new S(n.substr(2),16):new S(n,16)).intValue()},dt.getVidx=function(t,e){var n=dt.getLblen(t,e);return n<0?n:e+2*(n+1)},dt.getV=function(t,e){var n=dt.getVidx(t,e),i=dt.getVblen(t,e);return t.substr(n,2*i)},dt.getTLV=function(t,e){return t.substr(e,2)+dt.getL(t,e)+dt.getV(t,e)},dt.getTLVblen=function(t,e){return 2+2*dt.getLblen(t,e)+2*dt.getVblen(t,e)},dt.getNextSiblingIdx=function(t,e){return dt.getVidx(t,e)+2*dt.getVblen(t,e)},dt.getChildIdx=function(t,e){var n,i,r,s=dt,o=[];n=s.getVidx(t,e),i=2*s.getVblen(t,e),"03"==t.substr(e,2)&&(n+=2,i-=2),r=0;for(var a=n;r<=i;){var u=s.getTLVblen(t,a);if((r+=u)<=i&&o.push(a),a+=u,r>=i)break}return o},dt.getNthChildIdx=function(t,e,n){return dt.getChildIdx(t,e)[n]},dt.getIdxbyList=function(t,e,n,i){var r,s,o=dt;return 0==n.length?void 0!==i&&t.substr(e,2)!==i?-1:e:(r=n.shift())>=(s=o.getChildIdx(t,e)).length?-1:o.getIdxbyList(t,s[r],n,i)},dt.getIdxbyListEx=function(t,e,n,i){var r,s,o=dt;if(0==n.length)return void 0!==i&&t.substr(e,2)!==i?-1:e;r=n.shift(),s=o.getChildIdx(t,e);for(var a=0,u=0;u<s.length;u++){var c=t.substr(s[u],2);if("number"==typeof r&&!o.isContextTag(c)&&a==r||"string"==typeof r&&o.isContextTag(c,r))return o.getIdxbyListEx(t,s[u],n,i);o.isContextTag(c)||a++}return-1},dt.getTLVbyList=function(t,e,n,i){var r=dt,s=r.getIdxbyList(t,e,n,i);return-1==s||s>=t.length?null:r.getTLV(t,s)},dt.getTLVbyListEx=function(t,e,n,i){var r=dt,s=r.getIdxbyListEx(t,e,n,i);return-1==s?null:r.getTLV(t,s)},dt.getVbyList=function(t,e,n,i,r){var s,o,a=dt;return-1==(s=a.getIdxbyList(t,e,n,i))||s>=t.length?null:(o=a.getV(t,s),!0===r&&(o=o.substr(2)),o)},dt.getVbyListEx=function(t,e,n,i,r){var s,o,a=dt;return-1==(s=a.getIdxbyListEx(t,e,n,i))?null:(o=a.getV(t,s),"03"==t.substr(s,2)&&!1!==r&&(o=o.substr(2)),o)},dt.getInt=function(t,e,n){null==n&&(n=-1);try{var i=t.substr(e,2);if("02"!=i&&"03"!=i)return n;var r=dt.getV(t,e);return"02"==i?parseInt(r,16):function(t){try{var e=t.substr(0,2);if("00"==e)return parseInt(t.substr(2),16);var n=parseInt(e,16),i=t.substr(2),r=parseInt(i,16).toString(2);return"0"==r&&(r="00000000"),r=r.slice(0,0-n),parseInt(r,2)}catch(t){return-1}}(r)}catch(t){return n}},dt.getOID=function(t,e,n){null==n&&(n=null);try{return"06"!=t.substr(e,2)?n:function(t){if(!jt(t))return null;try{var e=[],n=t.substr(0,2),i=parseInt(n,16);e[0]=new String(Math.floor(i/40)),e[1]=new String(i%40);for(var r=t.substr(2),s=[],o=0;o<r.length/2;o++)s.push(parseInt(r.substr(2*o,2),16));var a=[],u="";for(o=0;o<s.length;o++)128&s[o]?u+=Ut((127&s[o]).toString(2),7):(u+=Ut((127&s[o]).toString(2),7),a.push(new String(parseInt(u,2))),u="");var c=e.join(".");return a.length>0&&(c=c+"."+a.join(".")),c}catch(t){return null}}(dt.getV(t,e))}catch(t){return n}},dt.getOIDName=function(t,e,n){null==n&&(n=null);try{var i=dt.getOID(t,e,n);if(i==n)return n;var r=ct.asn1.x509.OID.oid2name(i);return""==r?i:r}catch(t){return n}},dt.getString=function(t,e,n){null==n&&(n=null);try{return St(dt.getV(t,e))}catch(t){return n}},dt.hextooidstr=function(t){var e=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},n=[],i=t.substr(0,2),r=parseInt(i,16);n[0]=new String(Math.floor(r/40)),n[1]=new String(r%40);for(var s=t.substr(2),o=[],a=0;a<s.length/2;a++)o.push(parseInt(s.substr(2*a,2),16));var u=[],c="";for(a=0;a<o.length;a++)128&o[a]?c+=e((127&o[a]).toString(2),7):(c+=e((127&o[a]).toString(2),7),u.push(new String(parseInt(c,2))),c="");var l=n.join(".");return u.length>0&&(l=l+"."+u.join(".")),l},dt.dump=function(t,e,n,i){var r=dt,s=r.getV,o=r.dump,a=r.getChildIdx,u=t;t instanceof ct.asn1.ASN1Object&&(u=t.getEncodedHex());var c=function(t,e){return t.length<=2*e?t:t.substr(0,e)+"..(total "+t.length/2+"bytes).."+t.substr(t.length-e,e)};void 0===e&&(e={ommit_long_octet:32}),void 0===n&&(n=0),void 0===i&&(i="");var l,h=e.ommit_long_octet;if("01"==(l=u.substr(n,2)))return"00"==(d=s(u,n))?i+"BOOLEAN FALSE\n":i+"BOOLEAN TRUE\n";if("02"==l)return i+"INTEGER "+c(d=s(u,n),h)+"\n";if("03"==l){var d=s(u,n);return r.isASN1HEX(d.substr(2))?(b=i+"BITSTRING, encapsulates\n")+o(d.substr(2),e,0,i+"  "):i+"BITSTRING "+c(d,h)+"\n"}if("04"==l)return d=s(u,n),r.isASN1HEX(d)?(b=i+"OCTETSTRING, encapsulates\n")+o(d,e,0,i+"  "):i+"OCTETSTRING "+c(d,h)+"\n";if("05"==l)return i+"NULL\n";if("06"==l){var p=s(u,n),f=ct.asn1.ASN1Util.oidHexToInt(p),g=ct.asn1.x509.OID.oid2name(f),m=f.replace(/\./g," ");return""!=g?i+"ObjectIdentifier "+g+" ("+m+")\n":i+"ObjectIdentifier ("+m+")\n"}if("0a"==l)return i+"ENUMERATED "+parseInt(s(u,n))+"\n";if("0c"==l)return i+"UTF8String '"+xt(s(u,n))+"'\n";if("13"==l)return i+"PrintableString '"+xt(s(u,n))+"'\n";if("14"==l)return i+"TeletexString '"+xt(s(u,n))+"'\n";if("16"==l)return i+"IA5String '"+xt(s(u,n))+"'\n";if("17"==l)return i+"UTCTime "+xt(s(u,n))+"\n";if("18"==l)return i+"GeneralizedTime "+xt(s(u,n))+"\n";if("1a"==l)return i+"VisualString '"+xt(s(u,n))+"'\n";if("1e"==l)return i+"BMPString '"+xt(s(u,n))+"'\n";if("30"==l){if("3000"==u.substr(n,4))return i+"SEQUENCE {}\n";b=i+"SEQUENCE\n";var v=e;if((2==(w=a(u,n)).length||3==w.length)&&"06"==u.substr(w[0],2)&&"04"==u.substr(w[w.length-1],2)){g=r.oidname(s(u,w[0]));var y=JSON.parse(JSON.stringify(e));y.x509ExtName=g,v=y}for(var _=0;_<w.length;_++)b+=o(u,v,w[_],i+"  ");return b}if("31"==l){b=i+"SET\n";var w=a(u,n);for(_=0;_<w.length;_++)b+=o(u,e,w[_],i+"  ");return b}if(0!=(128&(l=parseInt(l,16)))){var b,x=31&l;if(0!=(32&l)){for(b=i+"["+x+"]\n",w=a(u,n),_=0;_<w.length;_++)b+=o(u,e,w[_],i+"  ");return b}return d=s(u,n),dt.isASN1HEX(d)?(b=i+"["+x+"]\n")+o(d,e,0,i+"  "):(("68747470"==d.substr(0,8)||"subjectAltName"===e.x509ExtName&&2==x)&&(d=xt(d)),i+"["+x+"] "+d+"\n")}return i+"UNKNOWN("+l+") "+s(u,n)+"\n"},dt.isContextTag=function(t,e){var n,i;t=t.toLowerCase();try{n=parseInt(t,16)}catch(t){return-1}if(void 0===e)return 128==(192&n);try{return null!=e.match(/^\[[0-9]+\]$/)&&!((i=parseInt(e.substr(1,e.length-1),10))>31)&&128==(192&n)&&(31&n)==i}catch(t){return!1}},dt.isASN1HEX=function(t){var e=dt;if(t.length%2==1)return!1;var n=e.getVblen(t,0),i=t.substr(0,2),r=e.getL(t,0);return t.length-i.length-r.length==2*n},dt.checkStrictDER=function(t,e,n,i,r){var s=dt;if(void 0===n){if("string"!=typeof t)throw new Error("not hex string");if(t=t.toLowerCase(),!ct.lang.String.isHex(t))throw new Error("not hex string");n=t.length,r=(i=t.length/2)<128?1:Math.ceil(i.toString(16))+1}if(s.getL(t,e).length>2*r)throw new Error("L of TLV too long: idx="+e);var o=s.getVblen(t,e);if(o>i)throw new Error("value of L too long than hex: idx="+e);var a=s.getTLV(t,e),u=a.length-2-s.getL(t,e).length;if(u!==2*o)throw new Error("V string length and L's value not the same:"+u+"/"+2*o);if(0===e&&t.length!=a.length)throw new Error("total length and TLV length unmatch:"+t.length+"!="+a.length);var c=t.substr(e,2);if("02"===c){var l=s.getVidx(t,e);if("00"==t.substr(l,2)&&t.charCodeAt(l+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(c,16)){for(var h=s.getVblen(t,e),d=0,p=s.getChildIdx(t,e),f=0;f<p.length;f++)d+=s.getTLV(t,p[f]).length,s.checkStrictDER(t,p[f],n,i,r);if(2*h!=d)throw new Error("sum of children's TLV length and L unmatch: "+2*h+"!="+d)}},dt.oidname=function(t){var e=ct.asn1;ct.lang.String.isHex(t)&&(t=e.ASN1Util.oidHexToInt(t));var n=e.x509.OID.oid2name(t);return""===n&&(n=t),n},void 0!==ct&&ct||(e.KJUR=ct={}),void 0!==ct.lang&&ct.lang||(ct.lang={}),ct.lang.String=function(){},"function"==typeof t?(e.utf8tob64u=lt=function(e){return vt(t.from(e,"utf8").toString("base64"))},e.b64utoutf8=ht=function(e){return t.from(yt(e),"base64").toString("utf8")}):(e.utf8tob64u=lt=function(t){return _t(It(Lt(t)))},e.b64utoutf8=ht=function(t){return decodeURIComponent(Dt(wt(t)))}),ct.lang.String.isInteger=function(t){return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},ct.lang.String.isHex=function(t){return jt(t)},ct.lang.String.isBase64=function(t){return!(!(t=t.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},ct.lang.String.isBase64URL=function(t){return!t.match(/[+/=]/)&&(t=yt(t),ct.lang.String.isBase64(t))},ct.lang.String.isIntegerArray=function(t){return!!(t=t.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},ct.lang.String.isPrintable=function(t){return null!==t.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},ct.lang.String.isIA5=function(t){return null!==t.match(/^[\x20-\x21\x23-\x7f]*$/)},ct.lang.String.isMail=function(t){return null!==t.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};var Ut=function(t,e,n){return null==n&&(n="0"),t.length>=e?t:new Array(e-t.length+1).join(n)+t};void 0!==ct&&ct||(e.KJUR=ct={}),void 0!==ct.crypto&&ct.crypto||(ct.crypto={}),ct.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:v.algo.MD5,sha1:v.algo.SHA1,sha224:v.algo.SHA224,sha256:v.algo.SHA256,sha384:v.algo.SHA384,sha512:v.algo.SHA512,ripemd160:v.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,n){var i=this.getDigestInfoHex(t,e),r=n/4;if(i.length+22>r)throw"key is too short for SigAlg: keylen="+n+","+e;for(var s="0001",o="00"+i,a="",u=r-s.length-o.length,c=0;c<u;c+=2)a+="ff";return s+a+o},this.hashString=function(t,e){return new ct.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new ct.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return this.hashString(t,"sha1")},this.sha256=function(t){return this.hashString(t,"sha256")},this.sha256Hex=function(t){return this.hashHex(t,"sha256")},this.sha512=function(t){return this.hashString(t,"sha512")},this.sha512Hex=function(t){return this.hashHex(t,"sha512")},this.isKey=function(t){return t instanceof rt||t instanceof ct.crypto.DSA||t instanceof ct.crypto.ECDSA}},ct.crypto.Util.md5=function(t){return new ct.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},ct.crypto.Util.ripemd160=function(t){return new ct.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},ct.crypto.Util.SECURERANDOMGEN=new et,ct.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return ct.crypto.Util.SECURERANDOMGEN.nextBytes(e),gt(e)},ct.crypto.Util.getRandomBigIntegerOfNbytes=function(t){return new S(ct.crypto.Util.getRandomHexOfNbytes(t),16)},ct.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,n=new Array((t-e)/8+1);return ct.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<e&255^255)&n[0],gt(n)},ct.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new S(ct.crypto.Util.getRandomHexOfNbits(t),16)},ct.crypto.Util.getRandomBigIntegerZeroToMax=function(t){for(var e=t.bitLength();;){var n=ct.crypto.Util.getRandomBigIntegerOfNbits(e);if(-1!=t.compareTo(n))return n}},ct.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var n=t.compareTo(e);if(1==n)throw"biMin is greater than biMax";if(0==n)return t;var i=e.subtract(t);return ct.crypto.Util.getRandomBigIntegerZeroToMax(i).add(t)},ct.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(t,e){if(null!==(t=ct.crypto.MessageDigest.getCanonicalAlgName(t))&&void 0===e&&(e=ct.crypto.Util.DEFAULTPROVIDER[t]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)&&"cryptojs"==e){try{this.md=ct.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=v.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(v.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=ct.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},ct.crypto.MessageDigest.getCanonicalAlgName=function(t){return"string"==typeof t&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},ct.crypto.MessageDigest.getHashLength=function(t){var e=ct.crypto.MessageDigest,n=e.getCanonicalAlgName(t);if(void 0===e.HASHLENGTH[n])throw"not supported algorithm: "+t;return e.HASHLENGTH[n]},ct.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},ct.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===e&&(e=ct.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var n=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==e){try{var i=ct.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[n];this.mac=v.algo.HMAC.create(i,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=v.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(v.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if("string"==typeof t){var e=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(e=Tt(t)),void(this.pass=v.enc.Hex.parse(e))}if("object"!=(void 0===t?"undefined":n(t)))throw"KJUR.crypto.Mac unsupported password type: "+t;if(e=null,void 0!==t.hex){if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;e=t.hex}if(void 0!==t.utf8&&(e=bt(t.utf8)),void 0!==t.rstr&&(e=Tt(t.rstr)),void 0!==t.b64&&(e=b(t.b64)),void 0!==t.b64u&&(e=wt(t.b64u)),null==e)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=v.enc.Hex.parse(e)},void 0!==t&&(void 0!==t.pass&&this.setPassword(t.pass),void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=ct.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},ct.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(t,e){for(var n="",i=e/4-t.length,r=0;r<i;r++)n+="0";return n+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw new Error("provider not supported: "+e);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new ct.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t)}this.init=function(t,e){var n=null;try{n=void 0===e?Vt.getKey(t):Vt.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===n.isPrivate)this.prvKey=n,this.state="SIGN";else{if(!0!==n.isPublic)throw"init failed.:"+n;this.pubKey=n,this.state="VERIFY"}},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==ct.crypto.ECDSA&&(this.prvKey=new ct.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof rt&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof rt&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof ct.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof ct.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==ct.crypto.ECDSA&&(this.pubKey=new ct.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof rt&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof rt&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==ct.crypto.ECDSA&&this.pubKey instanceof ct.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==ct.crypto.DSA&&this.pubKey instanceof ct.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,void 0!==t&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=ct.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{e=Vt.getKey(t.prvkeypem),this.init(e)}catch(t){throw"fatal error to load pem private key: "+t}}},ct.crypto.Cipher=function(t){},ct.crypto.Cipher.encrypt=function(t,e,n){if(e instanceof rt&&e.isPublic){var i=ct.crypto.Cipher.getAlgByKeyAndName(e,n);if("RSA"===i)return e.encrypt(t);if("RSAOAEP"===i)return e.encryptOAEP(t,"sha1");var r=i.match(/^RSAOAEP(\d+)$/);if(null!==r)return e.encryptOAEP(t,"sha"+r[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.encrypt: unsupported key or algorithm"},ct.crypto.Cipher.decrypt=function(t,e,n){if(e instanceof rt&&e.isPrivate){var i=ct.crypto.Cipher.getAlgByKeyAndName(e,n);if("RSA"===i)return e.decrypt(t);if("RSAOAEP"===i)return e.decryptOAEP(t,"sha1");var r=i.match(/^RSAOAEP(\d+)$/);if(null!==r)return e.decryptOAEP(t,"sha"+r[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.decrypt: unsupported key or algorithm"},ct.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof rt){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e))return e;if(null==e)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e},ct.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==ct&&ct||(e.KJUR=ct={}),void 0!==ct.crypto&&ct.crypto||(ct.crypto={}),ct.crypto.ECDSA=function(t){var e=Error,i=S,r=ot,s=ct.crypto.ECDSA,o=ct.crypto.ECParameterDB,a=s.getName,u=dt,c=u.getVbyListEx,l=u.isASN1HEX,h=new et;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(t){return new i(t.bitLength(),h).mod(t.subtract(i.ONE)).add(i.ONE)},this.setNamedCurve=function(t){this.ecparams=o.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.getPublicKeyXYHex=function(){var t=this.pubKeyHex;if("04"!==t.substr(0,2))throw"this method supports uncompressed format(04) only";var e=this.ecparams.keylen/4;if(t.length!==2+2*e)throw"malformed public key hex length";var n={};return n.x=t.substr(2,e),n.y=t.substr(2+e),n},this.getShortNISTPCurveName=function(){var t=this.curveName;return"secp256r1"===t||"NIST P-256"===t||"P-256"===t||"prime256v1"===t?"P-256":"secp384r1"===t||"NIST P-384"===t||"P-384"===t?"P-384":null},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),n=this.ecparams.G.multiply(e),i=n.getX().toBigInteger(),r=n.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a="04"+("0000000000"+i.toString(16)).slice(-s)+("0000000000"+r.toString(16)).slice(-s);return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var n=new i(e,16),r=this.ecparams.n,o=new i(t.substring(0,this.ecparams.keylen/4),16);do{var a=this.getBigRandom(r),u=this.ecparams.G.multiply(a).getX().toBigInteger().mod(r)}while(u.compareTo(i.ZERO)<=0);var c=a.modInverse(r).multiply(o.add(n.multiply(u))).mod(r);return s.biRSSigToASN1Sig(u,c)},this.sign=function(t,e){var n=e,r=this.ecparams.n,s=i.fromByteArrayUnsigned(t);do{var o=this.getBigRandom(r),a=this.ecparams.G.multiply(o).getX().toBigInteger().mod(r)}while(a.compareTo(S.ZERO)<=0);var u=o.modInverse(r).multiply(s.add(n.multiply(a))).mod(r);return this.serializeSig(a,u)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,n){try{var o,a,u=s.parseSigHex(e);o=u.r,a=u.s;var c=r.decodeFromHex(this.ecparams.curve,n),l=new i(t.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(l,o,a,c)}catch(t){return!1}},this.verify=function(t,e,s){var o,a,u;if(Bitcoin.Util.isArray(e)){var c=this.parseSig(e);o=c.r,a=c.s}else{if("object"!==(void 0===e?"undefined":n(e))||!e.r||!e.s)throw"Invalid value for signature";o=e.r,a=e.s}if(s instanceof ot)u=s;else{if(!Bitcoin.Util.isArray(s))throw"Invalid format for pubkey value, must be byte array or ECPointFp";u=r.decodeFrom(this.ecparams.curve,s)}var l=i.fromByteArrayUnsigned(t);return this.verifyRaw(l,o,a,u)},this.verifyRaw=function(t,e,n,r){var s=this.ecparams.n,o=this.ecparams.G;if(e.compareTo(i.ONE)<0||e.compareTo(s)>=0)return!1;if(n.compareTo(i.ONE)<0||n.compareTo(s)>=0)return!1;var a=n.modInverse(s),u=t.multiply(a).mod(s),c=e.multiply(a).mod(s);return o.multiply(u).add(r.multiply(c)).getX().toBigInteger().mod(s).equals(e)},this.serializeSig=function(t,e){var n=t.toByteArraySigned(),i=e.toByteArraySigned(),r=[];return r.push(2),r.push(n.length),(r=r.concat(n)).push(2),r.push(i.length),(r=r.concat(i)).unshift(r.length),r.unshift(48),r},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var n=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var r=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:i.fromByteArrayUnsigned(n),s:i.fromByteArrayUnsigned(r)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var n=this.ecparams.n;return{r:i.fromByteArrayUnsigned(t.slice(1,33)).mod(n),s:i.fromByteArrayUnsigned(t.slice(33,65)).mod(n),i:e}},this.readPKCS5PrvKeyHex=function(t){if(!1===l(t))throw new Error("not ASN.1 hex string");var e,n,i;try{e=c(t,0,["[0]",0],"06"),n=c(t,0,[1],"04");try{i=c(t,0,["[1]",0],"03")}catch(t){}}catch(t){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=a(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(t){if(!1===l(t))throw new e("not ASN.1 hex string");var n,i,r;try{c(t,0,[1,0],"06"),n=c(t,0,[1,1],"06"),i=c(t,0,[2,0,1],"04");try{r=c(t,0,[2,0,"[1]",0],"03")}catch(t){}}catch(t){throw new e("malformed PKCS#8 plain ECC private key")}if(this.curveName=a(n),void 0===this.curveName)throw new e("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(r),this.setPrivateKeyHex(i),this.isPublic=!1},this.readPKCS8PubKeyHex=function(t){if(!1===l(t))throw new e("not ASN.1 hex string");var n,i;try{c(t,0,[0,0],"06"),n=c(t,0,[0,1],"06"),i=c(t,0,[1],"03")}catch(t){throw new e("malformed PKCS#8 ECC public key")}if(this.curveName=a(n),null===this.curveName)throw new e("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},this.readCertPubKeyHex=function(t,n){if(!1===l(t))throw new e("not ASN.1 hex string");var i,r;try{i=c(t,0,[0,5,0,1],"06"),r=c(t,0,[0,5,1],"03")}catch(t){throw new e("malformed X.509 certificate ECC public key")}if(this.curveName=a(i),null===this.curveName)throw new e("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(r)},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},ct.crypto.ECDSA.parseSigHex=function(t){var e=ct.crypto.ECDSA.parseSigHexInHexRS(t);return{r:new S(e.r,16),s:new S(e.s,16)}},ct.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=dt,n=e.getChildIdx,i=e.getV;if(e.checkStrictDER(t,0),"30"!=t.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var r=n(t,0);if(2!=r.length)throw new Error("signature shall have two elements");var s=r[0],o=r[1];if("02"!=t.substr(s,2))throw new Error("1st item not ASN.1 integer");if("02"!=t.substr(o,2))throw new Error("2nd item not ASN.1 integer");return{r:i(t,s),s:i(t,o)}},ct.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=ct.crypto.ECDSA.parseSigHexInHexRS(t),n=e.r,i=e.s;if("00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),"00"==i.substr(0,2)&&i.length%32==2&&(i=i.substr(2)),n.length%32==30&&(n="00"+n),i.length%32==30&&(i="00"+i),n.length%32!=0)throw"unknown ECDSA sig r length error";if(i.length%32!=0)throw"unknown ECDSA sig s length error";return n+i},ct.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),n=t.substr(t.length/2);return ct.crypto.ECDSA.hexRSSigToASN1Sig(e,n)},ct.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var n=new S(t,16),i=new S(e,16);return ct.crypto.ECDSA.biRSSigToASN1Sig(n,i)},ct.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var n=ct.asn1,i=new n.DERInteger({bigint:t}),r=new n.DERInteger({bigint:e});return new n.DERSequence({array:[i,r]}).getEncodedHex()},ct.crypto.ECDSA.getName=function(t){return"2b8104001f"===t?"secp192k1":"2a8648ce3d030107"===t?"secp256r1":"2b8104000a"===t?"secp256k1":"2b81040021"===t?"secp224r1":"2b81040022"===t?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)?"secp256r1":-1!=="|secp256k1|".indexOf(t)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(t)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(t)?"secp384r1":null},void 0!==ct&&ct||(e.KJUR=ct={}),void 0!==ct.crypto&&ct.crypto||(ct.crypto={}),ct.crypto.ECParameterDB=new function(){var t={},e={};function n(t){return new S(t,16)}this.getByName=function(n){var i=n;if(void 0!==e[i]&&(i=e[n]),void 0!==t[i])return t[i];throw"unregistered EC curve name: "+i},this.regist=function(i,r,s,o,a,u,c,l,h,d,p,f){t[i]={};var g=n(s),m=n(o),v=n(a),y=n(u),_=n(c),w=new at(g,m,v),b=w.decodePointHex("04"+l+h);t[i].name=i,t[i].keylen=r,t[i].curve=w,t[i].G=b,t[i].n=y,t[i].h=_,t[i].oid=p,t[i].info=f;for(var x=0;x<d.length;x++)e[d[x]]=i}},ct.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),ct.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),ct.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),ct.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),ct.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),ct.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),ct.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),ct.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),ct.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),ct.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var Vt=function(){var t=function(t,n,i){return e(v.AES,t,n,i)},e=function(t,e,n,i){var r=v.enc.Hex.parse(e),s=v.enc.Hex.parse(n),o=v.enc.Hex.parse(i),a={};a.key=s,a.iv=o,a.ciphertext=r;var u=t.decrypt(a,s,{iv:o});return v.enc.Hex.stringify(u)},n=function(t,e,n){return i(v.AES,t,e,n)},i=function(t,e,n,i){var r=v.enc.Hex.parse(e),s=v.enc.Hex.parse(n),o=v.enc.Hex.parse(i),a=t.encrypt(r,s,{iv:o}),u=v.enc.Hex.parse(a.toString());return v.enc.Base64.stringify(u)},r={"AES-256-CBC":{proc:t,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:n,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(t,n,i){return e(v.TripleDES,t,n,i)},eproc:function(t,e,n){return i(v.TripleDES,t,e,n)},keylen:24,ivlen:8},"DES-CBC":{proc:function(t,n,i){return e(v.DES,t,n,i)},eproc:function(t,e,n){return i(v.DES,t,e,n)},keylen:8,ivlen:8}},s=function(t){var e={},n=t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));n&&(e.cipher=n[1],e.ivsalt=n[2]);var i=t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));i&&(e.type=i[1]);var r=-1,s=0;-1!=t.indexOf("\r\n\r\n")&&(r=t.indexOf("\r\n\r\n"),s=2),-1!=t.indexOf("\n\n")&&(r=t.indexOf("\n\n"),s=1);var o=t.indexOf("-----END");if(-1!=r&&-1!=o){var a=t.substring(r+2*s,o-s);a=a.replace(/\s+/g,""),e.data=a}return e},o=function(t,e,n){for(var i=n.substring(0,16),s=v.enc.Hex.parse(i),o=v.enc.Utf8.parse(e),a=r[t].keylen+r[t].ivlen,u="",c=null;;){var l=v.algo.MD5.create();if(null!=c&&l.update(c),l.update(o),l.update(s),c=l.finalize(),(u+=v.enc.Hex.stringify(c)).length>=2*a)break}var h={};return h.keyhex=u.substr(0,2*r[t].keylen),h.ivhex=u.substr(2*r[t].keylen,2*r[t].ivlen),h},a=function(t,e,n,i){var s=v.enc.Base64.parse(t),o=v.enc.Hex.stringify(s);return(0,r[e].proc)(o,n,i)};return{version:"1.0.0",parsePKCS5PEM:function(t){return s(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,n){return o(t,e,n)},decryptKeyB64:function(t,e,n,i){return a(t,e,n,i)},getDecryptedKeyHex:function(t,e){var n=s(t),i=(n.type,n.cipher),r=n.ivsalt,u=n.data,c=o(i,e,r).keyhex;return a(u,i,c,r)},getEncryptedPKCS5PEMFromPrvKeyHex:function(t,e,n,i,s){var a="";if(void 0!==i&&null!=i||(i="AES-256-CBC"),void 0===r[i])throw"KEYUTIL unsupported algorithm: "+i;void 0!==s&&null!=s||(s=function(t){var e=v.lib.WordArray.random(t);return v.enc.Hex.stringify(e)}(r[i].ivlen).toUpperCase());var u=function(t,e,n,i){return(0,r[e].eproc)(t,n,i)}(e,i,o(i,n,s).keyhex,s);return a="-----BEGIN "+t+" PRIVATE KEY-----\r\n",a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+i+","+s+"\r\n",a+="\r\n",(a+=u.replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+t+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(t){var e=dt,n=e.getChildIdx,i=e.getV,r={},s=n(t,0);if(2!=s.length)throw"malformed format: SEQUENCE(0).items != 2: "+s.length;r.ciphertext=i(t,s[1]);var o=n(t,s[0]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+o.length;if("2a864886f70d01050d"!=i(t,o[0]))throw"this only supports pkcs5PBES2";var a=n(t,o[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var u=n(t,a[1]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length;if("2a864886f70d0307"!=i(t,u[0]))throw"this only supports TripleDES";r.encryptionSchemeAlg="TripleDES",r.encryptionSchemeIV=i(t,u[1]);var c=n(t,a[0]);if(2!=c.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+c.length;if("2a864886f70d01050c"!=i(t,c[0]))throw"this only supports pkcs5PBKDF2";var l=n(t,c[1]);if(l.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+l.length;r.pbkdf2Salt=i(t,l[0]);var h=i(t,l[1]);try{r.pbkdf2Iter=parseInt(h,16)}catch(t){throw"malformed format pbkdf2Iter: "+h}return r},getPBKDF2KeyHexFromParam:function(t,e){var n=v.enc.Hex.parse(t.pbkdf2Salt),i=t.pbkdf2Iter,r=v.PBKDF2(e,n,{keySize:6,iterations:i});return v.enc.Hex.stringify(r)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var n=Ft(t,"ENCRYPTED PRIVATE KEY"),i=this.parseHexOfEncryptedPKCS8(n),r=Vt.getPBKDF2KeyHexFromParam(i,e),s={};s.ciphertext=v.enc.Hex.parse(i.ciphertext);var o=v.enc.Hex.parse(r),a=v.enc.Hex.parse(i.encryptionSchemeIV),u=v.TripleDES.decrypt(s,o,{iv:a});return v.enc.Hex.stringify(u)},getKeyFromEncryptedPKCS8PEM:function(t,e){var n=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getKeyFromPlainPrivatePKCS8Hex(n)},parsePlainPrivatePKCS8Hex:function(t){var e=dt,n=e.getChildIdx,i=e.getV,r={algparam:null};if("30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var s=n(t,0);if(3!=s.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(s[1],2))throw"malformed PKCS8 private key(code:003)";var o=n(t,s[1]);if(2!=o.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(o[0],2))throw"malformed PKCS8 private key(code:005)";if(r.algoid=i(t,o[0]),"06"==t.substr(o[1],2)&&(r.algparam=i(t,o[1])),"04"!=t.substr(s[2],2))throw"malformed PKCS8 private key(code:006)";return r.keyidx=e.getVidx(t,s[2]),r},getKeyFromPlainPrivatePKCS8PEM:function(t){var e=Ft(t,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(e)},getKeyFromPlainPrivatePKCS8Hex:function(t){var e,n=this.parsePlainPrivatePKCS8Hex(t);if("2a864886f70d010101"==n.algoid)e=new rt;else if("2a8648ce380401"==n.algoid)e=new ct.crypto.DSA;else{if("2a8648ce3d0201"!=n.algoid)throw"unsupported private key algorithm";e=new ct.crypto.ECDSA}return e.readPKCS8PrvKeyHex(t),e},_getKeyFromPublicPKCS8Hex:function(t){var e,n=dt.getVbyList(t,0,[0,0],"06");if("2a864886f70d010101"===n)e=new rt;else if("2a8648ce380401"===n)e=new ct.crypto.DSA;else{if("2a8648ce3d0201"!==n)throw"unsupported PKCS#8 public key hex";e=new ct.crypto.ECDSA}return e.readPKCS8PubKeyHex(t),e},parsePublicRawRSAKeyHex:function(t){var e=dt,n=e.getChildIdx,i=e.getV,r={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var s=n(t,0);if(2!=s.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(s[0],2))throw"malformed RSA key(code:003)";if(r.n=i(t,s[0]),"02"!=t.substr(s[1],2))throw"malformed RSA key(code:004)";return r.e=i(t,s[1]),r},parsePublicPKCS8Hex:function(t){var e=dt,n=e.getChildIdx,i=e.getV,r={algparam:null},s=n(t,0);if(2!=s.length)throw"outer DERSequence shall have 2 elements: "+s.length;var o=s[0];if("30"!=t.substr(o,2))throw"malformed PKCS8 public key(code:001)";var a=n(t,o);if(2!=a.length)throw"malformed PKCS8 public key(code:002)";if("06"!=t.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(r.algoid=i(t,a[0]),"06"==t.substr(a[1],2)?r.algparam=i(t,a[1]):"30"==t.substr(a[1],2)&&(r.algparam={},r.algparam.p=e.getVbyList(t,a[1],[0],"02"),r.algparam.q=e.getVbyList(t,a[1],[1],"02"),r.algparam.g=e.getVbyList(t,a[1],[2],"02")),"03"!=t.substr(s[1],2))throw"malformed PKCS8 public key(code:004)";return r.key=i(t,s[1]).substr(2),r}}}();Vt.getKey=function(t,e,n){var i,r=(v=dt).getChildIdx,s=(v.getV,v.getVbyList),o=ct.crypto,a=o.ECDSA,u=o.DSA,c=rt,l=Ft,h=Vt;if(void 0!==c&&t instanceof c)return t;if(void 0!==a&&t instanceof a)return t;if(void 0!==u&&t instanceof u)return t;if(void 0!==t.curve&&void 0!==t.xy&&void 0===t.d)return new a({pub:t.xy,curve:t.curve});if(void 0!==t.curve&&void 0!==t.d)return new a({prv:t.d,curve:t.curve});if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(F=new c).setPublic(t.n,t.e),F;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.co&&void 0===t.qi)return(F=new c).setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),F;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0===t.p)return(F=new c).setPrivate(t.n,t.e,t.d),F;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x)return(F=new u).setPublic(t.p,t.q,t.g,t.y),F;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x)return(F=new u).setPrivate(t.p,t.q,t.g,t.y,t.x),F;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(F=new c).setPublic(wt(t.n),wt(t.e)),F;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.qi)return(F=new c).setPrivateEx(wt(t.n),wt(t.e),wt(t.d),wt(t.p),wt(t.q),wt(t.dp),wt(t.dq),wt(t.qi)),F;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d)return(F=new c).setPrivate(wt(t.n),wt(t.e),wt(t.d)),F;if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0===t.d){var d=(k=new a({curve:t.crv})).ecparams.keylen/4,p="04"+("0000000000"+wt(t.x)).slice(-d)+("0000000000"+wt(t.y)).slice(-d);return k.setPublicKeyHex(p),k}if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0!==t.d){d=(k=new a({curve:t.crv})).ecparams.keylen/4,p="04"+("0000000000"+wt(t.x)).slice(-d)+("0000000000"+wt(t.y)).slice(-d);var f=("0000000000"+wt(t.d)).slice(-d);return k.setPublicKeyHex(p),k.setPrivateKeyHex(f),k}if("pkcs5prv"===n){var g,m=t,v=dt;if(9===(g=r(m,0)).length)(F=new c).readPKCS5PrvKeyHex(m);else if(6===g.length)(F=new u).readPKCS5PrvKeyHex(m);else{if(!(g.length>2&&"04"===m.substr(g[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(F=new a).readPKCS5PrvKeyHex(m)}return F}if("pkcs8prv"===n)return h.getKeyFromPlainPrivatePKCS8Hex(t);if("pkcs8pub"===n)return h._getKeyFromPublicPKCS8Hex(t);if("x509pub"===n)return zt.getPublicKeyFromCertHex(t);if(-1!=t.indexOf("-END CERTIFICATE-",0)||-1!=t.indexOf("-END X509 CERTIFICATE-",0)||-1!=t.indexOf("-END TRUSTED CERTIFICATE-",0))return zt.getPublicKeyFromCertPEM(t);if(-1!=t.indexOf("-END PUBLIC KEY-")){var y=Ft(t,"PUBLIC KEY");return h._getKeyFromPublicPKCS8Hex(y)}if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var _=l(t,"RSA PRIVATE KEY");return h.getKey(_,null,"pkcs5prv")}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var w=s(i=l(t,"DSA PRIVATE KEY"),0,[1],"02"),b=s(i,0,[2],"02"),x=s(i,0,[3],"02"),T=s(i,0,[4],"02"),C=s(i,0,[5],"02");return(F=new u).setPrivate(new S(w,16),new S(b,16),new S(x,16),new S(T,16),new S(C,16)),F}if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED"))return _=l(t,"EC PRIVATE KEY"),h.getKey(_,null,"pkcs5prv");if(-1!=t.indexOf("-END PRIVATE KEY-"))return h.getKeyFromPlainPrivatePKCS8PEM(t);if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var E=h.getDecryptedKeyHex(t,e),A=new rt;return A.readPKCS5PrvKeyHex(E),A}if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var k,F=s(i=h.getDecryptedKeyHex(t,e),0,[1],"04"),P=s(i,0,[2,0],"06"),R=s(i,0,[3,0],"03").substr(2);if(void 0===ct.crypto.OID.oidhex2name[P])throw"undefined OID(hex) in KJUR.crypto.OID: "+P;return(k=new a({curve:ct.crypto.OID.oidhex2name[P]})).setPublicKeyHex(R),k.setPrivateKeyHex(F),k.isPublic=!1,k}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED"))return w=s(i=h.getDecryptedKeyHex(t,e),0,[1],"02"),b=s(i,0,[2],"02"),x=s(i,0,[3],"02"),T=s(i,0,[4],"02"),C=s(i,0,[5],"02"),(F=new u).setPrivate(new S(w,16),new S(b,16),new S(x,16),new S(T,16),new S(C,16)),F;if(-1!=t.indexOf("-END ENCRYPTED PRIVATE KEY-"))return h.getKeyFromEncryptedPKCS8PEM(t,e);throw new Error("not supported argument")},Vt.generateKeypair=function(t,e){if("RSA"==t){var n=e;(o=new rt).generate(n,"10001"),o.isPrivate=!0,o.isPublic=!0;var i=new rt,r=o.n.toString(16),s=o.e.toString(16);return i.setPublic(r,s),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=i,a}if("EC"==t){var o,a,u=e,c=new ct.crypto.ECDSA({curve:u}).generateKeyPairHex();return(o=new ct.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),o.setPrivateKeyHex(c.ecprvhex),o.isPrivate=!0,o.isPublic=!1,(i=new ct.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=i,a}throw"unknown algorithm: "+t},Vt.getPEM=function(t,e,n,i,r,s){var o=ct,a=o.asn1,u=a.DERObjectIdentifier,c=a.DERInteger,l=a.ASN1Util.newObject,h=a.x509.SubjectPublicKeyInfo,d=o.crypto,p=d.DSA,f=d.ECDSA,g=rt;function m(t){return l({seq:[{int:0},{int:{bigint:t.n}},{int:t.e},{int:{bigint:t.d}},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.dmp1}},{int:{bigint:t.dmq1}},{int:{bigint:t.coeff}}]})}function y(t){return l({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a0",!0,{oid:{name:t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]})}function _(t){return l({seq:[{int:0},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}},{int:{bigint:t.y}},{int:{bigint:t.x}}]})}if((void 0!==g&&t instanceof g||void 0!==p&&t instanceof p||void 0!==f&&t instanceof f)&&1==t.isPublic&&(void 0===e||"PKCS8PUB"==e))return kt(S=new h(t).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==e&&void 0!==g&&t instanceof g&&(void 0===n||null==n)&&1==t.isPrivate)return kt(S=m(t).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==e&&void 0!==f&&t instanceof f&&(void 0===n||null==n)&&1==t.isPrivate){var w=new u({name:t.curveName}).getEncodedHex(),b=y(t).getEncodedHex(),x="";return(x+=kt(w,"EC PARAMETERS"))+kt(b,"EC PRIVATE KEY")}if("PKCS1PRV"==e&&void 0!==p&&t instanceof p&&(void 0===n||null==n)&&1==t.isPrivate)return kt(S=_(t).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==e&&void 0!==g&&t instanceof g&&void 0!==n&&null!=n&&1==t.isPrivate){var S=m(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",S,n,i,s)}if("PKCS5PRV"==e&&void 0!==f&&t instanceof f&&void 0!==n&&null!=n&&1==t.isPrivate)return S=y(t).getEncodedHex(),void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",S,n,i,s);if("PKCS5PRV"==e&&void 0!==p&&t instanceof p&&void 0!==n&&null!=n&&1==t.isPrivate)return S=_(t).getEncodedHex(),void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",S,n,i,s);var T=function(t,e){var n=C(t,e);return new l({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:n.pbkdf2Salt}},{int:n.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:n.encryptionSchemeIV}}]}]}]},{octstr:{hex:n.ciphertext}}]}).getEncodedHex()},C=function(t,e){var n=v.lib.WordArray.random(8),i=v.lib.WordArray.random(8),r=v.PBKDF2(e,n,{keySize:6,iterations:100}),s=v.enc.Hex.parse(t),o=v.TripleDES.encrypt(s,r,{iv:i})+"",a={};return a.ciphertext=o,a.pbkdf2Salt=v.enc.Hex.stringify(n),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=v.enc.Hex.stringify(i),a};if("PKCS8PRV"==e&&null!=g&&t instanceof g&&1==t.isPrivate){var E=m(t).getEncodedHex();return S=l({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:E}}]}).getEncodedHex(),void 0===n||null==n?kt(S,"PRIVATE KEY"):kt(b=T(S,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==f&&t instanceof f&&1==t.isPrivate)return E=new l({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}).getEncodedHex(),S=l({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:E}}]}).getEncodedHex(),void 0===n||null==n?kt(S,"PRIVATE KEY"):kt(b=T(S,n),"ENCRYPTED PRIVATE KEY");if("PKCS8PRV"==e&&void 0!==p&&t instanceof p&&1==t.isPrivate)return E=new c({bigint:t.x}).getEncodedHex(),S=l({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:E}}]}).getEncodedHex(),void 0===n||null==n?kt(S,"PRIVATE KEY"):kt(b=T(S,n),"ENCRYPTED PRIVATE KEY");throw new Error("unsupported object nor format")},Vt.getKeyFromCSRPEM=function(t){var e=Ft(t,"CERTIFICATE REQUEST");return Vt.getKeyFromCSRHex(e)},Vt.getKeyFromCSRHex=function(t){var e=Vt.parseCSRHex(t);return Vt.getKey(e.p8pubkeyhex,null,"pkcs8pub")},Vt.parseCSRHex=function(t){var e=dt,n=e.getChildIdx,i=e.getTLV,r={},s=t;if("30"!=s.substr(0,2))throw"malformed CSR(code:001)";var o=n(s,0);if(o.length<1)throw"malformed CSR(code:002)";if("30"!=s.substr(o[0],2))throw"malformed CSR(code:003)";var a=n(s,o[0]);if(a.length<3)throw"malformed CSR(code:004)";return r.p8pubkeyhex=i(s,a[2]),r},Vt.getKeyID=function(t){var e=Vt,n=dt;"string"==typeof t&&-1!=t.indexOf("BEGIN ")&&(t=e.getKey(t));var i=Ft(e.getPEM(t)),r=n.getIdxbyList(i,0,[1]),s=n.getV(i,r).substring(2);return ct.crypto.Util.hashHex(s,"sha1")},Vt.getJWKFromKey=function(t){var e={};if(t instanceof rt&&t.isPrivate)return e.kty="RSA",e.n=_t(t.n.toString(16)),e.e=_t(t.e.toString(16)),e.d=_t(t.d.toString(16)),e.p=_t(t.p.toString(16)),e.q=_t(t.q.toString(16)),e.dp=_t(t.dmp1.toString(16)),e.dq=_t(t.dmq1.toString(16)),e.qi=_t(t.coeff.toString(16)),e;if(t instanceof rt&&t.isPublic)return e.kty="RSA",e.n=_t(t.n.toString(16)),e.e=_t(t.e.toString(16)),e;if(t instanceof ct.crypto.ECDSA&&t.isPrivate){if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;var n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=_t(n.x),e.y=_t(n.y),e.d=_t(t.prvKeyHex),e}if(t instanceof ct.crypto.ECDSA&&t.isPublic){var i;if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;return n=t.getPublicKeyXYHex(),e.kty="EC",e.crv=i,e.x=_t(n.x),e.y=_t(n.y),e}throw"not supported key object"},rt.getPosArrayOfChildrenFromHex=function(t){return dt.getChildIdx(t,0)},rt.getHexValueArrayOfChildrenFromHex=function(t){var e,n=dt.getV,i=n(t,(e=rt.getPosArrayOfChildrenFromHex(t))[0]),r=n(t,e[1]),s=n(t,e[2]),o=n(t,e[3]),a=n(t,e[4]),u=n(t,e[5]),c=n(t,e[6]),l=n(t,e[7]),h=n(t,e[8]);return(e=new Array).push(i,r,s,o,a,u,c,l,h),e},rt.prototype.readPrivateKeyFromPEMString=function(t){var e=Ft(t),n=rt.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},rt.prototype.readPKCS5PrvKeyHex=function(t){var e=rt.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},rt.prototype.readPKCS8PrvKeyHex=function(t){var e,n,i,r,s,o,a,u,c=dt,l=c.getVbyListEx;if(!1===c.isASN1HEX(t))throw new Error("not ASN.1 hex string");try{e=l(t,0,[2,0,1],"02"),n=l(t,0,[2,0,2],"02"),i=l(t,0,[2,0,3],"02"),r=l(t,0,[2,0,4],"02"),s=l(t,0,[2,0,5],"02"),o=l(t,0,[2,0,6],"02"),a=l(t,0,[2,0,7],"02"),u=l(t,0,[2,0,8],"02")}catch(t){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(e,n,i,r,s,o,a,u)},rt.prototype.readPKCS5PubKeyHex=function(t){var e=dt,n=e.getV;if(!1===e.isASN1HEX(t))throw new Error("keyHex is not ASN.1 hex string");var i=e.getChildIdx(t,0);if(2!==i.length||"02"!==t.substr(i[0],2)||"02"!==t.substr(i[1],2))throw new Error("wrong hex for PKCS#5 public key");var r=n(t,i[0]),s=n(t,i[1]);this.setPublic(r,s)},rt.prototype.readPKCS8PubKeyHex=function(t){var e=dt;if(!1===e.isASN1HEX(t))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==e.getTLVbyListEx(t,0,[0,0]))throw new Error("not PKCS8 RSA public key");var n=e.getTLVbyListEx(t,0,[1,0]);this.readPKCS5PubKeyHex(n)},rt.prototype.readCertPubKeyHex=function(t,e){var n,i;(n=new zt).readCertHex(t),i=n.getPublicKeyHex(),this.readPKCS8PubKeyHex(i)};var Ht=new RegExp("[^0-9a-f]","gi");function qt(t,e){for(var n="",i=e/4-t.length,r=0;r<i;r++)n+="0";return n+t}function Wt(t,e,n){for(var i="",r=0;i.length<e;)i+=St(n(Tt(t+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])))),r+=1;return i}function Kt(t){for(var e in ct.crypto.Util.DIGESTINFOHEAD){var n=ct.crypto.Util.DIGESTINFOHEAD[e],i=n.length;if(t.substring(0,i)==n)return[e,t.substring(i)]}return[]}function zt(t){var e,n=dt,i=n.getChildIdx,r=n.getV,s=n.getTLV,o=n.getVbyList,a=n.getVbyListEx,u=n.getTLVbyList,c=n.getTLVbyListEx,l=n.getIdxbyList,h=n.getIdxbyListEx,d=n.getVidx,p=n.oidname,f=n.hextooidstr,g=zt,m=Ft;try{e=ct.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(t){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==u(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return a(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var t=c(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(t)},this.getAlgorithmIdentifierName=function(t){for(var n in e)if(t===e[n])return n;return p(a(t,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return u(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return g.hex2dn(this.getIssuerHex())},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return u(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return g.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var t=o(this.hex,0,[0,4+this.foffset,0]);return t=t.replace(/(..)/g,"%$1"),decodeURIComponent(t)},this.getNotAfter=function(){var t=o(this.hex,0,[0,4+this.foffset,1]);return t=t.replace(/(..)/g,"%$1"),decodeURIComponent(t)},this.getPublicKeyHex=function(){return n.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var t=this.getPublicKeyIdx();return l(this.hex,t,[1,0],"30")},this.getPublicKey=function(){return Vt.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var t=u(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(t)},this.getSignatureValueHex=function(){return o(this.hex,0,[2],"03",!0)},this.verifySignature=function(t){var e=this.getSignatureAlgorithmField(),n=this.getSignatureValueHex(),i=u(this.hex,0,[0],"30"),r=new ct.crypto.Signature({alg:e});return r.init(t),r.updateHex(i),r.verify(n)},this.parseExt=function(t){var e,s,a;if(void 0===t){if(a=this.hex,3!==this.version)return-1;e=l(a,0,[0,7,0],"30"),s=i(a,e)}else{a=Ft(t);var u=l(a,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=r(a,u))return void(this.aExtInfo=new Array);e=l(a,0,[0,3,0,1,0],"30"),s=i(a,e),this.hex=a}this.aExtInfo=new Array;for(var c=0;c<s.length;c++){var h={critical:!1},p=0;3===i(a,s[c]).length&&(h.critical=!0,p=1),h.oid=n.hextooidstr(o(a,s[c],[0],"06"));var f=l(a,s[c],[1+p]);h.vidx=d(a,f),this.aExtInfo.push(h)}},this.getExtInfo=function(t){var e=this.aExtInfo,n=t;if(t.match(/^[0-9.]+$/)||(n=ct.asn1.x509.OID.name2oid(t)),""!==n)for(var i=0;i<e.length;i++)if(e[i].oid===n)return e[i]},this.getExtBasicConstraints=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("basicConstraints");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var i={extname:"basicConstraints"};if(e&&(i.critical=!0),"3000"===t)return i;if("30030101ff"===t)return i.cA=!0,i;if("30060101ff02"===t.substr(0,12)){var o=r(t,10),a=parseInt(o,16);return i.cA=!0,i.pathLen=a,i}throw new Error("hExtV parse error: "+t)},this.getExtKeyUsage=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("keyUsage");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var i={extname:"keyUsage"};return e&&(i.critical=!0),i.names=this.getExtKeyUsageString(t).split(","),i},this.getExtKeyUsageBin=function(t){if(void 0===t){var e=this.getExtInfo("keyUsage");if(void 0===e)return"";t=s(this.hex,e.vidx)}if(8!=t.length&&10!=t.length)throw new Error("malformed key usage value: "+t);var n="000000000000000"+parseInt(t.substr(6),16).toString(2);return 8==t.length&&(n=n.slice(-8)),10==t.length&&(n=n.slice(-16)),""==(n=n.replace(/0+$/,""))&&(n="0"),n},this.getExtKeyUsageString=function(t){for(var e=this.getExtKeyUsageBin(t),n=new Array,i=0;i<e.length;i++)"1"==e.substr(i,1)&&n.push(zt.KEYUSAGE_NAME[i]);return n.join(",")},this.getExtSubjectKeyIdentifier=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("subjectKeyIdentifier");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var i={extname:"subjectKeyIdentifier"};e&&(i.critical=!0);var o=r(t,0);return i.kid={hex:o},i},this.getExtAuthorityKeyIdentifier=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("authorityKeyIdentifier");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var o={extname:"authorityKeyIdentifier"};e&&(o.critical=!0);for(var a=i(t,0),u=0;u<a.length;u++){var c=t.substr(a[u],2);if("80"===c&&(o.kid={hex:r(t,a[u])}),"a1"===c){var l=s(t,a[u]),h=this.getGeneralNames(l);o.issuer=h[0].dn}"82"===c&&(o.sn={hex:r(t,a[u])})}return o},this.getExtExtKeyUsage=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("extKeyUsage");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var o={extname:"extKeyUsage",array:[]};e&&(o.critical=!0);for(var a=i(t,0),u=0;u<a.length;u++)o.array.push(p(r(t,a[u])));return o},this.getExtExtKeyUsageName=function(){var t=this.getExtInfo("extKeyUsage");if(void 0===t)return t;var e=new Array,n=s(this.hex,t.vidx);if(""===n)return e;for(var o=i(n,0),a=0;a<o.length;a++)e.push(p(r(n,o[a])));return e},this.getExtSubjectAltName=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("subjectAltName");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var i={extname:"subjectAltName",array:[]};return e&&(i.critical=!0),i.array=this.getGeneralNames(t),i},this.getExtIssuerAltName=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("issuerAltName");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var i={extname:"issuerAltName",array:[]};return e&&(i.critical=!0),i.array=this.getGeneralNames(t),i},this.getGeneralNames=function(t){for(var e=i(t,0),n=[],r=0;r<e.length;r++){var o=this.getGeneralName(s(t,e[r]));void 0!==o&&n.push(o)}return n},this.getGeneralName=function(t){var e=t.substr(0,2),n=r(t,0),i=St(n);return"81"==e?{rfc822:i}:"82"==e?{dns:i}:"86"==e?{uri:i}:"87"==e?{ip:Nt(n)}:"a4"==e?{dn:this.getX500Name(n)}:void 0},this.getExtSubjectAltName2=function(){var t,e,n,o=this.getExtInfo("subjectAltName");if(void 0===o)return o;for(var a=new Array,u=s(this.hex,o.vidx),c=i(u,0),l=0;l<c.length;l++)n=u.substr(c[l],2),t=r(u,c[l]),"81"===n&&(e=xt(t),a.push(["MAIL",e])),"82"===n&&(e=xt(t),a.push(["DNS",e])),"84"===n&&(e=zt.hex2dn(t,0),a.push(["DN",e])),"86"===n&&(e=xt(t),a.push(["URI",e])),"87"===n&&(e=Nt(t),a.push(["IP",e]));return a},this.getExtCRLDistributionPoints=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("cRLDistributionPoints");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var r={extname:"cRLDistributionPoints",array:[]};e&&(r.critical=!0);for(var o=i(t,0),a=0;a<o.length;a++){var u=s(t,o[a]);r.array.push(this.getDistributionPoint(u))}return r},this.getDistributionPoint=function(t){for(var e={},n=i(t,0),r=0;r<n.length;r++){var o=t.substr(n[r],2),a=s(t,n[r]);"a0"==o&&(e.dpname=this.getDistributionPointName(a))}return e},this.getDistributionPointName=function(t){for(var e={},n=i(t,0),r=0;r<n.length;r++){var o=t.substr(n[r],2),a=s(t,n[r]);"a0"==o&&(e.full=this.getGeneralNames(a))}return e},this.getExtCRLDistributionPointsURI=function(){var t=this.getExtInfo("cRLDistributionPoints");if(void 0===t)return t;for(var e=new Array,n=i(this.hex,t.vidx),r=0;r<n.length;r++)try{var s=xt(o(this.hex,n[r],[0,0,0],"86"));e.push(s)}catch(t){}return e},this.getExtAIAInfo=function(){var t=this.getExtInfo("authorityInfoAccess");if(void 0===t)return t;for(var e={ocsp:[],caissuer:[]},n=i(this.hex,t.vidx),r=0;r<n.length;r++){var s=o(this.hex,n[r],[0],"06"),a=o(this.hex,n[r],[1],"86");"2b06010505073001"===s&&e.ocsp.push(xt(a)),"2b06010505073002"===s&&e.caissuer.push(xt(a))}return e},this.getExtAuthorityInfoAccess=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("authorityInfoAccess");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var r={extname:"authorityInfoAccess",array:[]};e&&(r.critical=!0);for(var u=i(t,0),c=0;c<u.length;c++){var l=a(t,u[c],[0],"06"),h=xt(o(t,u[c],[1],"86"));if("2b06010505073001"==l)r.array.push({ocsp:h});else{if("2b06010505073002"!=l)throw new Error("unknown method: "+l);r.array.push({caissuer:h})}}return r},this.getExtCertificatePolicies=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("certificatePolicies");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var r={extname:"certificatePolicies",array:[]};e&&(r.critical=!0);for(var o=i(t,0),a=0;a<o.length;a++){var u=s(t,o[a]),c=this.getPolicyInformation(u);r.array.push(c)}return r},this.getPolicyInformation=function(t){var e={},n=o(t,0,[0],"06");e.policyoid=p(n);var r=h(t,0,[1],"30");if(-1!=r){e.array=[];for(var a=i(t,r),u=0;u<a.length;u++){var c=s(t,a[u]),l=this.getPolicyQualifierInfo(c);e.array.push(l)}}return e},this.getPolicyQualifierInfo=function(t){var e={},n=o(t,0,[0],"06");if("2b06010505070201"===n){var i=a(t,0,[1],"16");e.cps=St(i)}else if("2b06010505070202"===n){var r=u(t,0,[1],"30");e.unotice=this.getUserNotice(r)}return e},this.getUserNotice=function(t){for(var e={},n=i(t,0),r=0;r<n.length;r++){var o=s(t,n[r]);"30"!=o.substr(0,2)&&(e.exptext=this.getDisplayText(o))}return e},this.getDisplayText=function(t){var e={};return e.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[t.substr(0,2)],e.str=St(r(t,0)),e},this.getExtCRLNumber=function(t,e){var n={extname:"cRLNumber"};if(e&&(n.critical=!0),"02"==t.substr(0,2))return n.num={hex:r(t,0)},n;throw new Error("hExtV parse error: "+t)},this.getExtCRLReason=function(t,e){var n={extname:"cRLReason"};if(e&&(n.critical=!0),"0a"==t.substr(0,2))return n.code=parseInt(r(t,0),16),n;throw new Error("hExtV parse error: "+t)},this.getExtOcspNonce=function(t,e){var n={extname:"ocspNonce"};e&&(n.critical=!0);var i=r(t,0);return n.hex=i,n},this.getExtOcspNoCheck=function(t,e){var n={extname:"ocspNoCheck"};return e&&(n.critical=!0),n},this.getExtAdobeTimeStamp=function(t,e){if(void 0===t&&void 0===e){var n=this.getExtInfo("adobeTimeStamp");if(void 0===n)return;t=s(this.hex,n.vidx),e=n.critical}var r={extname:"adobeTimeStamp"};e&&(r.critical=!0);var o=i(t,0);if(o.length>1){var a=s(t,o[1]),u=this.getGeneralName(a);null!=u.uri&&(r.uri=u.uri)}if(o.length>2){var c=s(t,o[2]);"0101ff"==c&&(r.reqauth=!0),"010100"==c&&(r.reqauth=!1)}return r},this.getX500NameRule=function(t){for(var e=null,n=[],i=0;i<t.length;i++)for(var r=t[i],s=0;s<r.length;s++)n.push(r[s]);for(i=0;i<n.length;i++){var o=n[i],a=o.ds,u=o.value,c=o.type;if("prn"!=a&&"utf8"!=a&&"ia5"!=a)return"mixed";if("ia5"==a){if("CN"!=c)return"mixed";if(ct.lang.String.isMail(u))continue;return"mixed"}if("C"==c){if("prn"==a)continue;return"mixed"}if(null==e)e=a;else if(e!==a)return"mixed"}return null==e?"prn":e},this.getX500Name=function(t){var e=this.getX500NameArray(t);return{array:e,str:this.dnarraytostr(e)}},this.getX500NameArray=function(t){for(var e=[],n=i(t,0),r=0;r<n.length;r++)e.push(this.getRDN(s(t,n[r])));return e},this.getRDN=function(t){for(var e=[],n=i(t,0),r=0;r<n.length;r++)e.push(this.getAttrTypeAndValue(s(t,n[r])));return e},this.getAttrTypeAndValue=function(t){var e={type:null,value:null,ds:null},n=i(t,0),r=o(t,n[0],[],"06"),s=o(t,n[1],[]),a=ct.asn1.ASN1Util.oidHexToInt(r);return e.type=ct.asn1.x509.OID.oid2atype(a),e.value=St(s),e.ds=this.HEX2STAG[t.substr(n[1],2)],e},this.readCertPEM=function(t){this.readCertHex(m(t))},this.readCertHex=function(t){this.hex=t,this.getVersion();try{l(this.hex,0,[0,7],"a3"),this.parseExt()}catch(t){}},this.getParam=function(){var t={};return t.version=this.getVersion(),t.serial={hex:this.getSerialNumberHex()},t.sigalg=this.getSignatureAlgorithmField(),t.issuer=this.getIssuer(),t.notbefore=this.getNotBefore(),t.notafter=this.getNotAfter(),t.subject=this.getSubject(),t.sbjpubkey=kt(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(t.ext=this.getExtParamArray()),t.sighex=this.getSignatureValueHex(),t},this.getExtParamArray=function(t){null==t&&-1!=h(this.hex,0,[0,"[3]"])&&(t=c(this.hex,0,[0,"[3]",0],"30"));for(var e=[],n=i(t,0),r=0;r<n.length;r++){var o=s(t,n[r]),a=this.getExtParam(o);null!=a&&e.push(a)}return e},this.getExtParam=function(t){var e=i(t,0).length;if(2!=e&&3!=e)throw new Error("wrong number elements in Extension: "+e+" "+t);var n=f(o(t,0,[0],"06")),r=!1;3==e&&"0101ff"==u(t,0,[1])&&(r=!0);var s=u(t,0,[e-1,0]),a=void 0;if("2.5.29.14"==n?a=this.getExtSubjectKeyIdentifier(s,r):"2.5.29.15"==n?a=this.getExtKeyUsage(s,r):"2.5.29.17"==n?a=this.getExtSubjectAltName(s,r):"2.5.29.18"==n?a=this.getExtIssuerAltName(s,r):"2.5.29.19"==n?a=this.getExtBasicConstraints(s,r):"2.5.29.31"==n?a=this.getExtCRLDistributionPoints(s,r):"2.5.29.32"==n?a=this.getExtCertificatePolicies(s,r):"2.5.29.35"==n?a=this.getExtAuthorityKeyIdentifier(s,r):"2.5.29.37"==n?a=this.getExtExtKeyUsage(s,r):"1.3.6.1.5.5.7.1.1"==n?a=this.getExtAuthorityInfoAccess(s,r):"2.5.29.20"==n?a=this.getExtCRLNumber(s,r):"2.5.29.21"==n?a=this.getExtCRLReason(s,r):"1.3.6.1.5.5.7.48.1.2"==n?a=this.getExtOcspNonce(s,r):"1.3.6.1.5.5.7.48.1.5"==n?a=this.getExtOcspNoCheck(s,r):"1.2.840.113583.1.1.9.1"==n&&(a=this.getExtAdobeTimeStamp(s,r)),null!=a)return a;var c={extname:n,extn:s};return r&&(c.critical=!0),c},this.findExt=function(t,e){for(var n=0;n<t.length;n++)if(t[n].extname==e)return t[n];return null},this.updateExtCDPFullURI=function(t,e){var n=this.findExt(t,"cRLDistributionPoints");if(null!=n&&null!=n.array)for(var i=n.array,r=0;r<i.length;r++)if(null!=i[r].dpname&&null!=i[r].dpname.full)for(var s=i[r].dpname.full,o=0;o<s.length;o++){var a=s[r];null!=a.uri&&(a.uri=e)}},this.updateExtAIAOCSP=function(t,e){var n=this.findExt(t,"authorityInfoAccess");if(null!=n&&null!=n.array)for(var i=n.array,r=0;r<i.length;r++)null!=i[r].ocsp&&(i[r].ocsp=e)},this.updateExtAIACAIssuer=function(t,e){var n=this.findExt(t,"authorityInfoAccess");if(null!=n&&null!=n.array)for(var i=n.array,r=0;r<i.length;r++)null!=i[r].caissuer&&(i[r].caissuer=e)},this.dnarraytostr=function(t){return"/"+t.map((function(t){return function(t){return t.map((function(t){return function(t){return t.type+"="+t.value}(t)})).join("+")}(t)})).join("/")},this.getInfo=function(){var t,e,n,i=function(t){return JSON.stringify(t.array).replace(/[\[\]\{\}\"]/g,"")},r=function(t){for(var e="",n=t.array,i=0;i<n.length;i++){var r=n[i];if(e+="    policy oid: "+r.policyoid+"\n",void 0!==r.array)for(var s=0;s<r.array.length;s++){var o=r.array[s];void 0!==o.cps&&(e+="    cps: "+o.cps+"\n")}}return e},s=function(t){for(var e="",n=t.array,i=0;i<n.length;i++){var r=n[i];try{void 0!==r.dpname.full[0].uri&&(e+="    "+r.dpname.full[0].uri+"\n")}catch(t){}try{void 0!==r.dname.full[0].dn.hex&&(e+="    "+zt.hex2dn(r.dpname.full[0].dn.hex)+"\n")}catch(t){}}return e},o=function(t){for(var e="",n=t.array,i=0;i<n.length;i++){var r=n[i];void 0!==r.caissuer&&(e+="    caissuer: "+r.caissuer+"\n"),void 0!==r.ocsp&&(e+="    ocsp: "+r.ocsp+"\n")}return e};if(t="Basic Fields\n",t+="  serial number: "+this.getSerialNumberHex()+"\n",t+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",t+="  issuer: "+this.getIssuerString()+"\n",t+="  notBefore: "+this.getNotBefore()+"\n",t+="  notAfter: "+this.getNotAfter()+"\n",t+="  subject: "+this.getSubjectString()+"\n",t+="  subject public key info: \n",t+="    key algorithm: "+(e=this.getPublicKey()).type+"\n","RSA"===e.type&&(t+="    n="+Bt(e.n.toString(16)).substr(0,16)+"...\n",t+="    e="+Bt(e.e.toString(16))+"\n"),null!=(n=this.aExtInfo)){t+="X509v3 Extensions:\n";for(var a=0;a<n.length;a++){var u=n[a],c=ct.asn1.x509.OID.oid2name(u.oid);""===c&&(c=u.oid);var l="";if(!0===u.critical&&(l="CRITICAL"),t+="  "+c+" "+l+":\n","basicConstraints"===c){var h=this.getExtBasicConstraints();void 0===h.cA?t+="    {}\n":(t+="    cA=true",void 0!==h.pathLen&&(t+=", pathLen="+h.pathLen),t+="\n")}else if("keyUsage"===c)t+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===c)t+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"===c){var d=this.getExtAuthorityKeyIdentifier();void 0!==d.kid&&(t+="    kid="+d.kid.hex+"\n")}else"extKeyUsage"===c?t+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"===c?t+="    "+i(this.getExtSubjectAltName())+"\n":"cRLDistributionPoints"===c?t+=s(this.getExtCRLDistributionPoints()):"authorityInfoAccess"===c?t+=o(this.getExtAuthorityInfoAccess()):"certificatePolicies"===c&&(t+=r(this.getExtCertificatePolicies()))}}return(t+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n")+"signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof t&&(-1!=t.indexOf("-----BEGIN")?this.readCertPEM(t):ct.lang.String.isHex(t)&&this.readCertHex(t))}rt.prototype.sign=function(t,e){var n=function(t){return ct.crypto.Util.hashString(t,e)}(t);return this.signWithMessageHash(n,e)},rt.prototype.signWithMessageHash=function(t,e){var n=nt(ct.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return qt(this.doPrivate(n).toString(16),this.n.bitLength())},rt.prototype.signPSS=function(t,e,n){var i=function(t){return ct.crypto.Util.hashHex(t,e)}(Tt(t));return void 0===n&&(n=-1),this.signWithMessageHashPSS(i,e,n)},rt.prototype.signWithMessageHashPSS=function(t,e,n){var i,r=St(t),s=r.length,o=this.n.bitLength()-1,a=Math.ceil(o/8),u=function(t){return ct.crypto.Util.hashHex(t,e)};if(-1===n||void 0===n)n=s;else if(-2===n)n=a-s-2;else if(n<-2)throw new Error("invalid salt length");if(a<s+n+2)throw new Error("data too long");var c="";n>0&&(c=new Array(n),(new et).nextBytes(c),c=String.fromCharCode.apply(String,c));var l=St(u(Tt("\0\0\0\0\0\0\0\0"+r+c))),h=[];for(i=0;i<a-n-s-2;i+=1)h[i]=0;var d=String.fromCharCode.apply(String,h)+""+c,p=Wt(l,d.length,u),f=[];for(i=0;i<d.length;i+=1)f[i]=d.charCodeAt(i)^p.charCodeAt(i);var g=65280>>8*a-o&255;for(f[0]&=~g,i=0;i<s;i++)f.push(l.charCodeAt(i));return f.push(188),qt(this.doPrivate(new S(f)).toString(16),this.n.bitLength())},rt.prototype.verify=function(t,e){var n=nt(e=(e=e.replace(Ht,"")).replace(/[ \n]+/g,""),16);if(n.bitLength()>this.n.bitLength())return 0;var i=Kt(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==i.length)return!1;var r=i[0];return i[1]==function(t){return ct.crypto.Util.hashString(t,r)}(t)},rt.prototype.verifyWithMessageHash=function(t,e){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1;var n=nt(e,16);if(n.bitLength()>this.n.bitLength())return 0;var i=Kt(this.doPublic(n).toString(16).replace(/^1f+00/,""));return 0!=i.length&&(i[0],i[1]==t)},rt.prototype.verifyPSS=function(t,e,n,i){var r=function(t){return ct.crypto.Util.hashHex(t,n)}(Tt(t));return void 0===i&&(i=-1),this.verifyWithMessageHashPSS(r,e,n,i)},rt.prototype.verifyWithMessageHashPSS=function(t,e,n,i){if(e.length!=Math.ceil(this.n.bitLength()/4))return!1;var r,s=new S(e,16),o=function(t){return ct.crypto.Util.hashHex(t,n)},a=St(t),u=a.length,c=this.n.bitLength()-1,l=Math.ceil(c/8);if(-1===i||void 0===i)i=u;else if(-2===i)i=l-u-2;else if(i<-2)throw new Error("invalid salt length");if(l<u+i+2)throw new Error("data too long");var h=this.doPublic(s).toByteArray();for(r=0;r<h.length;r+=1)h[r]&=255;for(;h.length<l;)h.unshift(0);if(188!==h[l-1])throw new Error("encoded message does not end in 0xbc");var d=(h=String.fromCharCode.apply(String,h)).substr(0,l-u-1),p=h.substr(d.length,u),f=65280>>8*l-c&255;if(0!=(d.charCodeAt(0)&f))throw new Error("bits beyond keysize not zero");var g=Wt(p,d.length,o),m=[];for(r=0;r<d.length;r+=1)m[r]=d.charCodeAt(r)^g.charCodeAt(r);m[0]&=~f;var v=l-u-i-2;for(r=0;r<v;r+=1)if(0!==m[r])throw new Error("leftmost octets not zero");if(1!==m[v])throw new Error("0x01 marker not found");return p===St(o(Tt("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,m.slice(-i)))))},rt.SALT_LEN_HLEN=-1,rt.SALT_LEN_MAX=-2,rt.SALT_LEN_RECOVER=-2,zt.hex2dn=function(t,e){if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw new Error("malformed DN");for(var n=new Array,i=dt.getChildIdx(t,e),r=0;r<i.length;r++)n.push(zt.hex2rdn(t,i[r]));return"/"+(n=n.map((function(t){return t.replace("/","\\/")}))).join("/")},zt.hex2rdn=function(t,e){if(void 0===e&&(e=0),"31"!==t.substr(e,2))throw new Error("malformed RDN");for(var n=new Array,i=dt.getChildIdx(t,e),r=0;r<i.length;r++)n.push(zt.hex2attrTypeValue(t,i[r]));return(n=n.map((function(t){return t.replace("+","\\+")}))).join("+")},zt.hex2attrTypeValue=function(t,e){var n=dt,i=n.getV;if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw new Error("malformed attribute type and value");var r=n.getChildIdx(t,e);2!==r.length||t.substr(r[0],2);var s=i(t,r[0]),o=ct.asn1.ASN1Util.oidHexToInt(s);return ct.asn1.x509.OID.oid2atype(o)+"="+St(i(t,r[1]))},zt.getPublicKeyFromCertHex=function(t){var e=new zt;return e.readCertHex(t),e.getPublicKey()},zt.getPublicKeyFromCertPEM=function(t){var e=new zt;return e.readCertPEM(t),e.getPublicKey()},zt.getPublicKeyInfoPropOfCertPEM=function(t){var e,n,i=dt.getVbyList,r={algparam:null};return(e=new zt).readCertPEM(t),n=e.getPublicKeyHex(),r.keyhex=i(n,0,[1],"03").substr(2),r.algoid=i(n,0,[0,0],"06"),"2a8648ce3d0201"===r.algoid&&(r.algparam=i(n,0,[0,1],"06")),r},zt.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==ct&&ct||(e.KJUR=ct={}),void 0!==ct.jws&&ct.jws||(ct.jws={}),ct.jws.JWS=function(){var t=ct.jws.JWS.isSafeJSONString;this.parseJWS=function(e,n){if(void 0===this.parsedJWS||!n&&void 0===this.parsedJWS.sigvalH){var i=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==i)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var r=i[1],s=i[2],o=i[3],a=r+"."+s;if(this.parsedJWS={},this.parsedJWS.headB64U=r,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=o,this.parsedJWS.si=a,!n){var u=wt(o),c=nt(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=c}var l=ht(r),h=ht(s);if(this.parsedJWS.headS=l,this.parsedJWS.payloadS=h,!t(l,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+l}}},ct.jws.JWS.sign=function(t,e,i,r,s){var o,a,u,c=ct,l=c.jws.JWS,h=l.readSafeJSONString,d=l.isSafeJSONString,p=c.crypto,f=(p.ECDSA,p.Mac),g=p.Signature,m=JSON;if("string"!=typeof e&&"object"!=(void 0===e?"undefined":n(e)))throw"spHeader must be JSON string or object: "+e;if("object"==(void 0===e?"undefined":n(e))&&(a=e,o=m.stringify(a)),"string"==typeof e){if(!d(o=e))throw"JWS Head is not safe JSON string: "+o;a=h(o)}if(u=i,"object"==(void 0===i?"undefined":n(i))&&(u=m.stringify(i)),""!=t&&null!=t||void 0===a.alg||(t=a.alg),""!=t&&null!=t&&void 0===a.alg&&(a.alg=t,o=m.stringify(a)),t!==a.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+a.alg;var v=null;if(void 0===l.jwsalg2sigalg[t])throw"unsupported alg name: "+t;v=l.jwsalg2sigalg[t];var y=lt(o)+"."+lt(u),_="";if("Hmac"==v.substr(0,4)){if(void 0===r)throw"mac key shall be specified for HS* alg";var w=new f({alg:v,prov:"cryptojs",pass:r});w.updateString(y),_=w.doFinal()}else if(-1!=v.indexOf("withECDSA")){(x=new g({alg:v})).init(r,s),x.updateString(y);var b=x.sign();_=ct.crypto.ECDSA.asn1SigToConcatSig(b)}else{var x;"none"!=v&&((x=new g({alg:v})).init(r,s),x.updateString(y),_=x.sign())}return y+"."+_t(_)},ct.jws.JWS.verify=function(t,e,i){var r,s=ct,o=s.jws.JWS,a=o.readSafeJSONString,u=s.crypto,c=u.ECDSA,l=u.Mac,h=u.Signature;void 0!==n(rt)&&(r=rt);var d=t.split(".");if(3!==d.length)return!1;var p,f=d[0]+"."+d[1],g=wt(d[2]),m=a(ht(d[0])),v=null;if(void 0===m.alg)throw"algorithm not specified in header";if(p=(v=m.alg).substr(0,2),null!=i&&"[object Array]"===Object.prototype.toString.call(i)&&i.length>0&&-1==(":"+i.join(":")+":").indexOf(":"+v+":"))throw"algorithm '"+v+"' not accepted in the list";if("none"!=v&&null===e)throw"key shall be specified to verify.";if("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&(e=Vt.getKey(e)),!("RS"!=p&&"PS"!=p||e instanceof r))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==p&&!(e instanceof c))throw"key shall be a ECDSA obj for ES* algs";var y=null;if(void 0===o.jwsalg2sigalg[m.alg])throw"unsupported alg name: "+v;if("none"==(y=o.jwsalg2sigalg[v]))throw"not supported";if("Hmac"==y.substr(0,4)){if(void 0===e)throw"hexadecimal key shall be specified for HMAC";var _=new l({alg:y,pass:e});return _.updateString(f),g==_.doFinal()}if(-1!=y.indexOf("withECDSA")){var w,b=null;try{b=c.concatSigToASN1Sig(g)}catch(t){return!1}return(w=new h({alg:y})).init(e),w.updateString(f),w.verify(b)}return(w=new h({alg:y})).init(e),w.updateString(f),w.verify(g)},ct.jws.JWS.parse=function(t){var e,n,i,r=t.split("."),s={};if(2!=r.length&&3!=r.length)throw"malformed sJWS: wrong number of '.' splitted elements";return e=r[0],n=r[1],3==r.length&&(i=r[2]),s.headerObj=ct.jws.JWS.readSafeJSONString(ht(e)),s.payloadObj=ct.jws.JWS.readSafeJSONString(ht(n)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=ht(n):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==i&&(s.sigHex=wt(i)),s},ct.jws.JWS.verifyJWT=function(t,e,i){var r=ct.jws,s=r.JWS,o=s.readSafeJSONString,a=s.inArray,u=s.includedArray,c=t.split("."),l=c[0],h=c[1],d=(wt(c[2]),o(ht(l))),p=o(ht(h));if(void 0===d.alg)return!1;if(void 0===i.alg)throw"acceptField.alg shall be specified";if(!a(d.alg,i.alg))return!1;if(void 0!==p.iss&&"object"===n(i.iss)&&!a(p.iss,i.iss))return!1;if(void 0!==p.sub&&"object"===n(i.sub)&&!a(p.sub,i.sub))return!1;if(void 0!==p.aud&&"object"===n(i.aud))if("string"==typeof p.aud){if(!a(p.aud,i.aud))return!1}else if("object"==n(p.aud)&&!u(p.aud,i.aud))return!1;var f=r.IntDate.getNow();return void 0!==i.verifyAt&&"number"==typeof i.verifyAt&&(f=i.verifyAt),void 0!==i.gracePeriod&&"number"==typeof i.gracePeriod||(i.gracePeriod=0),!(void 0!==p.exp&&"number"==typeof p.exp&&p.exp+i.gracePeriod<f||void 0!==p.nbf&&"number"==typeof p.nbf&&f<p.nbf-i.gracePeriod||void 0!==p.iat&&"number"==typeof p.iat&&f<p.iat-i.gracePeriod||void 0!==p.jti&&void 0!==i.jti&&p.jti!==i.jti||!s.verify(t,e,i.alg))},ct.jws.JWS.includedArray=function(t,e){var i=ct.jws.JWS.inArray;if(null===t)return!1;if("object"!==(void 0===t?"undefined":n(t)))return!1;if("number"!=typeof t.length)return!1;for(var r=0;r<t.length;r++)if(!i(t[r],e))return!1;return!0},ct.jws.JWS.inArray=function(t,e){if(null===e)return!1;if("object"!==(void 0===e?"undefined":n(e)))return!1;if("number"!=typeof e.length)return!1;for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1},ct.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},ct.jws.JWS.isSafeJSONString=function(t,e,i){var r=null;try{return"object"!=(void 0===(r=ut(t))?"undefined":n(r))||r.constructor===Array?0:(e&&(e[i]=r),1)}catch(t){return 0}},ct.jws.JWS.readSafeJSONString=function(t){var e=null;try{return"object"!=(void 0===(e=ut(t))?"undefined":n(e))||e.constructor===Array?null:e}catch(t){return null}},ct.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==e)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},ct.jws.JWS.getJWKthumbprint=function(t){if("RSA"!==t.kty&&"EC"!==t.kty&&"oct"!==t.kty)throw"unsupported algorithm for JWK Thumprint";var e="{";if("RSA"===t.kty){if("string"!=typeof t.n||"string"!=typeof t.e)throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if("EC"===t.kty){if("string"!=typeof t.crv||"string"!=typeof t.x||"string"!=typeof t.y)throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if("oct"===t.kty){if("string"!=typeof t.k)throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var n=Tt(e);return _t(ct.crypto.Util.hashHex(n,"sha256"))},ct.jws.IntDate={},ct.jws.IntDate.get=function(t){var e=ct.jws.IntDate,n=e.getNow,i=e.getZulu;if("now"==t)return n();if("now + 1hour"==t)return n()+3600;if("now + 1day"==t)return n()+86400;if("now + 1month"==t)return n()+2592e3;if("now + 1year"==t)return n()+31536e3;if(t.match(/Z$/))return i(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},ct.jws.IntDate.getZulu=function(t){return Rt(t)},ct.jws.IntDate.getNow=function(){return~~(new Date/1e3)},ct.jws.IntDate.intDate2UTCString=function(t){return new Date(1e3*t).toUTCString()},ct.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t);return("0000"+e.getUTCFullYear()).slice(-4)+("00"+(e.getUTCMonth()+1)).slice(-2)+("00"+e.getUTCDate()).slice(-2)+("00"+e.getUTCHours()).slice(-2)+("00"+e.getUTCMinutes()).slice(-2)+("00"+e.getUTCSeconds()).slice(-2)+"Z"},e.SecureRandom=et,e.rng_seed_time=Y,e.BigInteger=S,e.RSAKey=rt;var Jt=ct.crypto.EDSA;e.EDSA=Jt;var Gt=ct.crypto.DSA;e.DSA=Gt;var Yt=ct.crypto.Signature;e.Signature=Yt;var $t=ct.crypto.MessageDigest;e.MessageDigest=$t;var Xt=ct.crypto.Mac;e.Mac=Xt;var Zt=ct.crypto.Cipher;e.Cipher=Zt,e.KEYUTIL=Vt,e.ASN1HEX=dt,e.X509=zt,e.CryptoJS=v,e.b64tohex=b,e.b64toBA=x,e.stoBA=pt,e.BAtos=ft,e.BAtohex=gt,e.stohex=mt,e.stob64=function(t){return w(mt(t))},e.stob64u=function(t){return vt(w(mt(t)))},e.b64utos=function(t){return ft(x(yt(t)))},e.b64tob64u=vt,e.b64utob64=yt,e.hex2b64=w,e.hextob64u=_t,e.b64utohex=wt,e.utf8tob64u=lt,e.b64utoutf8=ht,e.utf8tob64=function(t){return w(It(Lt(t)))},e.b64toutf8=function(t){return decodeURIComponent(Dt(b(t)))},e.utf8tohex=bt,e.hextoutf8=xt,e.hextorstr=St,e.rstrtohex=Tt,e.hextob64=Ct,e.hextob64nl=Et,e.b64nltohex=At,e.hextopem=kt,e.pemtohex=Ft,e.hextoArrayBuffer=function(t){if(t.length%2!=0)throw"input is not even length";if(null==t.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var e=new ArrayBuffer(t.length/2),n=new DataView(e),i=0;i<t.length/2;i++)n.setUint8(i,parseInt(t.substr(2*i,2),16));return e},e.ArrayBuffertohex=function(t){for(var e="",n=new DataView(t),i=0;i<t.byteLength;i++)e+=("00"+n.getUint8(i).toString(16)).slice(-2);return e},e.zulutomsec=Pt,e.zulutosec=Rt,e.zulutodate=function(t){return new Date(Pt(t))},e.datetozulu=function(t,e,n){var i,r=t.getUTCFullYear();if(e){if(r<1950||2049<r)throw"not proper year for UTCTime: "+r;i=(""+r).slice(-2)}else i=("000"+r).slice(-4);if(i+=("0"+(t.getUTCMonth()+1)).slice(-2),i+=("0"+t.getUTCDate()).slice(-2),i+=("0"+t.getUTCHours()).slice(-2),i+=("0"+t.getUTCMinutes()).slice(-2),i+=("0"+t.getUTCSeconds()).slice(-2),n){var s=t.getUTCMilliseconds();0!==s&&(i+="."+(s=(s=("00"+s).slice(-3)).replace(/0+$/g,"")))}return i+"Z"},e.uricmptohex=It,e.hextouricmp=Dt,e.ipv6tohex=Ot,e.hextoipv6=Mt,e.hextoip=Nt,e.iptohex=function(t){var e="malformed IP address";if(!(t=t.toLowerCase(t)).match(/^[0-9.]+$/)){if(t.match(/^[0-9a-f:]+$/)&&-1!==t.indexOf(":"))return Ot(t);throw e}var n=t.split(".");if(4!==n.length)throw e;var i="";try{for(var r=0;r<4;r++)i+=("0"+parseInt(n[r]).toString(16)).slice(-2);return i}catch(t){throw e}},e.encodeURIComponentAll=Lt,e.newline_toUnix=function(t){return t.replace(/\r\n/gm,"\n")},e.newline_toDos=function(t){return(t=t.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")},e.hextoposhex=Bt,e.intarystrtohex=function(t){t=(t=(t=t.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return t.split(/,/).map((function(t,e,n){var i=parseInt(t);if(i<0||255<i)throw"integer not in range 0-255";return("00"+i.toString(16)).slice(-2)})).join("")}catch(t){throw"malformed integer array string: "+t}},e.strdiffidx=function(t,e){var n=t.length;t.length>e.length&&(n=e.length);for(var i=0;i<n;i++)if(t.charCodeAt(i)!=e.charCodeAt(i))return i;return t.length!=e.length?n:-1},e.KJUR=ct;var Qt=ct.crypto;e.crypto=Qt;var te=ct.asn1;e.asn1=te;var ee=ct.jws;e.jws=ee;var ne=ct.lang;e.lang=ne}).call(this,n(28).Buffer)},function(t,e,n){(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=n(30),r=n(31),s=n(32);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return c(this,t,e,n)}function c(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i),u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=d(t,e),t}(t,e,n,i):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(e,n),r=(t=a(t,i)).write(e,n);return r!==i&&(t=t.slice(0,r)),t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?a(t,0):d(t,e);if("Buffer"===e.type&&s(e.data))return d(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(l(e),t=a(t,e<0?0:0|p(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function p(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function f(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(t).length;default:if(i)return V(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return E(this,e,n);case"ascii":return k(this,e,n);case"latin1":case"binary":return F(this,e,n);case"base64":return C(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function m(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function v(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=u.from(e,i)),u.isBuffer(e))return 0===e.length?-1:y(t,e,n,i,r);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,i,r){var s,o=1,a=t.length,u=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,u/=2,n/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var l=-1;for(s=n;s<a;s++)if(c(t,s)===c(e,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===u)return l*o}else-1!==l&&(s-=s-l),l=-1}else for(n+u>a&&(n=a-u),s=n;s>=0;s--){for(var h=!0,d=0;d<u;d++)if(c(t,s+d)!==c(e,d)){h=!1;break}if(h)return s}return-1}function _(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function w(t,e,n,i){return q(V(e,t.length-n),t,n,i)}function b(t,e,n,i){return q(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function x(t,e,n,i){return b(t,e,n,i)}function S(t,e,n,i){return q(H(e),t,n,i)}function T(t,e,n,i){return q(function(t,e){for(var n,i,r,s=[],o=0;o<t.length&&!((e-=2)<0);++o)i=(n=t.charCodeAt(o))>>8,r=n%256,s.push(r),s.push(i);return s}(e,t.length-n),t,n,i)}function C(t,e,n){return 0===e&&n===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,n))}function E(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var s,o,a,u,c=t[r],l=null,h=c>239?4:c>223?3:c>191?2:1;if(r+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(s=t[r+1]))&&(u=(31&c)<<6|63&s)>127&&(l=u);break;case 3:s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&(u=(15&c)<<12|(63&s)<<6|63&o)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(u=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|1023&l),i.push(l),r+=h}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);for(var n="",i=0;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=A));return n}(i)}e.Buffer=u,e.SlowBuffer=function(t){return+t!=t&&(t=0),u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,i){return l(e),e<=0?a(t,e):void 0!==n?"string"==typeof i?a(t,e).fill(n,i):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,s=Math.min(n,i);r<s;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=u.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var o=t[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},u.byteLength=f,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):g.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,i,r){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),c=this.slice(i,r),l=t.slice(e,n),h=0;h<a;++h)if(c[h]!==l[h]){s=c[h],o=l[h];break}return s<o?-1:o<s?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},u.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function k(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function F(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function P(t,e,n){var i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var r="",s=e;s<n;++s)r+=U(t[s]);return r}function R(t,e,n){for(var i=t.slice(e,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,n,i,r,s){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function O(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,s=Math.min(t.length-n,2);r<s;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function M(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,s=Math.min(t.length-n,4);r<s;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function N(t,e,n,i,r,s){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,i,s){return s||N(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function j(t,e,n,i,s){return s||N(t,0,n,8),r.write(t,e,n,i,52,8),n+8}u.prototype.slice=function(t,e){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var r=e-t;n=new u(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},u.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var i=e,r=1,s=this[t+--i];i>0&&(r*=256);)s+=this[t+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*e)),s},u.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),r.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),r.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),r.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),r.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,i){t=+t,e|=0,n|=0,i||D(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[e]=255&t;++s<n&&(r*=256);)this[e+s]=t/r&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,i){t=+t,e|=0,n|=0,i||D(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[e+r]=255&t;--r>=0&&(s*=256);)this[e+r]=t/s&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):O(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):O(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):M(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):O(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):O(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):M(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return j(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return j(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,s=i-n;if(this===t&&n<e&&e<i)for(r=s-1;r>=0;--r)t[r+e]=this[r+n];else if(s<1e3||!u.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},u.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!u.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=u.isBuffer(t)?t:V(new u(t,i).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function V(t,e){var n;e=e||1/0;for(var i=t.length,r=null,s=[],o=0;o<i;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function H(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}}).call(this,n(29))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){e.byteLength=function(t){var e=c(t),n=e[0],i=e[1];return 3*(n+i)/4-i},e.toByteArray=function(t){var e,n,i=c(t),o=i[0],a=i[1],u=new s(function(t,e,n){return 3*(e+n)/4-n}(0,o,a)),l=0,h=a>0?o-4:o;for(n=0;n<h;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;return 2===a&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,u[l++]=255&e),1===a&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e),u},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,s=[],o=16383,a=0,u=n-r;a<u;a+=o)s.push(l(t,a,a+o>u?u:a+o));return 1===r?(e=t[n-1],s.push(i[e>>2]+i[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],s.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"=")),s.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=o.length;a<u;++a)i[a]=o[a],r[o.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var r,s,o=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(i[(s=r)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */e.read=function(t,e,n,i,r){var s,o,a=8*r-i-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?r-1:0,d=n?-1:1,p=t[e+h];for(h+=d,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=256*s+t[e+h],h+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=i;l>0;o=256*o+t[e+h],h+=d,l-=8);if(0===s)s=1-c;else{if(s===u)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),s-=c}return(p?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,n,i,r,s){var o,a,u,c=8*s-r-1,l=(1<<c)-1,h=l>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,f=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+h>=1?d/u:d*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(a=0,o=l):o+h>=1?(a=(e*u-1)*Math.pow(2,r),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;t[n+p]=255&a,p+=f,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;t[n+p]=255&o,p+=f,o/=256,c-=8);t[n+p-f]|=128*g}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.jws,n=t.KeyUtil,r=t.X509,s=t.crypto,o=t.hextob64u,a=t.b64tohex,u=t.AllowedSigningAlgs;return function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.parseJwt=function(t){i.Log.debug("JoseUtil.parseJwt");try{var n=e.JWS.parse(t);return{header:n.headerObj,payload:n.payloadObj}}catch(t){i.Log.error(t)}},t.validateJwt=function(e,s,o,u,c,l,h){i.Log.debug("JoseUtil.validateJwt");try{if("RSA"===s.kty)if(s.e&&s.n)s=n.getKey(s);else{if(!s.x5c||!s.x5c.length)return i.Log.error("JoseUtil.validateJwt: RSA key missing key material",s),Promise.reject(new Error("RSA key missing key material"));var d=a(s.x5c[0]);s=r.getPublicKeyFromCertHex(d)}else{if("EC"!==s.kty)return i.Log.error("JoseUtil.validateJwt: Unsupported key type",s&&s.kty),Promise.reject(new Error(s.kty));if(!(s.crv&&s.x&&s.y))return i.Log.error("JoseUtil.validateJwt: EC key missing key material",s),Promise.reject(new Error("EC key missing key material"));s=n.getKey(s)}return t._validateJwt(e,s,o,u,c,l,h)}catch(t){return i.Log.error(t&&t.message||t),Promise.reject("JWT validation failed")}},t.validateJwtAttributes=function(e,n,r,s,o,a){s||(s=0),o||(o=parseInt(Date.now()/1e3));var u=t.parseJwt(e).payload;if(!u.iss)return i.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(u.iss!==n)return i.Log.error("JoseUtil._validateJwt: Invalid issuer in token",u.iss),Promise.reject(new Error("Invalid issuer in token: "+u.iss));if(!u.aud)return i.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(u.aud===r||Array.isArray(u.aud)&&u.aud.indexOf(r)>=0))return i.Log.error("JoseUtil._validateJwt: Invalid audience in token",u.aud),Promise.reject(new Error("Invalid audience in token: "+u.aud));if(u.azp&&u.azp!==r)return i.Log.error("JoseUtil._validateJwt: Invalid azp in token",u.azp),Promise.reject(new Error("Invalid azp in token: "+u.azp));if(!a){var c=o+s,l=o-s;if(!u.iat)return i.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(c<u.iat)return i.Log.error("JoseUtil._validateJwt: iat is in the future",u.iat),Promise.reject(new Error("iat is in the future: "+u.iat));if(u.nbf&&c<u.nbf)return i.Log.error("JoseUtil._validateJwt: nbf is in the future",u.nbf),Promise.reject(new Error("nbf is in the future: "+u.nbf));if(!u.exp)return i.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(u.exp<l)return i.Log.error("JoseUtil._validateJwt: exp is in the past",u.exp),Promise.reject(new Error("exp is in the past:"+u.exp))}return Promise.resolve(u)},t._validateJwt=function(n,r,s,o,a,c,l){return t.validateJwtAttributes(n,s,o,a,c,l).then((function(t){try{return e.JWS.verify(n,r,u)?t:(i.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(t){return i.Log.error(t&&t.message||t),Promise.reject(new Error("signature validation failed"))}}))},t.hashString=function(t,e){try{return s.Util.hashString(t,e)}catch(t){i.Log.error(t)}},t.hexToBase64Url=function(t){try{return o(t)}catch(t){i.Log.error(t)}},t}()};var i=n(0);t.exports=e.default},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SigninResponse=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(3);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.SigninResponse=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";s(this,t);var i=r.UrlUtility.parseUrlFragment(e,n);this.error=i.error,this.error_description=i.error_description,this.error_uri=i.error_uri,this.code=i.code,this.state=i.state,this.id_token=i.id_token,this.session_state=i.session_state,this.access_token=i.access_token,this.token_type=i.token_type,this.scope=i.scope,this.profile=void 0,this.expires_in=i.expires_in}return i(t,[{key:"expires_in",get:function(){if(this.expires_at){var t=parseInt(Date.now()/1e3);return this.expires_at-t}},set:function(t){var e=parseInt(t);if("number"==typeof e&&e>0){var n=parseInt(Date.now()/1e3);this.expires_at=n+e}}},{key:"expired",get:function(){var t=this.expires_in;if(void 0!==t)return t<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SignoutRequest=void 0;var i=n(0),r=n(3),s=n(9);e.SignoutRequest=function t(e){var n=e.url,o=e.id_token_hint,a=e.post_logout_redirect_uri,u=e.data,c=e.extraQueryParams,l=e.request_type;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!n)throw i.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var h in o&&(n=r.UrlUtility.addQueryParam(n,"id_token_hint",o)),a&&(n=r.UrlUtility.addQueryParam(n,"post_logout_redirect_uri",a),u&&(this.state=new s.State({data:u,request_type:l}),n=r.UrlUtility.addQueryParam(n,"state",this.state.id))),c)n=r.UrlUtility.addQueryParam(n,h,c[h]);this.url=n}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SignoutResponse=void 0;var i=n(3);e.SignoutResponse=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=i.UrlUtility.parseUrlFragment(e,"?");this.error=n.error,this.error_description=n.error_description,this.error_uri=n.error_uri,this.state=n.state}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.InMemoryWebStorage=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0);e.InMemoryWebStorage=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._data={}}return t.prototype.getItem=function(t){return r.Log.debug("InMemoryWebStorage.getItem",t),this._data[t]},t.prototype.setItem=function(t,e){r.Log.debug("InMemoryWebStorage.setItem",t),this._data[t]=e},t.prototype.removeItem=function(t){r.Log.debug("InMemoryWebStorage.removeItem",t),delete this._data[t]},t.prototype.key=function(t){return Object.getOwnPropertyNames(this._data)[t]},i(t,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.UserManager=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),s=n(10),o=n(39),a=n(15),u=n(45),c=n(47),l=n(18),h=n(8),d=n(20),p=n(11),f=n(4);function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}e.UserManager=function(t){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.SilentRenewService,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.SessionMonitor,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:d.TokenRevocationClient,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:p.TokenClient,v=arguments.length>5&&void 0!==arguments[5]?arguments[5]:f.JoseUtil;g(this,e),n instanceof o.UserManagerSettings||(n=new o.UserManagerSettings(n));var y=m(this,t.call(this,n));return y._events=new u.UserManagerEvents(n),y._silentRenewService=new i(y),y.settings.automaticSilentRenew&&(r.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),y.startSilentRenew()),y.settings.monitorSession&&(r.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),y._sessionMonitor=new s(y)),y._tokenRevocationClient=new a(y._settings),y._tokenClient=new h(y._settings),y._joseUtil=v,y}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getUser=function(){var t=this;return this._loadUser().then((function(e){return e?(r.Log.info("UserManager.getUser: user loaded"),t._events.load(e,!1),e):(r.Log.info("UserManager.getUser: user not found in storage"),null)}))},e.prototype.removeUser=function(){var t=this;return this.storeUser(null).then((function(){r.Log.info("UserManager.removeUser: user removed from storage"),t._events.unload()}))},e.prototype.signinRedirect=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).request_type="si:r";var e={useReplaceToNavigate:t.useReplaceToNavigate};return this._signinStart(t,this._redirectNavigator,e).then((function(){r.Log.info("UserManager.signinRedirect: successful")}))},e.prototype.signinRedirectCallback=function(t){return this._signinEnd(t||this._redirectNavigator.url).then((function(t){return t.profile&&t.profile.sub?r.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",t.profile.sub):r.Log.info("UserManager.signinRedirectCallback: no sub"),t}))},e.prototype.signinPopup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).request_type="si:p";var e=t.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return e?(t.redirect_uri=e,t.display="popup",this._signin(t,this._popupNavigator,{startUrl:e,popupWindowFeatures:t.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:t.popupWindowTarget||this.settings.popupWindowTarget}).then((function(t){return t&&(t.profile&&t.profile.sub?r.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",t.profile.sub):r.Log.info("UserManager.signinPopup: no sub")),t}))):(r.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},e.prototype.signinPopupCallback=function(t){return this._signinCallback(t,this._popupNavigator).then((function(t){return t&&(t.profile&&t.profile.sub?r.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",t.profile.sub):r.Log.info("UserManager.signinPopupCallback: no sub")),t})).catch((function(t){r.Log.error(t.message)}))},e.prototype.signinSilent=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=Object.assign({},e),this._loadUser().then((function(n){return n&&n.refresh_token?(e.refresh_token=n.refresh_token,t._useRefreshToken(e)):(e.request_type="si:s",e.id_token_hint=e.id_token_hint||t.settings.includeIdTokenInSilentRenew&&n&&n.id_token,n&&t._settings.validateSubOnSilentRenew&&(r.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",n.profile.sub),e.current_sub=n.profile.sub),t._signinSilentIframe(e))}))},e.prototype._useRefreshToken=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._tokenClient.exchangeRefreshToken(e).then((function(e){return e?e.access_token?t._loadUser().then((function(n){if(n){var i=Promise.resolve();return e.id_token&&(i=t._validateIdTokenFromTokenRefreshToken(n.profile,e.id_token)),i.then((function(){return r.Log.debug("UserManager._useRefreshToken: refresh token response success"),n.id_token=e.id_token||n.id_token,n.access_token=e.access_token,n.refresh_token=e.refresh_token||n.refresh_token,n.expires_in=e.expires_in,t.storeUser(n).then((function(){return t._events.load(n),n}))}))}return null})):(r.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(r.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))}))},e.prototype._validateIdTokenFromTokenRefreshToken=function(t,e){var n=this;return this._metadataService.getIssuer().then((function(i){return n.settings.getEpochTime().then((function(s){return n._joseUtil.validateJwtAttributes(e,i,n._settings.client_id,n._settings.clockSkew,s).then((function(e){return e?e.sub!==t.sub?(r.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):e.auth_time&&e.auth_time!==t.auth_time?(r.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):e.azp&&e.azp!==t.azp?(r.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!e.azp&&t.azp?(r.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(r.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))}))}))}))},e.prototype._signinSilentIframe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return e?(t.redirect_uri=e,t.prompt=t.prompt||"none",this._signin(t,this._iframeNavigator,{startUrl:e,silentRequestTimeout:t.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(t){return t&&(t.profile&&t.profile.sub?r.Log.info("UserManager.signinSilent: successful, signed in sub: ",t.profile.sub):r.Log.info("UserManager.signinSilent: no sub")),t}))):(r.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},e.prototype.signinSilentCallback=function(t){return this._signinCallback(t,this._iframeNavigator).then((function(t){return t&&(t.profile&&t.profile.sub?r.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",t.profile.sub):r.Log.info("UserManager.signinSilentCallback: no sub")),t}))},e.prototype.signinCallback=function(t){var e=this;return this.readSigninResponseState(t).then((function(n){var i=n.state;return n.response,"si:r"===i.request_type?e.signinRedirectCallback(t):"si:p"===i.request_type?e.signinPopupCallback(t):"si:s"===i.request_type?e.signinSilentCallback(t):Promise.reject(new Error("invalid response_type in state"))}))},e.prototype.signoutCallback=function(t,e){var n=this;return this.readSignoutResponseState(t).then((function(i){var r=i.state,s=i.response;return r?"so:r"===r.request_type?n.signoutRedirectCallback(t):"so:p"===r.request_type?n.signoutPopupCallback(t,e):Promise.reject(new Error("invalid response_type in state")):s}))},e.prototype.querySessionStatus=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="si:s";var n=e.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return n?(e.redirect_uri=n,e.prompt="none",e.response_type=e.response_type||this.settings.query_status_response_type,e.scope=e.scope||"openid",e.skipUserInfo=!0,this._signinStart(e,this._iframeNavigator,{startUrl:n,silentRequestTimeout:e.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(e){return t.processSigninResponse(e.url).then((function(t){if(r.Log.debug("UserManager.querySessionStatus: got signin response"),t.session_state&&t.profile.sub)return r.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",t.profile.sub),{session_state:t.session_state,sub:t.profile.sub,sid:t.profile.sid};r.Log.info("querySessionStatus successful, user not authenticated")})).catch((function(e){if(e.session_state&&t.settings.monitorAnonymousSession&&("login_required"==e.message||"consent_required"==e.message||"interaction_required"==e.message||"account_selection_required"==e.message))return r.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:e.session_state};throw e}))}))):(r.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},e.prototype._signin=function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signinStart(t,e,i).then((function(e){return n._signinEnd(e.url,t)}))},e.prototype._signinStart=function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.prepare(i).then((function(e){return r.Log.debug("UserManager._signinStart: got navigator window handle"),n.createSigninRequest(t).then((function(t){return r.Log.debug("UserManager._signinStart: got signin request"),i.url=t.url,i.id=t.state.id,e.navigate(i)})).catch((function(t){throw e.close&&(r.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),e.close()),t}))}))},e.prototype._signinEnd=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.processSigninResponse(t).then((function(t){r.Log.debug("UserManager._signinEnd: got signin response");var i=new a.User(t);if(n.current_sub){if(n.current_sub!==i.profile.sub)return r.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",i.profile.sub),Promise.reject(new Error("login_required"));r.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return e.storeUser(i).then((function(){return r.Log.debug("UserManager._signinEnd: user stored"),e._events.load(i),i}))}))},e.prototype._signinCallback=function(t,e){r.Log.debug("UserManager._signinCallback");var n="query"===this._settings.response_mode||!this._settings.response_mode&&h.SigninRequest.isCode(this._settings.response_type)?"?":"#";return e.callback(t,void 0,n)},e.prototype.signoutRedirect=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).request_type="so:r";var e=t.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;e&&(t.post_logout_redirect_uri=e);var n={useReplaceToNavigate:t.useReplaceToNavigate};return this._signoutStart(t,this._redirectNavigator,n).then((function(){r.Log.info("UserManager.signoutRedirect: successful")}))},e.prototype.signoutRedirectCallback=function(t){return this._signoutEnd(t||this._redirectNavigator.url).then((function(t){return r.Log.info("UserManager.signoutRedirectCallback: successful"),t}))},e.prototype.signoutPopup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).request_type="so:p";var e=t.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return t.post_logout_redirect_uri=e,t.display="popup",t.post_logout_redirect_uri&&(t.state=t.state||{}),this._signout(t,this._popupNavigator,{startUrl:e,popupWindowFeatures:t.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:t.popupWindowTarget||this.settings.popupWindowTarget}).then((function(){r.Log.info("UserManager.signoutPopup: successful")}))},e.prototype.signoutPopupCallback=function(t,e){return void 0===e&&"boolean"==typeof t&&(e=t,t=null),this._popupNavigator.callback(t,e,"?").then((function(){r.Log.info("UserManager.signoutPopupCallback: successful")}))},e.prototype._signout=function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signoutStart(t,e,i).then((function(t){return n._signoutEnd(t.url)}))},e.prototype._signoutStart=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this,n=arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.prepare(i).then((function(n){return r.Log.debug("UserManager._signoutStart: got navigator window handle"),e._loadUser().then((function(s){return r.Log.debug("UserManager._signoutStart: loaded current user from storage"),(e._settings.revokeAccessTokenOnSignout?e._revokeInternal(s):Promise.resolve()).then((function(){var o=t.id_token_hint||s&&s.id_token;return o&&(r.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),t.id_token_hint=o),e.removeUser().then((function(){return r.Log.debug("UserManager._signoutStart: user removed, creating signout request"),e.createSignoutRequest(t).then((function(t){return r.Log.debug("UserManager._signoutStart: got signout request"),i.url=t.url,t.state&&(i.id=t.state.id),n.navigate(i)}))}))}))})).catch((function(t){throw n.close&&(r.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),n.close()),t}))}))},e.prototype._signoutEnd=function(t){return this.processSignoutResponse(t).then((function(t){return r.Log.debug("UserManager._signoutEnd: got signout response"),t}))},e.prototype.revokeAccessToken=function(){var t=this;return this._loadUser().then((function(e){return t._revokeInternal(e,!0).then((function(n){if(n)return r.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),e.access_token=null,e.refresh_token=null,e.expires_at=null,e.token_type=null,t.storeUser(e).then((function(){r.Log.debug("UserManager.revokeAccessToken: user stored"),t._events.load(e)}))}))})).then((function(){r.Log.info("UserManager.revokeAccessToken: access token revoked successfully")}))},e.prototype._revokeInternal=function(t,e){var n=this;if(t){var i=t.access_token,s=t.refresh_token;return this._revokeAccessTokenInternal(i,e).then((function(t){return n._revokeRefreshTokenInternal(s,e).then((function(e){return t||e||r.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),t||e}))}))}return Promise.resolve(!1)},e.prototype._revokeAccessTokenInternal=function(t,e){return!t||t.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(t,e).then((function(){return!0}))},e.prototype._revokeRefreshTokenInternal=function(t,e){return t?this._tokenRevocationClient.revoke(t,e,"refresh_token").then((function(){return!0})):Promise.resolve(!1)},e.prototype.startSilentRenew=function(){this._silentRenewService.start()},e.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},e.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then((function(t){return t?(r.Log.debug("UserManager._loadUser: user storageString loaded"),a.User.fromStorageString(t)):(r.Log.debug("UserManager._loadUser: no user storageString"),null)}))},e.prototype.storeUser=function(t){if(t){r.Log.debug("UserManager.storeUser: storing user");var e=t.toStorageString();return this._userStore.set(this._userStoreKey,e)}return r.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},i(e,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),e}(s.OidcClient)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.UserManagerSettings=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=(n(0),n(5)),s=n(40),o=n(41),a=n(43),u=n(6),c=n(1),l=n(8);function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}e.UserManagerSettings=function(t){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.popup_redirect_uri,r=n.popup_post_logout_redirect_uri,p=n.popupWindowFeatures,f=n.popupWindowTarget,g=n.silent_redirect_uri,m=n.silentRequestTimeout,v=n.automaticSilentRenew,y=void 0!==v&&v,_=n.validateSubOnSilentRenew,w=void 0!==_&&_,b=n.includeIdTokenInSilentRenew,x=void 0===b||b,S=n.monitorSession,T=void 0===S||S,C=n.monitorAnonymousSession,E=void 0!==C&&C,A=n.checkSessionInterval,k=void 0===A?2e3:A,F=n.stopCheckSessionOnError,P=void 0===F||F,R=n.query_status_response_type,I=n.revokeAccessTokenOnSignout,D=void 0!==I&&I,O=n.accessTokenExpiringNotificationTime,M=void 0===O?60:O,N=n.redirectNavigator,L=void 0===N?new s.RedirectNavigator:N,j=n.popupNavigator,B=void 0===j?new o.PopupNavigator:j,U=n.iframeNavigator,V=void 0===U?new a.IFrameNavigator:U,H=n.userStore,q=void 0===H?new u.WebStorageStateStore({store:c.Global.sessionStorage}):H;h(this,e);var W=d(this,t.call(this,arguments[0]));return W._popup_redirect_uri=i,W._popup_post_logout_redirect_uri=r,W._popupWindowFeatures=p,W._popupWindowTarget=f,W._silent_redirect_uri=g,W._silentRequestTimeout=m,W._automaticSilentRenew=y,W._validateSubOnSilentRenew=w,W._includeIdTokenInSilentRenew=x,W._accessTokenExpiringNotificationTime=M,W._monitorSession=T,W._monitorAnonymousSession=E,W._checkSessionInterval=k,W._stopCheckSessionOnError=P,R?W._query_status_response_type=R:arguments[0]&&arguments[0].response_type?W._query_status_response_type=l.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":W._query_status_response_type="id_token",W._revokeAccessTokenOnSignout=D,W._redirectNavigator=L,W._popupNavigator=B,W._iframeNavigator=V,W._userStore=q,W}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),e}(r.OidcClientSettings)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.RedirectNavigator=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0);e.RedirectNavigator=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.prepare=function(){return Promise.resolve(this)},t.prototype.navigate=function(t){return t&&t.url?(t.useReplaceToNavigate?window.location.replace(t.url):window.location=t.url,Promise.resolve()):(r.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},i(t,[{key:"url",get:function(){return window.location.href}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.PopupNavigator=void 0;var i=n(0),r=n(42);e.PopupNavigator=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.prepare=function(t){var e=new r.PopupWindow(t);return Promise.resolve(e)},t.prototype.callback=function(t,e,n){i.Log.debug("PopupNavigator.callback");try{return r.PopupWindow.notifyOpener(t,e,n),Promise.resolve()}catch(t){return Promise.reject(t)}},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.PopupWindow=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),s=n(3);e.PopupWindow=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._promise=new Promise((function(t,e){n._resolve=t,n._reject=e}));var i=e.popupWindowTarget||"_blank",s=e.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;";this._popup=window.open("",i,s),this._popup&&(r.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return t.prototype.navigate=function(t){return this._popup?t&&t.url?(r.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=t.id,this._id&&(window["popupCallback_"+t.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=t.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},t.prototype._success=function(t){r.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(t)},t.prototype._error=function(t){r.Log.error("PopupWindow.error: ",t),this._cleanup(),this._reject(new Error(t))},t.prototype.close=function(){this._cleanup(!1)},t.prototype._cleanup=function(t){r.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!t&&this._popup.close(),this._popup=null},t.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},t.prototype._callback=function(t,e){this._cleanup(e),t?(r.Log.debug("PopupWindow.callback success"),this._success({url:t})):(r.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},t.notifyOpener=function(t,e,n){if(window.opener){if(t=t||window.location.href){var i=s.UrlUtility.parseUrlFragment(t,n);if(i.state){var o="popupCallback_"+i.state,a=window.opener[o];a?(r.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),a(t,e)):r.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else r.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else r.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},i(t,[{key:"promise",get:function(){return this._promise}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.IFrameNavigator=void 0;var i=n(0),r=n(44);e.IFrameNavigator=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.prepare=function(t){var e=new r.IFrameWindow(t);return Promise.resolve(e)},t.prototype.callback=function(t){i.Log.debug("IFrameNavigator.callback");try{return r.IFrameWindow.notifyParent(t),Promise.resolve()}catch(t){return Promise.reject(t)}},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.IFrameWindow=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0);e.IFrameWindow=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._promise=new Promise((function(t,e){n._resolve=t,n._reject=e})),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.width=0,this._frame.height=0,window.document.body.appendChild(this._frame)}return t.prototype.navigate=function(t){if(t&&t.url){var e=t.silentRequestTimeout||1e4;r.Log.debug("IFrameWindow.navigate: Using timeout of:",e),this._timer=window.setTimeout(this._timeout.bind(this),e),this._frame.src=t.url}else this._error("No url provided");return this.promise},t.prototype._success=function(t){this._cleanup(),r.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(t)},t.prototype._error=function(t){this._cleanup(),r.Log.error(t),this._reject(new Error(t))},t.prototype.close=function(){this._cleanup()},t.prototype._cleanup=function(){this._frame&&(r.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},t.prototype._timeout=function(){r.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},t.prototype._message=function(t){if(r.Log.debug("IFrameWindow.message"),this._timer&&t.origin===this._origin&&t.source===this._frame.contentWindow&&"string"==typeof t.data&&(t.data.startsWith("http://")||t.data.startsWith("https://"))){var e=t.data;e?this._success({url:e}):this._error("Invalid response from frame")}},t.notifyParent=function(t){r.Log.debug("IFrameWindow.notifyParent"),(t=t||window.location.href)&&(r.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(t,location.protocol+"//"+location.host))},i(t,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.UserManagerEvents=void 0;var i=n(0),r=n(16),s=n(17);e.UserManagerEvents=function(t){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n));return i._userLoaded=new s.Event("User loaded"),i._userUnloaded=new s.Event("User unloaded"),i._silentRenewError=new s.Event("Silent renew error"),i._userSignedIn=new s.Event("User signed in"),i._userSignedOut=new s.Event("User signed out"),i._userSessionChanged=new s.Event("User session changed"),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.load=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i.Log.debug("UserManagerEvents.load"),t.prototype.load.call(this,e),n&&this._userLoaded.raise(e)},e.prototype.unload=function(){i.Log.debug("UserManagerEvents.unload"),t.prototype.unload.call(this),this._userUnloaded.raise()},e.prototype.addUserLoaded=function(t){this._userLoaded.addHandler(t)},e.prototype.removeUserLoaded=function(t){this._userLoaded.removeHandler(t)},e.prototype.addUserUnloaded=function(t){this._userUnloaded.addHandler(t)},e.prototype.removeUserUnloaded=function(t){this._userUnloaded.removeHandler(t)},e.prototype.addSilentRenewError=function(t){this._silentRenewError.addHandler(t)},e.prototype.removeSilentRenewError=function(t){this._silentRenewError.removeHandler(t)},e.prototype._raiseSilentRenewError=function(t){i.Log.debug("UserManagerEvents._raiseSilentRenewError",t.message),this._silentRenewError.raise(t)},e.prototype.addUserSignedIn=function(t){this._userSignedIn.addHandler(t)},e.prototype.removeUserSignedIn=function(t){this._userSignedIn.removeHandler(t)},e.prototype._raiseUserSignedIn=function(){i.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},e.prototype.addUserSignedOut=function(t){this._userSignedOut.addHandler(t)},e.prototype.removeUserSignedOut=function(t){this._userSignedOut.removeHandler(t)},e.prototype._raiseUserSignedOut=function(){i.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},e.prototype.addUserSessionChanged=function(t){this._userSessionChanged.addHandler(t)},e.prototype.removeUserSessionChanged=function(t){this._userSessionChanged.removeHandler(t)},e.prototype._raiseUserSessionChanged=function(){i.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},e}(r.AccessTokenEvents)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.Timer=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),s=n(1),o=n(17);function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}e.Timer=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.Global.timer,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;a(this,e);var o=u(this,t.call(this,n));return o._timer=i,o._nowFunc=r||function(){return Date.now()/1e3},o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.init=function(t){t<=0&&(t=1),t=parseInt(t);var e=this.now+t;if(this.expiration===e&&this._timerHandle)r.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),r.Log.debug("Timer.init timer "+this._name+" for duration:",t),this._expiration=e;var n=5;t<n&&(n=t),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*n)}},e.prototype.cancel=function(){this._timerHandle&&(r.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},e.prototype._callback=function(){var e=this._expiration-this.now;r.Log.debug("Timer.callback; "+this._name+" timer expires in:",e),this._expiration<=this.now&&(this.cancel(),t.prototype.raise.call(this))},i(e,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),e}(o.Event)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SilentRenewService=void 0;var i=n(0);e.SilentRenewService=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._userManager=e}return t.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then((function(t){})).catch((function(t){i.Log.error("SilentRenewService.start: Error from getUser:",t.message)})))},t.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},t.prototype._tokenExpiring=function(){var t=this;this._userManager.signinSilent().then((function(t){i.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")}),(function(e){i.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",e.message),t._userManager.events._raiseSilentRenewError(e)}))},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.CordovaPopupNavigator=void 0;var i=n(21);e.CordovaPopupNavigator=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.prepare=function(t){var e=new i.CordovaPopupWindow(t);return Promise.resolve(e)},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.CordovaIFrameNavigator=void 0;var i=n(21);e.CordovaIFrameNavigator=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.prepare=function(t){t.popupWindowFeatures="hidden=yes";var e=new i.CordovaPopupWindow(t);return Promise.resolve(e)},t}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.Version="1.11.5"}])},a=o();class c{constructor(){this._initialized=!1,this._stackHost="vertx.cloud",this.watchSession=t=>{const e=this;this._assertInitialized("watchSession"),"function"!=typeof t&&(t=this._defaultSessionExpiredCallback);let n=this;setInterval((function(){try{return console.log("[VERTX:Auth] Checking session state..."),Promise.resolve(n._userManager.getUser()).then((function(n){e.isUserExpired(n)&&t(e,n)}))}catch(t){return Promise.reject(t)}}),1e4)},this._defaultSessionExpiredCallback=()=>{console.warn("[VERTX:Auth] Session expired, invoking silent sign in.\nYou can override this behaviour by passing a callback to 'watchSession'"),this.ensureSignedInAsync()}}initAsync(t){try{var e;const n=this;function i(){n._initialized=!0}const r=Object.assign({vertxStackHost:"vertx.cloud",scopes:["openid","profile","api_vertex_core"]},t);n._stackHost=r.vertxStackHost,n._userManager=new(0,a.UserManager)({client_id:r.clientId,authority:n.IdentityServerUrl,redirect_uri:r.redirectUri,post_logout_redirect_uri:r.redirectUri,response_type:"code",scope:((null==(e=r.scopes)?void 0:e.slice())||[]).join(" "),automaticSilentRenew:!1,monitorSession:!1,revokeAccessTokenOnSignout:!0}),n._userManager.clearStaleState();const s=function(){if(n._shouldHandleCallback()){function t(){n._clearOauthUrlParams()}console.log("[VERTX Auth] Handling PKCE Code from URL...");const e=u((function(){return Promise.resolve(n._userManager.signinRedirectCallback()).then((function(){console.log("[VERTX Auth] Successfully completed PKCE sign in")}))}),(function(t){const e=location.search;console.warn("[VERTX Auth] PKCE Auth Failed.",{urlParams:e,error:t})}));return e&&e.then?e.then(t):t()}}();return Promise.resolve(s&&s.then?s.then(i):i())}catch(o){return Promise.reject(o)}}get IdentityServerUrl(){return`https://${this._stackHost}/identity`}get VertexBase(){return`https://${this._stackHost}`}getToken(t){try{let e;const n=this;return n._assertInitialized("getToken"),Promise.resolve(u((function(){const i=function(){if(t.startsWith(n.VertexBase))return Promise.resolve(n.getUserAsync()).then((function(t){return e=1,(null==t?void 0:t.access_token)||null}))}();return i&&i.then?i.then((function(t){return e?t:null})):e?i:null}),(function(){return null})))}catch(t){return Promise.reject(t)}}getUserManager(){return this._assertInitialized("getUserManager"),this._userManager}ensureSignedInAsync(){try{const t=this;return t._assertInitialized("ensureSignedInAsync"),Promise.resolve(t._userManager.getUser()).then((function(e){return!t.isUserExpired(e)||(t._userManager.signinRedirect({state:t.createSigninState()}),!1)}))}catch(t){return Promise.reject(t)}}redirectToSignIn(t){return t=Object.assign({},t||{}),this._assertInitialized("redirectToSignIn"),this._userManager.signinRedirect({state:this.createSigninState(),prompt:this._promptModeForOption(t.mode)}),new Promise((t=>{}))}redirectToSignOut(t){try{const e=this;return t=Object.assign({},t||{}),e._assertInitialized("redirectToSignOut"),Promise.resolve(e._userManager.getUser()).then((function(n){return function(){if(t.signoutVertex){const t=n&&n.id_token;return Promise.resolve(e._userManager.signoutRedirect({state:e.createSigninState(),id_token_hint:t})).then((function(){return new Promise((t=>{}))}))}return Promise.resolve(e._userManager.revokeAccessToken()).then((function(){return Promise.resolve(e._userManager.removeUser()).then((function(){}))}))}()}))}catch(t){return Promise.reject(t)}}getUserAsync(){return this._assertInitialized("getUserAsync"),this._userManager.getUser()}isUserExpired(t){return!t||t.expired||t.expires_in<300}_promptModeForOption(t){if(t&&"normal"!==t)return"prompt"===t?"login":"silent"===t?"none":void 0}createSigninState(){let t=`${location.pathname}${location.search}${location.hash}`;return JSON.stringify({appUri:t})}processSigninState(t){try{let e=JSON.parse(t);if(!e||!e.appUri||"string"!=typeof e.appUri)throw new Error("Invalid State");if(!1===e.appUri.startsWith("/"))throw new Error("Invalid State");location.href=e.appUri}catch{throw new Error("Invalid State")}}_assertInitialized(t){if(!this._initialized)throw new l(`${t} was called before VertexAuth was initialized.\nawait initAsync before using any other methods on VertexAuth.`)}_shouldHandleCallback(){const t=-1!==location.search.indexOf("state="),e=-1!==location.search.indexOf("code="),n=-1!==location.search.indexOf("error=");return t&&(e||n)}_clearOauthUrlParams(){const t=new URLSearchParams(location.search);t.delete("code"),t.delete("scope"),t.delete("state"),t.delete("session_state"),t.delete("error");const e=t.toString(),n=`${location.pathname}${e?"?"+e:""}${location.hash}`;history.pushState(null,document.title,n)}}class l extends Error{constructor(t){super(`[@vertx/auth] ${t}`)}}class h extends Error{constructor(t,e,n,i,r){super(t),this.name="[[@vertx/jsx]] JSXError",this.inner=e,this.tag=n,this.props=i,this.children=r}}function d(t,e){const n=[].slice.call(arguments,2).reduce(((t,e)=>t.concat(e)),[]),i=n.map(f);if("string"==typeof t)return p(t,e,i);const r=Object.assign(new t,e);return r.render(i)}function p(t,e,n){try{e=e||{};const i=document.createElement(t);return Object.getOwnPropertyNames(e).forEach((t=>{t.startsWith("on")?i.addEventListener(t.substr(2),e[t].bind(null)):i.setAttribute(t,e[t])})),n.forEach((t=>Array.isArray(t)?i.append(...t):i.append(t))),i}catch(i){throw console.error("[@vertex/ui] JSXError Details: ",{tagName:t,properties:e,children:n,innerError:i}),new h(`Failed to create HTML or SVG (Intrinsic) element.\nThe name '${t}' may not be a valid HTML or SVG tag, or one or more of the properties may be invalid.\nSee the developer console for more details.`,i,t,e,n)}}function f(t){if(t instanceof Element||"string"==typeof t)return t;if("render"in t)return t.render([]);throw new h("Unsupported Child in JSX element",null,null,null,[t])}var g={};!function(t,e,n,i){function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var s=r(e),o=r(n),a=r(i),u=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},c=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},l=function(t,e){return{startTime:e,type:"setValue",value:t}},h=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},d=function(t,e,n){var i=n.startTime,r=n.target,s=n.timeConstant;return r+(e-r)*Math.exp((i-t)/s)},p=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},g=function(t){return p(t)||f(t)},m=function(t){return"setValue"===t.type},v=function(t){return"setValueCurve"===t.type},y=function t(e,n,i,r){var s=e[n];return void 0===s?r:g(s)||m(s)?s.value:v(s)?s.values[s.values.length-1]:d(i,t(e,n-1,s.startTime,r),s)},_=function(t,e,n,i,r){return void 0===n?[i.insertTime,r]:g(n)?[n.endTime,n.value]:m(n)?[n.startTime,n.value]:v(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,y(t,e-1,n.startTime,r)]},w=function(t){return"cancelAndHold"===t.type},b=function(t){return"cancelScheduledValues"===t.type},x=function(t){return w(t)||b(t)?t.cancelTime:p(t)||f(t)?t.endTime:t.startTime},S=function(t,e,n,i){var r=i.endTime,s=i.value;return n===s?s:0<n&&0<s||n<0&&s<0?n*Math.pow(s/n,(t-e)/(r-e)):0},T=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},C=function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},E=function(t,e){var n=e.duration,i=e.startTime,r=e.values,s=(t-i)/n*(r.length-1);return C(r,s)},A=function(t){return"setTarget"===t.type},k=function(t){function e(t){o.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return a.default(e,[{key:t,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=x(t);if(w(t)||b(t)){var n=this._automationEvents.findIndex((function(n){return b(t)&&v(n)?n.startTime+n.duration>=e:x(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),w(t)){var r=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&g(i)){if(A(r))throw new Error("The internal list is malformed.");var s=v(r)?r.startTime+r.duration:x(r),o=v(r)?r.values[r.values.length-1]:r.value,a=p(i)?S(e,s,o,i):T(e,s,o,i),d=p(i)?u(a,e,this._currenTime):c(a,e,this._currenTime);this._automationEvents.push(d)}void 0!==r&&A(r)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==r&&v(r)&&r.startTime+r.duration>e&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),r.startTime,e-r.startTime))}}else{var m=this._automationEvents.findIndex((function(t){return x(t)>e})),y=-1===m?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[m-1];if(void 0!==y&&v(y)&&x(y)+y.duration>e)return!1;var _=p(t)?u(t.value,t.endTime,this._currenTime):f(t)?c(t.value,e,this._currenTime):t;if(-1===m)this._automationEvents.push(_);else{if(v(t)&&e+t.duration>x(this._automationEvents[m]))return!1;this._automationEvents.splice(m,0,_)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return x(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];A(i)&&n.unshift(l(y(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents.findIndex((function(e){return x(e)>t})),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,r=this._automationEvents[i];if(void 0!==r&&A(r)&&(void 0===n||!g(n)||n.insertTime>t))return d(t,y(this._automationEvents,i-1,r.startTime,this._defaultValue),r);if(void 0!==r&&m(r)&&(void 0===n||!g(n)))return r.value;if(void 0!==r&&v(r)&&(void 0===n||!g(n)||r.startTime+r.duration>t))return t<r.startTime+r.duration?E(t,r):r.values[r.values.length-1];if(void 0!==r&&g(r)&&(void 0===n||!g(n)))return r.value;if(void 0!==n&&p(n)){var o=_(this._automationEvents,i,r,n,this._defaultValue),a=s.default(o,2),u=a[0],c=a[1];return S(t,u,c,n)}if(void 0!==n&&f(n)){var l=_(this._automationEvents,i,r,n,this._defaultValue),h=s.default(l,2),w=h[0],b=h[1];return T(t,w,b,n)}return this._defaultValue}}]),e}(Symbol.iterator),F=function(t){return{cancelTime:t,type:"cancelAndHold"}},P=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},R=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},I=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},D=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=k,t.createCancelAndHoldAutomationEvent=F,t.createCancelScheduledValuesAutomationEvent=P,t.createExponentialRampToValueAutomationEvent=R,t.createLinearRampToValueAutomationEvent=I,t.createSetTargetAutomationEvent=D,t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=h,Object.defineProperty(t,"__esModule",{value:!0})}(g,s("02Ztr"),s("fu0YK"),s("lR7jo"));const m=new WeakSet,v=new WeakMap,y=new WeakMap,_=new WeakMap,w=new WeakMap,b=new WeakMap,x=new WeakMap,S=new WeakMap,T=new WeakMap,C=new WeakMap,E={construct:()=>E},A=t=>{try{new new Proxy(t,E)}catch{return!1}return!0},k=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,F=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),r=i.match(k);for(;null!==r;){const t=r[1].slice(1,-1),s=r[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(s),i=i.slice(r[0].length).replace(/^[\s]+/,""),r=i.match(k)}return[n.join(";"),i]},P=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},R=t=>{if(!A(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},I=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},D=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[i]=n;return t.delete(i),i},O=(t,e,n,i)=>{const r=I(t,e),s=D(r,(t=>t[0]===n&&t[1]===i));return 0===r.size&&t.delete(e),s},M=t=>I(x,t),N=t=>{if(m.has(t))throw new Error("The AudioNode is already stored.");m.add(t),M(t).forEach((t=>t(!0)))},L=t=>"port"in t,j=t=>{if(!m.has(t))throw new Error("The AudioNode is not stored.");m.delete(t),M(t).forEach((t=>t(!1)))},B=(t,e)=>{!L(t)&&e.every((t=>0===t.size))&&j(t)},U={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},V=(t,e)=>t.context===e,H=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},q=()=>new DOMException("","IndexSizeError"),W=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw q();throw t}})},K={numberOfChannels:1},z=t=>m.has(t),J={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},G=t=>"playbackRate"in t,Y=t=>"frequency"in t&&"gain"in t,$=t=>"offset"in t,X=t=>!("frequency"in t)&&"gain"in t,Z=t=>"detune"in t&&"frequency"in t,Q=t=>"pan"in t,tt=t=>I(v,t),et=t=>I(_,t),nt=(t,e)=>{const{activeInputs:n}=tt(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||nt(n,[...e,t])}))));const i=G(t)?[t.playbackRate]:L(t)?Array.from(t.parameters.values()):Y(t)?[t.Q,t.detune,t.frequency,t.gain]:$(t)?[t.offset]:X(t)?[t.gain]:Z(t)?[t.detune,t.frequency]:Q(t)?[t.pan]:[];for(const t of i){const n=et(t);void 0!==n&&n.activeInputs.forEach((([t])=>nt(t,e)))}z(t)&&j(t)},it=t=>{nt(t.destination,[])},rt=t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t),st=t=>"context"in t,ot=t=>st(t[0]),at=(t,e,n,i)=>{for(const e of t)if(n(e)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},ut=(t,e,[n,i],r)=>{at(t,[e,n,i],(t=>t[0]===e&&t[1]===n),r)},ct=(t,[e,n,i],r)=>{const s=t.get(e);void 0===s?t.set(e,new Set([[n,i]])):at(s,[n,i],(t=>t[0]===n),r)},lt=t=>"inputs"in t,ht=(t,e,n,i)=>{if(lt(e)){const r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},dt=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},pt=(t,e,n)=>D(t,(t=>t[0]===e&&t[1]===n)),ft=(t,e)=>{if(!M(t).delete(e))throw new Error("Missing the expected event listener.")},gt=(t,e,n)=>{const i=I(t,e),r=D(i,(t=>t[0]===n));return 0===i.size&&t.delete(e),r},mt=(t,e,n,i)=>{lt(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},vt=t=>I(y,t),yt=t=>I(w,t),_t=t=>S.has(t),wt=t=>!m.has(t),bt=(t,e)=>new Promise((n=>{if(null!==e)n(!0);else{const e=t.createScriptProcessor(256,1,1),i=t.createGain(),r=t.createBuffer(1,2,44100),s=r.getChannelData(0);s[0]=1,s[1]=1;const o=t.createBufferSource();o.buffer=r,o.loop=!0,o.connect(e).connect(t.destination),o.connect(i),o.disconnect(i),e.onaudioprocess=i=>{const r=i.inputBuffer.getChannelData(0);Array.prototype.some.call(r,(t=>1===t))?n(!0):n(!1),o.stop(),e.onaudioprocess=null,o.disconnect(e),e.disconnect(t.destination)},o.start()}})),xt=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},St=t=>"context"in t,Tt=t=>{const e=new Map;var n,i;t.connect=(n=t.connect.bind(t),(t,i=0,r=0)=>{const s=St(t)?n(t,i,r):n(t,i),o=e.get(t);return void 0===o?e.set(t,[{input:r,output:i}]):o.every((t=>t.input!==r||t.output!==i))&&o.push({input:r,output:i}),s}),t.disconnect=(i=t.disconnect,(n,r,s)=>{if(i.apply(t),void 0===n)e.clear();else if("number"==typeof n)for(const[t,i]of e){const r=i.filter((t=>t.output!==n));0===r.length?e.delete(t):e.set(t,r)}else if(e.has(n))if(void 0===r)e.delete(n);else{const t=e.get(n);if(void 0!==t){const i=t.filter((t=>t.output!==r&&(t.input!==s||void 0===s)));0===i.length?e.delete(n):e.set(n,i)}}for(const[n,i]of e)i.forEach((e=>{St(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})},Ct=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=et(e),{outputs:o}=tt(t),a=M(t),u=o=>{const a=vt(t),u=yt(e);if(o){const e=gt(s,t,n);ut(r,t,e,!1),i||_t(t)||a.connect(u,n)}else{const e=pt(r,t,n);ct(s,e,!1),i||_t(t)||a.disconnect(u,n)}};return!!at(o,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(u),z(t)?ut(r,t,[n,u],!0):ct(s,[t,n,u],!0),!0)},Et=(t,e,n,i,r)=>{const[s,o]=((t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=tt(e),o=dt(r[i],t,n);if(null===o)return[O(s,t,n,i)[2],!1];return[o[2],!0]})(t,n,i,r);if(null!==s&&(ft(t,s),!o||e||_t(t)||mt(vt(t),vt(n),i,r)),z(n)){const{activeInputs:t}=tt(n);B(n,t)}},At=(t,e,n,i)=>{const[r,s]=((t,e,n)=>{const{activeInputs:i,passiveInputs:r}=et(e),s=dt(i,t,n);if(null===s)return[gt(r,t,n)[1],!1];return[s[2],!0]})(t,n,i);null!==r&&(ft(t,r),!s||e||_t(t)||vt(t).disconnect(yt(n),i))};class kt{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,i)=>t.call(e,n,i,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const Ft={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function Pt(t,e,n,i,r){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{const s=t.getChannelData(i);if(0===e[n].byteLength)e[n]=s.slice(r,r+128);else{const t=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const Rt=(t,e,n,i,r)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,r):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],r)},It=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const t=[],r="number"==typeof e?e:e[i];for(let e=0;e<r;e+=1)t.push(new Float32Array(128));n.push(t)}return n},Dt=(t,e)=>{const n=I(C,t),i=vt(e);return I(n,i)},Ot=async(t,e,n,i,r,s,o)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,u=i.channelCount*i.numberOfInputs,c=r.reduce(((t,e)=>t+e),0),l=0===c?null:n.createBuffer(c,a,n.sampleRate);if(void 0===s)throw new Error("Missing the processor constructor.");const h=tt(t),d=await Dt(n,t),p=It(i.numberOfInputs,i.channelCount),f=It(i.numberOfOutputs,r),g=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let c=0;c<a;c+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)Pt(e,p[t],n,n,c);void 0!==s.parameterDescriptors&&null!==e&&s.parameterDescriptors.forEach((({name:t},n)=>{Pt(e,g,t,u+n,c)}));for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<r[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=p.map(((t,e)=>0===h.activeInputs[e].size?[]:t)),e=o(c/n.sampleRate,n.sampleRate,(()=>d.process(t,f,g)));if(null!==l)for(let t=0,e=0;t<i.numberOfOutputs;t+=1){for(let n=0;n<r[t];n+=1)Rt(l,f[t],n,e+n,c);e+=r[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return l},Mt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Nt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Lt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},jt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Bt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ut=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise((i=>{const r=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>r();try{e.postMessage(t,[t])}finally{r()}}))},Vt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ht=t=>"delayTime"in t,qt=(t,e,n)=>{const i=e[n];if(void 0===i)throw t();return i},Wt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Kt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},zt=()=>new DOMException("","InvalidStateError"),Jt=()=>new DOMException("","InvalidAccessError"),Gt=t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw Jt();return e.call(t,n,i,r)})},Yt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},$t=(t,e,n,i,r,s,o,a,u,c,l)=>{const h=c.length;let d=a;for(let a=0;a<h;a+=1){let h=n[0]*c[a];for(let e=1;e<r;e+=1){const i=d-e&u-1;h+=n[e]*s[i],h-=t[e]*o[i]}for(let t=r;t<i;t+=1)h+=n[t]*s[d-t&u-1];for(let n=r;n<e;n+=1)h-=t[n]*o[d-n&u-1];s[d]=c[a],o[d]=h,d=d+1&u-1,l[a]=h}return d},Xt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Zt=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},Qt={numberOfChannels:1},te=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},ee=(t,e)=>{te(t,e,"channelCount"),te(t,e,"channelCountMode"),te(t,e,"channelInterpretation")},ne=t=>"function"==typeof t.getFloatTimeDomainData,ie=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},re=t=>{t.start=(e=>{let n=!1;return(i=0,r=0,s)=>{if(n)throw zt();e.call(t,i,r,s),n=!0}})(t.start)},se=t=>{var e;t.start=(e=t.start,(n=0,i=0,r)=>{if("number"==typeof r&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})},oe=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},ae=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},ue=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),ce=t=>new Promise(((e,n)=>{const{port1:i,port2:r}=new MessageChannel;i.onmessage=({data:t})=>{i.close(),r.close(),e(t)},i.onmessageerror=({data:t})=>{i.close(),r.close(),n(t)},r.postMessage(t)})),le=async(t,e)=>new t(await ce(e)),he=(t,e,n,i)=>{let r=C.get(t);void 0===r&&(r=new WeakMap,C.set(t,r));const s=le(n,i);return r.set(e,s),s},de=(t,e)=>{const n=t.createBiquadFilter();return ee(n,e),ie(n,e,"Q"),ie(n,e,"detune"),ie(n,e,"frequency"),ie(n,e,"gain"),te(n,e,"type"),n},pe=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw zt()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw zt()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw zt()}})},fe=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return ee(n,e),pe(n),n},ge=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),me=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return ee(n,e),ie(n,e,"delayTime"),n},ve=(t,e)=>{const n=t.createGain();return ee(n,e),ie(n,e,"gain"),n};function ye(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function _e(t,e){let n=[0,0];for(let s=t.length-1;s>=0;s-=1)r=e,n=[(i=n)[0]*r[0]-i[1]*r[1],i[0]*r[1]+i[1]*r[0]],n[0]+=t[s];var i,r;return n}const we=(t,e,n,i)=>t.createScriptProcessor(e,n,i),be=()=>new DOMException("","NotSupportedError"),xe={numberOfChannels:1},Se={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Te={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Ce={disableNormalization:!1},Ee={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Ae=()=>new DOMException("","UnknownError"),ke={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Fe=(t,e,n)=>void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),Pe=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},Re=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:s,set:o}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(o)})},Ie=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;Ie(t,e,n+1e-7)}},De=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},Oe=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},Me=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Ne=(t,e)=>{const n=e.createGain();t.connect(n);const i=(r=t.disconnect,()=>{r.call(t,n),t.removeEventListener("ended",i)});var r;t.addEventListener("ended",i),ge(t,n),t.stop=(e=>{let i=!1;return(r=0)=>{if(i)try{e.call(t,r)}catch{n.gain.setValueAtTime(0,r)}else e.call(t,r),i=!0}})(t.stop)},Le=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},je=(Be=at,(t,e,[n,i,r],s)=>{Be(t[i],[e,n,r],(t=>t[0]===e&&t[1]===n),s)});var Be;const Ue=(t=>(e,n,[i,r,s],o)=>{const a=e.get(i);void 0===a?e.set(i,new Set([[r,n,s]])):t(a,[r,n,s],(t=>t[0]===r&&t[1]===n),o)})(at),Ve=(He=D,(t,e,n,i)=>He(t[i],(t=>t[0]===e&&t[1]===n)));var He;const qe=new WeakMap,We=(Ke=qe,t=>{var e;return null!==(e=Ke.get(t))&&void 0!==e?e:0});var Ke;const ze=(Je=new Map,Ge=new WeakMap,(t,e)=>{const n=Ge.get(t);if(void 0!==n)return n;const i=Je.get(t);if(void 0!==i)return i;try{const n=e();return n instanceof Promise?(Je.set(t,n),n.catch((()=>!1)).then((e=>(Je.delete(t),Ge.set(t,e),e)))):(Ge.set(t,n),n)}catch{return Ge.set(t,!1),!1}});var Je,Ge;const Ye="undefined"==typeof window?null:window,$e=(Xe=ze,Ze=q,(t,e)=>{const n=t.createAnalyser();if(ee(n,e),!(e.maxDecibels>e.minDecibels))throw Ze();return te(n,e,"fftSize"),te(n,e,"maxDecibels"),te(n,e,"minDecibels"),te(n,e,"smoothingTimeConstant"),Xe(ne,(()=>ne(n)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=.0078125*(n[t]-128);return e}})(n),n});var Xe,Ze;const Qe=(tn=tt,t=>{const e=tn(t);if(null===e.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer});var tn;const en=((t,e,n)=>async(i,r,s)=>{const o=t(i);await Promise.all(o.activeInputs.map(((t,o)=>Array.from(t).map((async([t,a])=>{const u=e(t),c=await u.render(t,r),l=i.context.destination;n(t)||i===l&&n(i)||c.connect(s,a,o)})))).reduce(((t,e)=>[...t,...e]),[]))})(tt,Qe,_t),nn=(rn=$e,sn=vt,on=en,()=>{const t=new WeakMap;return{render(e,n){const i=t.get(n);return void 0!==i?Promise.resolve(i):(async(e,n)=>{let i=sn(e);if(!V(i,n)){const t={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,fftSize:i.fftSize,maxDecibels:i.maxDecibels,minDecibels:i.minDecibels,smoothingTimeConstant:i.smoothingTimeConstant};i=rn(n,t)}return t.set(n,i),await on(e,n,i),i})(e,n)}}});var rn,sn,on;const an=(un=b,t=>{const e=un.get(t);if(void 0===e)throw zt();return e});var un;const cn=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(Ye),ln=(hn=cn,t=>null!==hn&&t instanceof hn);var hn;const dn=new WeakMap,pn=(fn=Le,class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,e,n){if(null!==e){let i=this._listeners.get(e);void 0===i&&(i=fn(this,e),"function"==typeof e&&this._listeners.set(e,i)),this._nativeEventTarget.addEventListener(t,i,n)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}});var fn;const gn=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(Ye),mn=(vn=gn,t=>null!==vn&&t instanceof vn);var vn;const yn=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(Ye),_n=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(Ye),wn=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(Ye),bn=((t,e,n,i,r,s,o,a,u,c,l,h,d,p,f,g)=>class extends c{constructor(e,i,r,s){super(r),this._context=e,this._nativeAudioNode=r;const o=l(e);h(o)&&!0!==n(bt,(()=>bt(o,g)))&&Tt(r),y.set(this,r),x.set(this,new Set),"closed"!==e.state&&i&&N(this),t(this,s,r)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();const c=l(this._context),h=f(c);if(d(t)||p(t))throw s();if(st(t)){const r=vt(t);try{const e=ht(this._nativeAudioNode,r,n,a),i=wt(this);(h||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&wt(t)&&N(t)}catch(t){if(12===t.code)throw s();throw t}if(e(this,t,n,a,h)){const e=u([this],t);xt(e,i(h))}return t}const g=yt(t);if("playbackRate"===g.name&&1024===g.maxValue)throw o();try{this._nativeAudioNode.connect(g,n),(h||wt(this))&&this._nativeAudioNode.disconnect(g,n)}catch(t){if(12===t.code)throw s();throw t}if(Ct(this,t,n,h)){const e=u([this],t);xt(e,i(h))}}disconnect(t,e,n){let i;const o=l(this._context),c=f(o);if(void 0===t)i=((t,e)=>{const n=tt(t),i=[];for(const r of n.outputs)ot(r)?Et(t,e,...r):At(t,e,...r),i.push(r[0]);return n.outputs.clear(),i})(this,c);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw r();i=((t,e,n)=>{const i=tt(t),r=[];for(const s of i.outputs)s[1]===n&&(ot(s)?Et(t,e,...s):At(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r})(this,c,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw r();if(st(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw r();if(i=((t,e,n,i,r)=>{const s=tt(t);return Array.from(s.outputs).filter((t=>!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==r&&t[2]!==r))).map((n=>(ot(n)?Et(t,e,...n):At(t,e,...n),s.outputs.delete(n),n[0])))})(this,c,t,e,n),0===i.length)throw s()}for(const t of i){const e=u([this],t);xt(e,a)}}})((xn=v,(t,e,n)=>{const i=[];for(let t=0;t<n.numberOfInputs;t+=1)i.push(new Set);xn.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,i,r,s,o,a,u,c,l,h,d)=>{const p=new WeakMap;return(f,g,m,v,y)=>{const{activeInputs:_,passiveInputs:w}=s(g),{outputs:b}=s(f),x=a(f),S=s=>{const a=u(g),c=u(f);if(s){const e=O(w,f,m,v);t(_,f,e,!1),y||h(f)||n(c,a,m,v),d(g)&&N(g)}else{const t=i(_,f,m,v);e(w,v,t,!1),y||h(f)||r(c,a,m,v);const n=o(g);if(0===n)l(g)&&B(g,_);else{const t=p.get(g);void 0!==t&&clearTimeout(t),p.set(g,setTimeout((()=>{l(g)&&B(g,_)}),1e3*n))}}};return!!c(b,[g,m,v],(t=>t[0]===g&&t[1]===m&&t[2]===v),!0)&&(x.add(S),l(f)?t(_,f,[m,v,S],!0):e(w,v,[f,m,S],!0),!0)}})(je,Ue,ht,Ve,mt,tt,We,M,vt,at,z,_t,wt),ze,((t,e,n,i,r,s)=>o=>(a,u)=>{const c=t.get(a);if(void 0===c){if(!o&&s(a)){const t=i(a),{outputs:s}=n(a);for(const n of s)if(ot(n)){const r=i(n[0]);e(t,r,n[1],n[2])}else{const e=r(n[0]);t.disconnect(e,n[1])}}t.set(a,u)}else t.set(a,c+u)})(S,mt,tt,vt,yt,z),q,Jt,be,((t,e,n,i,r,s,o,a)=>(u,c)=>{const l=e.get(u);if(void 0===l)throw new Error("Missing the expected cycle count.");const h=s(u.context),d=a(h);if(l===c){if(e.delete(u),!d&&o(u)){const e=i(u),{outputs:s}=n(u);for(const n of s)if(ot(n)){const r=i(n[0]);t(e,r,n[1],n[2])}else{const t=r(n[0]);e.connect(t,n[1])}}}else e.set(u,l-c)})(ht,S,tt,vt,yt,an,z,ln),((t,e,n)=>function i(r,s){const o=st(s)?s:n(t,s);if(Ht(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map((t=>i([...r,o],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(dn,tt,I),pn,an,mn,yn,_n,ln,wn);var xn;const Sn=((t,e,n,i,r,s)=>class extends t{constructor(t,n){const o=r(t),a={...U,...n},u=i(o,a);super(t,!1,u,s(o)?e():null),this._nativeAnalyserNode=u}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(bn,nn,q,$e,an,ln),Tn=new WeakSet,Cn=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(Ye),En=(An=new Uint32Array(1),t=>(An[0]=t,An[0]));var An;const kn=((t,e)=>n=>{n.copyFromChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const u=n.length,c=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<u&&t<l;t+=1)i[t]=c[t+o]},n.copyToChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const u=n.length,c=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<u&&t<l;t+=1)c[t+o]=i[t]}})(En,q),Fn=(Pn=En,t=>{var e,n;t.copyFromChannel=(e=t.copyFromChannel,(n,i,r=0)=>{const s=Pn(r),o=Pn(i);if(s<t.length)return e.call(t,n,o,s)}),t.copyToChannel=(n=t.copyToChannel,(e,i,r=0)=>{const s=Pn(r),o=Pn(i);if(s<t.length)return n.call(t,e,o,s)})});var Pn;const Rn=((t,e,n,i,r,s,o,a)=>{let u=null;return class c{constructor(c){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:h,sampleRate:d}={...K,...c};null===u&&(u=new r(1,1,44100));const p=null!==i&&e(s,s)?new i({length:l,numberOfChannels:h,sampleRate:d}):u.createBuffer(h,l,d);if(0===p.numberOfChannels)throw n();return"function"!=typeof p.copyFromChannel?(o(p),W(p)):e(H,(()=>H(p)))||a(p),t.add(p),p}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===c.prototype||t.has(e)}}})(Tn,ze,be,Cn,cn,(In=Cn,()=>{if(null===In)return!1;try{new In({length:1,sampleRate:44100})}catch{return!1}return!0}),kn,Fn);var In;const Dn=(On=ve,(t,e)=>{const n=On(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(n).connect(t.destination);const i=()=>{e.removeEventListener("ended",i),e.disconnect(n),n.disconnect()};e.addEventListener("ended",i)});var On;const Mn=(Nn=Qe,Ln=et,jn=_t,async(t,e,n)=>{const i=Ln(t);await Promise.all(Array.from(i.activeInputs).map((async([t,i])=>{const r=Nn(t),s=await r.render(t,e);jn(t)||s.connect(n,i)})))});var Nn,Ln,jn;const Bn=(Un=Mn,(t,e,n)=>Un(e,t,n));var Un;const Vn=((t,e,n,i,r,s,o,a,u,c,l)=>(h,d)=>{const p=h.createBufferSource();return ee(p,d),ie(p,d,"playbackRate"),te(p,d,"buffer"),te(p,d,"loop"),te(p,d,"loopEnd"),te(p,d,"loopStart"),e(n,(()=>n(h)))||re(p),e(i,(()=>i(h)))||u(p),e(r,(()=>r(h)))||c(p,h),e(s,(()=>s(h)))||se(p),e(o,(()=>o(h)))||l(p,h),e(a,(()=>a(h)))||oe(p),t(h,p),p})(Dn,ze,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),De,Oe,Me,(t=>{var e;t.start=(e=t.start,(n=0,i=0,r)=>{const s=t.buffer,o=null===s?i:Math.min(s.duration,i);null!==s&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,r)})}),(Hn=Re,(t,e)=>{const n=e.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=n),Hn(t,"buffer",(e=>()=>{const i=e.call(t);return i===n?null:i}),(e=>i=>e.call(t,null===i?n:i)))}),Ne);var Hn;const qn=((t,e)=>(n,i,r)=>(t(i).replay(r),e(i,n,r)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(et),Mn),Wn=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(u,c){const l=s.get(c);return void 0!==l?Promise.resolve(l):(async(u,c)=>{let l=n(u);const h=V(l,c);if(!h){const t={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=e(c,t),null!==o&&l.start(...o),null!==a&&l.stop(a)}return s.set(c,l),h?await t(c,u.playbackRate,l.playbackRate):await i(c,u.playbackRate,l.playbackRate),await r(u,c,l),l})(u,c)}}})(Bn,Vn,vt,qn,en),Kn=((t,e,n,i,r,s,o,a,u,c,l,h,d)=>(p,f,m,v=null,y=null)=>{const _=new(0,g.AutomationEventList)(m.defaultValue),w=f?i(_):null,b={get defaultValue(){return m.defaultValue},get maxValue(){return null===v?m.maxValue:v},get minValue(){return null===y?m.minValue:y},get value(){return m.value},set value(t){m.value=t,b.setValueAtTime(t,p.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof m.cancelAndHoldAtTime)null===w&&_.flush(p.context.currentTime),_.add(r(t)),m.cancelAndHoldAtTime(t);else{const e=Array.from(_).pop();null===w&&_.flush(p.context.currentTime),_.add(r(t));const n=Array.from(_).pop();m.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return b},cancelScheduledValues:t=>(null===w&&_.flush(p.context.currentTime),_.add(s(t)),m.cancelScheduledValues(t),b),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===w&&_.flush(p.context.currentTime),_.add(o(t,e)),m.exponentialRampToValueAtTime(t,e),b},linearRampToValueAtTime:(t,e)=>(null===w&&_.flush(p.context.currentTime),_.add(a(t,e)),m.linearRampToValueAtTime(t,e),b),setTargetAtTime:(t,e,n)=>(null===w&&_.flush(p.context.currentTime),_.add(u(t,e,n)),m.setTargetAtTime(t,e,n),b),setValueAtTime:(t,e)=>(null===w&&_.flush(p.context.currentTime),_.add(c(t,e)),m.setValueAtTime(t,e),b),setValueCurveAtTime(t,e,n){const i=t instanceof Float32Array?t:new Float32Array(t);if(null!==h&&"webkitAudioContext"===h.name){const t=e+n,r=p.context.sampleRate,s=Math.ceil(e*r),o=Math.floor(t*r),a=o-s,u=new Float32Array(a);for(let t=0;t<a;t+=1){const o=(i.length-1)/n*((s+t)/r-e),a=Math.floor(o),c=Math.ceil(o);u[t]=a===c?i[a]:(1-(o-a))*i[a]+(1-(c-o))*i[c]}null===w&&_.flush(p.context.currentTime),_.add(l(u,e,n)),m.setValueCurveAtTime(u,e,n);const c=o/r;c<t&&d(b,u[u.length-1],c),d(b,i[i.length-1],t)}else null===w&&_.flush(p.context.currentTime),_.add(l(i,e,n)),m.setValueCurveAtTime(i,e,n);return b}};return n.set(b,m),e.set(b,p),t(b,w),b})((zn=_,(t,e)=>{zn.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),dn,w,(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t)}else if("setTarget"===n.type){const{startTime:t,target:i,timeConstant:r}=n;e.setTargetAtTime(i,t,r)}else if("setValue"===n.type){const{startTime:t,value:i}=n;e.setValueAtTime(i,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:i,values:r}=n;e.setValueCurveAtTime(r,i,t)}}}})),g.createCancelAndHoldAutomationEvent,g.createCancelScheduledValuesAutomationEvent,g.createExponentialRampToValueAutomationEvent,g.createLinearRampToValueAutomationEvent,g.createSetTargetAutomationEvent,g.createSetValueAutomationEvent,g.createSetValueCurveAutomationEvent,gn,Ie);var zn;const Jn=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,i){const a=s(t),u={...J,...i},c=r(a,u),l=o(a),h=l?e():null;super(t,!1,c,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==u.buffer,this._nativeAudioBufferSourceNode=c,this._onended=null,this._playbackRate=n(this,l,c.playbackRate,34028234663852886e22,-34028234663852886e22)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){N(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),z(this)&&j(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(bn,Wn,Kn,zt,Vn,an,ln,Le),Gn=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,n){const i=s(t),u=o(i),c=r(i,n,u);super(t,!1,c,u?e(a):null),this._isNodeOfNativeOfflineAudioContext=u,this._nativeAudioDestinationNode=c}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(bn,(t=>{const e=new WeakMap;return{render(n,i){const r=e.get(i);return void 0!==r?Promise.resolve(r):(async(n,i)=>{const r=i.destination;return e.set(i,r),await t(n,i,r),r})(n,i)}}}),q,zt,((t,e)=>(n,i,r)=>{const s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch{}r&&"explicit"!==s.channelCountMode&&(s.channelCountMode="explicit"),0===s.maxChannelCount&&Object.defineProperty(s,"maxChannelCount",{value:i});const o=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e);try{s.channelCount=e}catch(t){if(e>s.maxChannelCount)throw t}})),e(o,"channelCountMode",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelCountMode=e})),e(o,"channelInterpretation",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelInterpretation=e})),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o})(ve,Re),an,ln,en),Yn=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const u=s.get(a);return void 0!==u?Promise.resolve(u):(async(o,a)=>{let u=n(o);const c=V(u,a);if(!c){const t={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=e(a,t)}return s.set(a,u),c?(await t(a,o.Q,u.Q),await t(a,o.detune,u.detune),await t(a,o.frequency,u.frequency),await t(a,o.gain,u.gain)):(await i(a,o.Q,u.Q),await i(a,o.detune,u.detune),await i(a,o.frequency,u.frequency),await i(a,o.gain,u.gain)),await r(o,a,u),u})(o,a)}}})(Bn,de,vt,qn,en),$n=(t=>(e,n)=>t.set(e,n))(qe),Xn=(Zn=bn,Qn=Kn,ti=Yn,ei=Jt,ni=de,ii=an,ri=ln,si=$n,class extends Zn{constructor(t,e){const n=ii(t),i={...Mt,...e},r=ni(n,i),s=ri(n);super(t,!1,r,s?ti():null),this._Q=Qn(this,s,r.Q,34028234663852886e22,-34028234663852886e22),this._detune=Qn(this,s,r.detune,1200*Math.log2(34028234663852886e22),-1200*Math.log2(34028234663852886e22)),this._frequency=Qn(this,s,r.frequency,t.sampleRate/2,0),this._gain=Qn(this,s,r.gain,40*Math.log10(34028234663852886e22),-34028234663852886e22),this._nativeBiquadFilterNode=r,si(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(t){if(11===t.code)throw ei();throw t}if(t.length!==e.length||e.length!==n.length)throw ei()}});var Zn,Qn,ti,ei,ni,ii,ri,si;const oi=((t,e)=>(n,i,r)=>{const s=new Set;var o,a;return n.connect=(o=n.connect,(r,a=0,u=0)=>{const c=0===s.size;if(e(r))return o.call(n,r,a,u),t(s,[r,a,u],(t=>t[0]===r&&t[1]===a&&t[2]===u),!0),c&&i(),r;o.call(n,r,a),t(s,[r,a],(t=>t[0]===r&&t[1]===a),!0),c&&i()}),n.disconnect=(a=n.disconnect,(t,i,o)=>{const u=s.size>0;if(void 0===t)a.apply(n),s.clear();else if("number"==typeof t){a.call(n,t);for(const e of s)e[1]===t&&s.delete(e)}else{e(t)?a.call(n,t,i,o):a.call(n,t,i);for(const e of s)e[0]!==t||void 0!==i&&e[1]!==i||void 0!==o&&e[2]!==o||s.delete(e)}const c=0===s.size;u&&c&&r()}),n})(at,yn),ai=(ui=zt,ci=oi,(t,e)=>{e.channelCount=1,e.channelCountMode="explicit",Object.defineProperty(e,"channelCount",{get:()=>1,set:()=>{throw ui()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:()=>{throw ui()}});const n=t.createBufferSource();ci(e,(()=>{const t=e.numberOfInputs;for(let i=0;i<t;i+=1)n.connect(e,0,i)}),(()=>n.disconnect(e)))});var ui,ci;const li=((t,e)=>(n,i)=>{const r=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,r),ee(r,i),r})(gn,ai),hi=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!V(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(li,vt,en),di=((t,e,n,i,r)=>class extends t{constructor(t,s){const o=i(t),a={...Nt,...s};super(t,!1,n(o,a),r(o)?e():null)}})(bn,hi,li,an,ln),pi=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!V(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(s,e)}return i.set(s,o),await n(r,s,o),o})(r,s)}}})(fe,vt,en),fi=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),u=s({...Lt,...o});super(t,!1,n(a,u),r(a)?e():null)}})(bn,pi,fe,an,ln,(t=>({...t,channelCount:t.numberOfOutputs}))),gi=((t,e,n,i)=>(r,{offset:s,...o})=>{const a=r.createBuffer(1,2,44100),u=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(r,{...o,gain:s}),l=a.getChannelData(0);l[0]=1,l[1]=1,u.buffer=a,u.loop=!0;const h={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(t){c.channelCount=t},get channelCountMode(){return c.channelCountMode},set channelCountMode(t){c.channelCountMode=t},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(t){c.channelInterpretation=t},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return u.onended},set onended(t){u.onended=t},addEventListener:(...t)=>u.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>u.dispatchEvent(t[0]),removeEventListener:(...t)=>u.removeEventListener(t[0],t[1],t[2]),start(t=0){u.start.call(u,t)},stop(t=0){u.stop.call(u,t)}};return t(r,u),i(ge(h,c),(()=>u.connect(c)),(()=>u.disconnect(c)))})(Dn,Vn,ve,oi),mi=((t,e,n,i,r)=>(s,o)=>{if(void 0===s.createConstantSource)return n(s,o);const a=s.createConstantSource();return ee(a,o),ie(a,o,"offset"),e(i,(()=>i(s)))||se(a),e(r,(()=>r(s)))||oe(a),t(s,a),a})(Dn,ze,gi,De,Me),vi=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(u,c){const l=s.get(c);return void 0!==l?Promise.resolve(l):(async(u,c)=>{let l=n(u);const h=V(l,c);if(!h){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=e(c,t),null!==o&&l.start(o),null!==a&&l.stop(a)}return s.set(c,l),h?await t(c,u.offset,l.offset):await i(c,u.offset,l.offset),await r(u,c,l),l})(u,c)}}})(Bn,mi,vt,qn,en),yi=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),u={...jt,...o},c=i(a,u),l=s(a),h=l?n():null;super(t,!1,c,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=c,this._offset=e(this,l,c.offset,34028234663852886e22,-34028234663852886e22),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){N(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),z(this)&&j(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(bn,Kn,vi,mi,an,ln,Le),_i=((t,e)=>(n,i)=>{const r=n.createConvolver();if(ee(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),te(r,i,"buffer"),i.channelCount>2)throw t();if(e(r,"channelCount",(t=>()=>t.call(r)),(e=>n=>{if(n>2)throw t();return e.call(r,n)})),"max"===i.channelCountMode)throw t();return e(r,"channelCountMode",(t=>()=>t.call(r)),(e=>n=>{if("max"===n)throw t();return e.call(r,n)})),r})(be,Re),wi=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!V(o,s)){const e={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(s,e)}return i.set(s,o),lt(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o})(r,s)}}})(_i,vt,en),bi=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),u={...Bt,...o},c=n(a,u);super(t,!1,c,r(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=c,null!==u.buffer&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,t.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(bn,wi,_i,an,ln,$n),xi=((t,e,n,i,r)=>s=>{const o=new WeakMap;return{render(a,u){const c=o.get(u);return void 0!==c?Promise.resolve(c):(async(a,u)=>{let c=n(a);const l=V(c,u);if(!l){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,delayTime:c.delayTime.value,maxDelayTime:s};c=e(u,t)}return o.set(u,c),l?await t(u,a.delayTime,c.delayTime):await i(u,a.delayTime,c.delayTime),await r(a,u,c),c})(a,u)}}})(Bn,me,vt,qn,en),Si=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const u=r(t),c={...Vt,...a},l=i(u,c),h=s(u);super(t,!1,l,h?n(c.maxDelayTime):null),this._delayTime=e(this,h,l.delayTime),o(this,c.maxDelayTime)}get delayTime(){return this._delayTime}})(bn,Kn,xi,me,an,ln,$n),Ti=(Ci=be,(t,e)=>{const n=t.createDynamicsCompressor();if(ee(n,e),e.channelCount>2)throw Ci();if("max"===e.channelCountMode)throw Ci();return ie(n,e,"attack"),ie(n,e,"knee"),ie(n,e,"ratio"),ie(n,e,"release"),ie(n,e,"threshold"),n});var Ci;const Ei=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const u=s.get(a);return void 0!==u?Promise.resolve(u):(async(o,a)=>{let u=n(o);const c=V(u,a);if(!c){const t={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=e(a,t)}return s.set(a,u),c?(await t(a,o.attack,u.attack),await t(a,o.knee,u.knee),await t(a,o.ratio,u.ratio),await t(a,o.release,u.release),await t(a,o.threshold,u.threshold)):(await i(a,o.attack,u.attack),await i(a,o.knee,u.knee),await i(a,o.ratio,u.ratio),await i(a,o.release,u.release),await i(a,o.threshold,u.threshold)),await r(o,a,u),u})(o,a)}}})(Bn,Ti,vt,qn,en),Ai=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,r){const u=s(t),c={...Wt,...r},l=i(u,c),h=o(u);super(t,!1,l,h?n():null),this._attack=e(this,h,l.attack),this._knee=e(this,h,l.knee),this._nativeDynamicsCompressorNode=l,this._ratio=e(this,h,l.ratio),this._release=e(this,h,l.release),this._threshold=e(this,h,l.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(bn,Kn,Ei,Ti,be,an,ln,$n),ki=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const u=s.get(a);return void 0!==u?Promise.resolve(u):(async(o,a)=>{let u=n(o);const c=V(u,a);if(!c){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=e(a,t)}return s.set(a,u),c?await t(a,o.gain,u.gain):await i(a,o.gain,u.gain),await r(o,a,u),u})(o,a)}}})(Bn,ve,vt,qn,en),Fi=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),u={...Kt,...o},c=i(a,u),l=s(a);super(t,!1,c,l?n():null),this._gain=e(this,l,c.gain,34028234663852886e22,-34028234663852886e22)}get gain(){return this._gain}})(bn,Kn,ki,ve,an,ln),Pi=((t,e,n,i)=>(r,s,{channelCount:o,channelCountMode:a,channelInterpretation:u,feedback:c,feedforward:l})=>{const h=ue(s,r.sampleRate),d=c instanceof Float64Array?c:new Float64Array(c),p=l instanceof Float64Array?l:new Float64Array(l),f=d.length,g=p.length,m=Math.min(f,g);if(0===f||f>20)throw i();if(0===d[0])throw e();if(0===g||g>20)throw i();if(0===p[0])throw e();if(1!==d[0]){for(let t=0;t<g;t+=1)p[t]/=d[0];for(let t=1;t<f;t+=1)d[t]/=d[0]}const v=n(r,h,o,o);v.channelCount=o,v.channelCountMode=a,v.channelInterpretation=u;const y=[],_=[],w=[];for(let t=0;t<o;t+=1){y.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),_.push(t),w.push(e)}v.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let t=0;t<i;t+=1){const i=e.getChannelData(t),r=n.getChannelData(t);y[t]=$t(d,f,p,g,m,_[t],w[t],y[t],32,i,r)}};const b=r.sampleRate/2;return ge({get bufferSize(){return h},get channelCount(){return v.channelCount},set channelCount(t){v.channelCount=t},get channelCountMode(){return v.channelCountMode},set channelCountMode(t){v.channelCountMode=t},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(t){v.channelInterpretation=t},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener:(...t)=>v.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>v.dispatchEvent(t[0]),getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();const r=e.length;for(let t=0;t<r;t+=1){const r=-Math.PI*(e[t]/b),s=[Math.cos(r),Math.sin(r)],o=ye(_e(p,s),_e(d,s));n[t]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),i[t]=Math.atan2(o[1],o[0])}},removeEventListener:(...t)=>v.removeEventListener(t[0],t[1],t[2])},v)})(Jt,zt,we,be),Ri=((t,e,n,i)=>r=>t(Zt,(()=>Zt(r)))?Promise.resolve(t(i,i)).then((t=>{if(!t){const t=n(r,512,0,1);r.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>r.currentTime,t.connect(r.destination)}return r.startRendering()})):new Promise((t=>{const n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(r.destination),r.startRendering()})))(ze,ve,we,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(ve,cn)),Ii=((t,e,n,i,r)=>(s,o)=>{const a=new WeakMap;let u=null;const c=async(c,l)=>{let h=null,d=e(c);const p=V(d,l);if(void 0===l.createIIRFilter?h=t(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(d=l.createIIRFilter(o,s)),a.set(l,null===h?d:h),null!==h){if(null===u){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(c.context.destination.channelCount,c.context.length,l.sampleRate);u=(async()=>{await i(c,t,t.destination);return((t,e,n,i)=>{const r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),o=r.length,a=s.length,u=Math.min(o,a);if(1!==r[0]){for(let t=0;t<o;t+=1)s[t]/=r[0];for(let t=1;t<a;t+=1)r[t]/=r[0]}const c=new Float32Array(32),l=new Float32Array(32),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let e=0;e<d;e+=1){const n=t.getChannelData(e),i=h.getChannelData(e);c.fill(0),l.fill(0),$t(r,o,s,a,u,c,l,0,32,n,i)}return h})(await r(t),l,s,o)})()}const t=await u;return h.buffer=t,h.start(0),h}return await i(c,l,d),d};return{render(t,e){const n=a.get(e);return void 0!==n?Promise.resolve(n):c(t,e)}}})(Vn,vt,cn,en,Ri);var Di;const Oi=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),u=r(a),c={...Yt,...o},l=e(a,u?null:t.baseLatency,c);super(t,!1,l,u?n(c.feedback,c.feedforward):null),Gt(l),this._nativeIIRFilterNode=l,s(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(bn,(Di=Pi,(t,e,n)=>{if(void 0===t.createIIRFilter)return Di(t,e,n);const i=t.createIIRFilter(n.feedforward,n.feedback);return ee(i,n),i}),Ii,an,ln,$n),Mi=((t,e,n,i,r,s,o,a)=>(u,c)=>{const l=c.listener,{forwardX:h,forwardY:d,forwardZ:p,positionX:f,positionY:g,positionZ:m,upX:v,upY:y,upZ:_}=void 0===l.forwardX?(()=>{const h=new Float32Array(1),d=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),p=o(c);let f=!1,g=[0,0,-1,0,1,0],m=[0,0,0];const v=()=>{if(f)return;f=!0;const t=i(c,256,9,0);t.onaudioprocess=({inputBuffer:t})=>{const e=[s(t,h,0),s(t,h,1),s(t,h,2),s(t,h,3),s(t,h,4),s(t,h,5)];e.some(((t,e)=>t!==g[e]))&&(l.setOrientation(...e),g=e);const n=[s(t,h,6),s(t,h,7),s(t,h,8)];n.some(((t,e)=>t!==m[e]))&&(l.setPosition(...n),m=n)},d.connect(t)},y=t=>e=>{e!==g[t]&&(g[t]=e,l.setOrientation(...g))},_=t=>e=>{e!==m[t]&&(m[t]=e,l.setPosition(...m))},w=(e,i,s)=>{const o=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});o.connect(d,0,e),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:()=>i});const l=t({context:u},p,o.offset,34028234663852886e22,-34028234663852886e22);var h,f,g,m,y,_,w;return a(l,"value",(t=>()=>t.call(l)),(t=>e=>{try{t.call(l,e)}catch(t){if(9!==t.code)throw t}v(),p&&s(e)})),l.cancelAndHoldAtTime=(h=l.cancelAndHoldAtTime,p?()=>{throw r()}:(...t)=>{const e=h.apply(l,t);return v(),e}),l.cancelScheduledValues=(f=l.cancelScheduledValues,p?()=>{throw r()}:(...t)=>{const e=f.apply(l,t);return v(),e}),l.exponentialRampToValueAtTime=(g=l.exponentialRampToValueAtTime,p?()=>{throw r()}:(...t)=>{const e=g.apply(l,t);return v(),e}),l.linearRampToValueAtTime=(m=l.linearRampToValueAtTime,p?()=>{throw r()}:(...t)=>{const e=m.apply(l,t);return v(),e}),l.setTargetAtTime=(y=l.setTargetAtTime,p?()=>{throw r()}:(...t)=>{const e=y.apply(l,t);return v(),e}),l.setValueAtTime=(_=l.setValueAtTime,p?()=>{throw r()}:(...t)=>{const e=_.apply(l,t);return v(),e}),l.setValueCurveAtTime=(w=l.setValueCurveAtTime,p?()=>{throw r()}:(...t)=>{const e=w.apply(l,t);return v(),e}),l};return{forwardX:w(0,0,y(0)),forwardY:w(1,0,y(1)),forwardZ:w(2,-1,y(2)),positionX:w(6,0,_(0)),positionY:w(7,0,_(1)),positionZ:w(8,0,_(2)),upX:w(3,0,y(3)),upY:w(4,1,y(4)),upZ:w(5,0,y(5))}})():l;return{get forwardX(){return h},get forwardY(){return d},get forwardZ(){return p},get positionX(){return f},get positionY(){return g},get positionZ(){return m},get upX(){return v},get upY(){return y},get upZ(){return _}}})(Kn,li,mi,we,be,Fe,ln,Re),Ni=new WeakMap,Li=((t,e,n,i,r,s)=>class extends n{constructor(n,s){super(n),this._nativeContext=n,b.set(this,n),i(n)&&r.set(n,new Set),this._destination=new t(this,s),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?s(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Gn,Mi,pn,ln,Ni,Le),ji=((t,e,n,i,r,s)=>(o,a)=>{const u=o.createOscillator();return ee(u,a),ie(u,a,"detune"),ie(u,a,"frequency"),void 0!==a.periodicWave?u.setPeriodicWave(a.periodicWave):te(u,a,"type"),e(n,(()=>n(o)))||se(u),e(i,(()=>i(o)))||s(u,o),e(r,(()=>r(o)))||oe(u),t(o,u),u})(Dn,ze,De,Oe,Me,Ne),Bi=((t,e,n,i,r)=>()=>{const s=new WeakMap;let o=null,a=null,u=null;return{set periodicWave(t){o=t},set start(t){a=t},set stop(t){u=t},render(c,l){const h=s.get(l);return void 0!==h?Promise.resolve(h):(async(c,l)=>{let h=n(c);const d=V(h,l);if(!d){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:null===o?void 0:o,type:h.type};h=e(l,t),null!==a&&h.start(a),null!==u&&h.stop(u)}return s.set(l,h),d?(await t(l,c.detune,h.detune),await t(l,c.frequency,h.frequency)):(await i(l,c.detune,h.detune),await i(l,c.frequency,h.frequency)),await r(c,l,h),h})(c,l)}}})(Bn,ji,vt,qn,en),Ui=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),u={...Se,...o},c=n(a,u),l=s(a),h=l?i():null,d=t.sampleRate/2;super(t,!1,c,h),this._detune=e(this,l,c.detune,153600,-153600),this._frequency=e(this,l,c.frequency,d,-d),this._nativeOscillatorNode=c,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==u.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=u.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){N(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),z(this)&&j(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(bn,Kn,ji,Bi,an,ln,Le),Vi=(Hi=Vn,(t,e)=>{const n=Hi(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=t.createBuffer(1,2,44100);return n.buffer=i,n.loop=!0,n.connect(e),n.start(),()=>{n.stop(),n.disconnect(e)}});var Hi;const qi=((t,e,n,i,r)=>(s,{curve:o,oversample:a,...u})=>{const c=s.createWaveShaper(),l=s.createWaveShaper();ee(c,u),ee(l,u);const h=n(s,{...u,gain:1}),d=n(s,{...u,gain:-1}),p=n(s,{...u,gain:1}),f=n(s,{...u,gain:-1});let g=null,m=!1,v=null;const y={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(t){h.channelCount=t,d.channelCount=t,c.channelCount=t,p.channelCount=t,l.channelCount=t,f.channelCount=t},get channelCountMode(){return c.channelCountMode},set channelCountMode(t){h.channelCountMode=t,d.channelCountMode=t,c.channelCountMode=t,p.channelCountMode=t,l.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t,d.channelInterpretation=t,c.channelInterpretation=t,p.channelInterpretation=t,l.channelInterpretation=t,f.channelInterpretation=t},get context(){return c.context},get curve(){return v},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)c.curve=n,l.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),i=new Float32Array(t+2-t%2);e[0]=n[0],i[0]=-n[t-1];const r=Math.ceil((t+1)/2),s=(t+1)/2-1;for(let o=1;o<r;o+=1){const a=o/r*s,u=Math.floor(a),c=Math.ceil(a);e[o]=u===c?n[u]:(1-(a-u))*n[u]+(1-(c-a))*n[c],i[o]=u===c?-n[t-1-u]:-(1-(a-u))*n[t-1-u]-(1-(c-a))*n[t-1-c]}e[r]=t%2==1?n[r-1]:(n[r-2]+n[r-1])/2,c.curve=e,l.curve=i}v=n,m&&(i(v)&&null===g?g=t(s,h):null!==g&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(t){c.oversample=t,l.oversample=t},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2])};null!==o&&(y.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==y.oversample&&(y.oversample=a);return r(ge(y,p),(()=>{h.connect(c).connect(p),h.connect(d).connect(l).connect(f).connect(p),m=!0,i(v)&&(g=t(s,h))}),(()=>{h.disconnect(c),c.disconnect(p),h.disconnect(d),d.disconnect(l),l.disconnect(f),f.disconnect(p),m=!1,null!==g&&(g(),g=null)}))})(Vi,zt,ve,Pe,oi),Wi=((t,e,n,i,r,s,o)=>(a,u)=>{const c=a.createWaveShaper();if(null!==s&&"webkitAudioContext"===s.name&&void 0===a.createGain().gain.automationRate)return n(a,u);ee(c,u);const l=null===u.curve||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(null!==l&&l.length<2)throw e();te(c,{curve:l},"curve"),te(c,u,"oversample");let h=null,d=!1;o(c,"curve",(t=>()=>t.call(c)),(e=>n=>(e.call(c,n),d&&(i(n)&&null===h?h=t(a,c):i(n)||null===h||(h(),h=null)),n)));return r(c,(()=>{d=!0,i(c.curve)&&(h=t(a,c))}),(()=>{d=!1,null!==h&&(h(),h=null)}))})(Vi,zt,qi,Pe,oi,gn,Re),Ki=((t,e,n,i,r,s,o,a,u,c)=>(l,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:p,distanceModel:f,maxDistance:g,orientationX:m,orientationY:v,orientationZ:y,panningModel:_,positionX:w,positionY:b,positionZ:x,refDistance:S,rolloffFactor:T,...C})=>{const E=l.createPanner();if(C.channelCount>2)throw o();if("max"===C.channelCountMode)throw o();ee(E,C);const A={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},k=n(l,{...A,channelInterpretation:"speakers",numberOfInputs:6}),F=i(l,{...C,gain:1}),P=i(l,{...A,gain:1}),R=i(l,{...A,gain:0}),I=i(l,{...A,gain:0}),D=i(l,{...A,gain:0}),O=i(l,{...A,gain:0}),M=i(l,{...A,gain:0}),N=r(l,256,6,1),L=s(l,{...A,curve:new Float32Array([1,1]),oversample:"none"});let j=[m,v,y],B=[w,b,x];const U=new Float32Array(1);N.onaudioprocess=({inputBuffer:t})=>{const e=[u(t,U,0),u(t,U,1),u(t,U,2)];e.some(((t,e)=>t!==j[e]))&&(E.setOrientation(...e),j=e);const n=[u(t,U,3),u(t,U,4),u(t,U,5)];n.some(((t,e)=>t!==B[e]))&&(E.setPosition(...n),B=n)},Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"defaultValue",{get:()=>0});const V={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(t){if(t>2)throw o();F.channelCount=t,E.channelCount=t},get channelCountMode(){return E.channelCountMode},set channelCountMode(t){if("max"===t)throw o();F.channelCountMode=t,E.channelCountMode=t},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(t){F.channelInterpretation=t,E.channelInterpretation=t},get coneInnerAngle(){return E.coneInnerAngle},set coneInnerAngle(t){E.coneInnerAngle=t},get coneOuterAngle(){return E.coneOuterAngle},set coneOuterAngle(t){E.coneOuterAngle=t},get coneOuterGain(){return E.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();E.coneOuterGain=t},get context(){return E.context},get distanceModel(){return E.distanceModel},set distanceModel(t){E.distanceModel=t},get inputs(){return[F]},get maxDistance(){return E.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;E.maxDistance=t},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get orientationX(){return P.gain},get orientationY(){return R.gain},get orientationZ(){return I.gain},get panningModel(){return E.panningModel},set panningModel(t){E.panningModel=t},get positionX(){return D.gain},get positionY(){return O.gain},get positionZ(){return M.gain},get refDistance(){return E.refDistance},set refDistance(t){if(t<0)throw new RangeError;E.refDistance=t},get rolloffFactor(){return E.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;E.rolloffFactor=t},addEventListener:(...t)=>F.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>F.dispatchEvent(t[0]),removeEventListener:(...t)=>F.removeEventListener(t[0],t[1],t[2])};h!==V.coneInnerAngle&&(V.coneInnerAngle=h),d!==V.coneOuterAngle&&(V.coneOuterAngle=d),p!==V.coneOuterGain&&(V.coneOuterGain=p),f!==V.distanceModel&&(V.distanceModel=f),g!==V.maxDistance&&(V.maxDistance=g),m!==V.orientationX.value&&(V.orientationX.value=m),v!==V.orientationY.value&&(V.orientationY.value=v),y!==V.orientationZ.value&&(V.orientationZ.value=y),_!==V.panningModel&&(V.panningModel=_),w!==V.positionX.value&&(V.positionX.value=w),b!==V.positionY.value&&(V.positionY.value=b),x!==V.positionZ.value&&(V.positionZ.value=x),S!==V.refDistance&&(V.refDistance=S),T!==V.rolloffFactor&&(V.rolloffFactor=T),1===j[0]&&0===j[1]&&0===j[2]||E.setOrientation(...j),0===B[0]&&0===B[1]&&0===B[2]||E.setPosition(...B);return c(ge(V,E),(()=>{F.connect(E),t(F,L,0,0),L.connect(P).connect(k,0,0),L.connect(R).connect(k,0,1),L.connect(I).connect(k,0,2),L.connect(D).connect(k,0,3),L.connect(O).connect(k,0,4),L.connect(M).connect(k,0,5),k.connect(N).connect(l.destination)}),(()=>{F.disconnect(E),a(F,L,0,0),L.disconnect(P),P.disconnect(k),L.disconnect(R),R.disconnect(k),L.disconnect(I),I.disconnect(k),L.disconnect(D),D.disconnect(k),L.disconnect(O),O.disconnect(k),L.disconnect(M),M.disconnect(k),k.disconnect(N),N.disconnect(l.destination)}))})(ht,zt,li,ve,we,Wi,be,mt,Fe,oi),zi=(Ji=Ki,(t,e)=>{const n=t.createPanner();return void 0===n.orientationX?Ji(t,e):(ee(n,e),ie(n,e,"orientationX"),ie(n,e,"orientationY"),ie(n,e,"orientationZ"),ie(n,e,"positionX"),ie(n,e,"positionY"),ie(n,e,"positionZ"),te(n,e,"coneInnerAngle"),te(n,e,"coneOuterAngle"),te(n,e,"coneOuterGain"),te(n,e,"distanceModel"),te(n,e,"maxDistance"),te(n,e,"panningModel"),te(n,e,"refDistance"),te(n,e,"rolloffFactor"),n)});var Ji;const Gi=((t,e,n,i,r,s,o,a,u,c)=>()=>{const l=new WeakMap;let h=null;return{render(d,p){const f=l.get(p);return void 0!==f?Promise.resolve(f):(async(d,p)=>{let f=null,g=s(d);const m={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation},v={...m,coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,panningModel:g.panningModel,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor},y=V(g,p);if("bufferSize"in g)f=i(p,{...m,gain:1});else if(!y){const t={...v,orientationX:g.orientationX.value,orientationY:g.orientationY.value,orientationZ:g.orientationZ.value,positionX:g.positionX.value,positionY:g.positionY.value,positionZ:g.positionZ.value};g=r(p,t)}if(l.set(p,null===f?g:f),null!==f){if(null===h){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new o(6,d.context.length,p.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),h=(async()=>{const e=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map((async(e,i)=>{const r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0});return await a(t,e,r.offset),r})));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return c(t)})()}const t=await h,s=i(p,{...m,gain:1});await u(d,p,s);const l=[];for(let e=0;e<t.numberOfChannels;e+=1)l.push(t.getChannelData(e));let g=[l[0][0],l[1][0],l[2][0]],y=[l[3][0],l[4][0],l[5][0]],_=i(p,{...m,gain:1}),w=r(p,{...v,orientationX:g[0],orientationY:g[1],orientationZ:g[2],positionX:y[0],positionY:y[1],positionZ:y[2]});s.connect(_).connect(w.inputs[0]),w.connect(f);for(let e=128;e<t.length;e+=128){const t=[l[0][e],l[1][e],l[2][e]],n=[l[3][e],l[4][e],l[5][e]];if(t.some(((t,e)=>t!==g[e]))||n.some(((t,e)=>t!==y[e]))){g=t,y=n;const o=e/p.sampleRate;_.gain.setValueAtTime(0,o),_=i(p,{...m,gain:0}),w=r(p,{...v,orientationX:g[0],orientationY:g[1],orientationZ:g[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),_.gain.setValueAtTime(1,o),s.connect(_).connect(w.inputs[0]),w.connect(f)}}return f}return y?(await t(p,d.orientationX,g.orientationX),await t(p,d.orientationY,g.orientationY),await t(p,d.orientationZ,g.orientationZ),await t(p,d.positionX,g.positionX),await t(p,d.positionY,g.positionY),await t(p,d.positionZ,g.positionZ)):(await a(p,d.orientationX,g.orientationX),await a(p,d.orientationY,g.orientationY),await a(p,d.orientationZ,g.orientationZ),await a(p,d.positionX,g.positionX),await a(p,d.positionY,g.positionY),await a(p,d.positionZ,g.positionZ)),lt(g)?await u(d,p,g.inputs[0]):await u(d,p,g),g})(d,p)}}})(Bn,li,mi,ve,zi,vt,cn,qn,en,Ri),Yi=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const u=r(t),c={...Te,...a},l=n(u,c),h=s(u);super(t,!1,l,h?i():null),this._nativePannerNode=l,this._orientationX=e(this,h,l.orientationX,34028234663852886e22,-34028234663852886e22),this._orientationY=e(this,h,l.orientationY,34028234663852886e22,-34028234663852886e22),this._orientationZ=e(this,h,l.orientationZ,34028234663852886e22,-34028234663852886e22),this._positionX=e(this,h,l.positionX,34028234663852886e22,-34028234663852886e22),this._positionY=e(this,h,l.positionY,34028234663852886e22,-34028234663852886e22),this._positionZ=e(this,h,l.positionZ,34028234663852886e22,-34028234663852886e22),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(bn,Kn,zi,Gi,an,ln,$n),$i=(t=>(e,{disableNormalization:n,imag:i,real:r})=>{const s=i instanceof Float32Array?i:new Float32Array(i),o=r instanceof Float32Array?r:new Float32Array(r),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(i).length<2)throw t();return a})(q),Xi=((t,e,n,i)=>class r{constructor(r,s){const o=e(r),a=i({...Ce,...s}),u=t(o,a);return n.add(u),u}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===r.prototype||n.has(t)}})($i,an,new WeakSet,(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})),Zi=((t,e,n,i,r,s)=>{const o=16385,a=new Float32Array([1,1]),u=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...c,oversample:"none"},h=(t,s,h,d,p)=>{if(1===s)return((t,e,r,s)=>{const h=new Float32Array(o),d=new Float32Array(o);for(let t=0;t<o;t+=1){const e=t/16384*u;h[t]=Math.cos(e),d[t]=Math.sin(e)}const p=n(t,{...c,gain:0}),f=i(t,{...l,curve:h}),g=i(t,{...l,curve:a}),m=n(t,{...c,gain:0}),v=i(t,{...l,curve:d});return{connectGraph(){e.connect(p),e.connect(void 0===g.inputs?g:g.inputs[0]),e.connect(m),g.connect(r),r.connect(void 0===f.inputs?f:f.inputs[0]),r.connect(void 0===v.inputs?v:v.inputs[0]),f.connect(p.gain),v.connect(m.gain),p.connect(s,0,0),m.connect(s,0,1)},disconnectGraph(){e.disconnect(p),e.disconnect(void 0===g.inputs?g:g.inputs[0]),e.disconnect(m),g.disconnect(r),r.disconnect(void 0===f.inputs?f:f.inputs[0]),r.disconnect(void 0===v.inputs?v:v.inputs[0]),f.disconnect(p.gain),v.disconnect(m.gain),p.disconnect(s,0,0),m.disconnect(s,0,1)}}})(t,h,d,p);if(2===s)return((t,r,s,h)=>{const d=new Float32Array(o),p=new Float32Array(o),f=new Float32Array(o),g=new Float32Array(o),m=Math.floor(8192.5);for(let t=0;t<o;t+=1)if(t>m){const e=(t-m)/(16384-m)*u;d[t]=Math.cos(e),p[t]=Math.sin(e),f[t]=0,g[t]=1}else{const e=t/(16384-m)*u;d[t]=1,p[t]=0,f[t]=Math.cos(e),g[t]=Math.sin(e)}const v=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),y=n(t,{...c,gain:0}),_=i(t,{...l,curve:d}),w=n(t,{...c,gain:0}),b=i(t,{...l,curve:p}),x=i(t,{...l,curve:a}),S=n(t,{...c,gain:0}),T=i(t,{...l,curve:f}),C=n(t,{...c,gain:0}),E=i(t,{...l,curve:g});return{connectGraph(){r.connect(v),r.connect(void 0===x.inputs?x:x.inputs[0]),v.connect(y,0),v.connect(w,0),v.connect(S,1),v.connect(C,1),x.connect(s),s.connect(void 0===_.inputs?_:_.inputs[0]),s.connect(void 0===b.inputs?b:b.inputs[0]),s.connect(void 0===T.inputs?T:T.inputs[0]),s.connect(void 0===E.inputs?E:E.inputs[0]),_.connect(y.gain),b.connect(w.gain),T.connect(S.gain),E.connect(C.gain),y.connect(h,0,0),S.connect(h,0,0),w.connect(h,0,1),C.connect(h,0,1)},disconnectGraph(){r.disconnect(v),r.disconnect(void 0===x.inputs?x:x.inputs[0]),v.disconnect(y,0),v.disconnect(w,0),v.disconnect(S,1),v.disconnect(C,1),x.disconnect(s),s.disconnect(void 0===_.inputs?_:_.inputs[0]),s.disconnect(void 0===b.inputs?b:b.inputs[0]),s.disconnect(void 0===T.inputs?T:T.inputs[0]),s.disconnect(void 0===E.inputs?E:E.inputs[0]),_.disconnect(y.gain),b.disconnect(w.gain),T.disconnect(S.gain),E.disconnect(C.gain),y.disconnect(h,0,0),S.disconnect(h,0,0),w.disconnect(h,0,1),C.disconnect(h,0,1)}}})(t,h,d,p);throw r()};return(e,{channelCount:i,channelCountMode:o,pan:a,...u})=>{if("max"===o)throw r();const c=t(e,{...u,channelCount:1,channelCountMode:o,numberOfInputs:2}),l=n(e,{...u,channelCount:i,channelCountMode:o,gain:1}),d=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:p,disconnectGraph:f}=h(e,i,l,d,c);Object.defineProperty(d.gain,"defaultValue",{get:()=>0}),Object.defineProperty(d.gain,"maxValue",{get:()=>1}),Object.defineProperty(d.gain,"minValue",{get:()=>-1});const g={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(m&&f(),({connectGraph:p,disconnectGraph:f}=h(e,t,l,d,c)),m&&p()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw r();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return d.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let m=!1;return s(ge(g,c),(()=>{p(),m=!0}),(()=>{f(),m=!1}))}})(li,fe,ve,Wi,be,oi),Qi=((t,e)=>(n,i)=>{const r=i.channelCountMode;if("clamped-max"===r)throw e();if(void 0===n.createStereoPanner)return t(n,i);const s=n.createStereoPanner();return ee(s,i),ie(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:t=>{if(t!==r)throw e()}}),s})(Zi,be),tr=((t,e,n,i,r)=>()=>{const s=new WeakMap;return{render(o,a){const u=s.get(a);return void 0!==u?Promise.resolve(u):(async(o,a)=>{let u=n(o);const c=V(u,a);if(!c){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=e(a,t)}return s.set(a,u),c?await t(a,o.pan,u.pan):await i(a,o.pan,u.pan),lt(u)?await r(o,a,u.inputs[0]):await r(o,a,u),u})(o,a)}}})(Bn,Qi,vt,qn,en),er=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),u={...Ee,...o},c=n(a,u),l=s(a);super(t,!1,c,l?i():null),this._pan=e(this,l,c.pan)}get pan(){return this._pan}})(bn,Kn,Qi,tr,an,ln),nr=((t,e,n)=>()=>{const i=new WeakMap;return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!V(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(s,e)}return i.set(s,o),lt(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o})(r,s)}}})(Wi,vt,en),ir=((t,e,n,i,r,s,o)=>class extends t{constructor(t,e){const a=r(t),u={...ke,...e},c=n(a,u);super(t,!0,c,s(a)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=c,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(bn,zt,Wi,nr,an,ln,$n),rr=(t=>null!==t&&t.isSecureContext)(Ye),sr=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(Ye),or=new WeakMap,ar=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i})(or,cn),ur=rr?((t,e,n,i,r,s,o,a,u,c,l,h,d)=>{let p=0;return(f,g,m={credentials:"omit"})=>{const v=l.get(f);if(void 0!==v&&v.has(g))return Promise.resolve();const y=c.get(f);if(void 0!==y){const t=y.get(g);if(void 0!==t)return t}const _=s(f),w=void 0===_.audioWorklet?r(g).then((([t,e])=>{const[i,r]=F(t,e);return n(`${i};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${r}\n})})(window,'_AWGS')`)})).then((()=>{const t=d._AWGS.pop();if(void 0===t)throw new SyntaxError;i(_.currentTime,_.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const i=T.get(_);if(void 0!==i){if(i.has(t))throw e();R(n),P(n.parameterDescriptors),i.set(t,n)}else R(n),P(n.parameterDescriptors),T.set(_,new Map([[t,n]]))}),_.sampleRate,void 0,void 0)))})):Promise.all([r(g),Promise.resolve(t(h,h))]).then((([[t,e],n])=>{const i=p+1;p=i;const[r,s]=F(t,e),c=new Blob([`${r};((AudioWorkletProcessor,registerProcessor)=>{${s}\n})(${n?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${i}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),l=URL.createObjectURL(c);return _.audioWorklet.addModule(l,m).then((()=>{if(a(_))return _;const t=o(_);return t.audioWorklet.addModule(l,m).then((()=>t))})).then((t=>{if(null===u)throw new SyntaxError;try{new u(t,`__sac${i}`)}catch{throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(l)))}));return void 0===y?c.set(f,new Map([[g,w]])):y.set(g,w),w.then((()=>{const t=l.get(f);void 0===t?l.set(f,new Set([g])):t.add(g)})).finally((()=>{const t=c.get(f);void 0!==t&&t.delete(g)})),w}})(ze,be,(t=>e=>new Promise(((n,i)=>{if(null===t)return void i(new SyntaxError);const r=t.document.head;if(null===r)i(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),u=t.onerror,c=()=>{t.onerror=u,URL.revokeObjectURL(a)};t.onerror=(e,n,r,s,o)=>n===a||n===t.location.href&&1===r&&1===s?(c(),i(o),!1):null!==u?u(e,n,r,s,o):void 0,s.onerror=()=>{c(),i(new SyntaxError)},s.onload=()=>{c(),n()},s.src=a,s.type="module",r.appendChild(s)}})))(Ye),sr,(cr=()=>new DOMException("","AbortError"),async t=>{try{const e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw cr()}),an,ar,ln,wn,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n);let s=!1,o=!1;try{await i.audioWorklet.addModule(r);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>s=!0,e.onprocessorerror=()=>o=!0,n.connect(e),n.start(0),await i.startRendering()}catch{}finally{URL.revokeObjectURL(r)}return s&&!o})(wn,cn),Ye):void 0;var cr;const lr=((t,e)=>n=>t(n)||e(n))(mn,ln),hr=((t,e,n,i,r,s,o,a,u,c,l)=>(h,d)=>{const p=o(h)?h:s(h);if(r.has(d)){const t=n();return Promise.reject(t)}try{r.add(d)}catch{}return e(u,(()=>u(p)))?p.decodeAudioData(d).then((n=>(Ut(d).catch((()=>{})),e(a,(()=>a(n)))||l(n),t.add(n),n))):new Promise(((e,n)=>{const r=async()=>{try{await Ut(d)}catch{}},s=t=>{n(t),r()};try{p.decodeAudioData(d,(n=>{"function"!=typeof n.copyFromChannel&&(c(n),W(n)),t.add(n),r().then((()=>e(n)))}),(t=>{s(null===t?i():t)}))}catch(t){s(t)}}))})(Tn,ze,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,an,lr,H,Zt,kn,Fn),dr=(pr=ur,fr=Sn,gr=Rn,mr=Jn,vr=Xn,yr=di,_r=fi,wr=yi,br=bi,xr=hr,Sr=Si,Tr=Ai,Cr=Fi,Er=Oi,Ar=Li,kr=Ui,Fr=Yi,Pr=Xi,Rr=er,Ir=ir,class extends Ar{constructor(t,e){super(t,e),this._nativeContext=t,this._audioWorklet=void 0===pr?void 0:{addModule:(t,e)=>pr(this,t,e)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new fr(this)}createBiquadFilter(){return new vr(this)}createBuffer(t,e,n){return new gr({length:e,numberOfChannels:t,sampleRate:n})}createBufferSource(){return new mr(this)}createChannelMerger(t=6){return new yr(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new _r(this,{numberOfOutputs:t})}createConstantSource(){return new wr(this)}createConvolver(){return new br(this)}createDelay(t=1){return new Sr(this,{maxDelayTime:t})}createDynamicsCompressor(){return new Tr(this)}createGain(){return new Cr(this)}createIIRFilter(t,e){return new Er(this,{feedback:e,feedforward:t})}createOscillator(){return new kr(this)}createPanner(){return new Fr(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new Pr(this,{...n,imag:e,real:t})}createStereoPanner(){return new Rr(this)}createWaveShaper(){return new Ir(this)}decodeAudioData(t,e,n){return xr(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t)),(t=>{throw"function"==typeof n&&n(t),t}))}});var pr,fr,gr,mr,vr,yr,_r,wr,br,xr,Sr,Tr,Cr,Er,Ar,kr,Fr,Pr,Rr,Ir;const Dr=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t),o=e(s,r);if(i(s))throw TypeError();super(t,!0,o,null),this._nativeMediaElementAudioSourceNode=o}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(bn,((t,e)=>t.createMediaElementSource(e.mediaElement)),an,ln),Or=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t);if(i(s))throw new TypeError;const o={...Xt,...r},a=e(s,o);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(bn,((t,e)=>{const n=t.createMediaStreamDestination();return ee(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),an,ln),Mr=((t,e,n,i)=>class extends t{constructor(t,r){const s=n(t),o=e(s,r);if(i(s))throw new TypeError;super(t,!0,o,null),this._nativeMediaStreamAudioSourceNode=o}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(bn,((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const i=n.slice(0,1),r=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(r,"mediaStream",{value:e}),r}),an,ln),Nr=((t,e)=>(n,{mediaStreamTrack:i})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(i);const r=new MediaStream([i]),s=n.createMediaStreamSource(r);if("audio"!==i.kind)throw t();if(e(n))throw new TypeError;return s})(zt,ln),Lr=((t,e,n)=>class extends t{constructor(t,i){const r=n(t);super(t,!0,e(r,i),null)}})(bn,Nr,an),jr=((t,e,n,i,r,s,o,a,u)=>class extends t{constructor(t={}){if(null===u)throw new Error("Missing the native AudioContext constructor.");let e;try{e=new u(t)}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw n();throw t}if(null===e)throw i();if(!rt(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:r}=t,{sampleRate:s}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===r?512/s:"interactive"===r||void 0===r?256/s:"playback"===r?1024/s:128*Math.max(2,Math.min(128,Math.round(r*s/128)))/s,this._nativeAudioContext=e,"webkitAudioContext"===u.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),it(this)})))}createMediaElementSource(t){return new r(this,{mediaElement:t})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(t){return new o(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(dr,zt,be,Ae,Dr,Or,Mr,Lr,gn),Br=(Ur=Ni,t=>{const e=Ur.get(t);if(void 0===e)throw new Error("The context has no set of AudioWorkletNodes.");return e});var Ur;const Vr=(Hr=Br,(t,e)=>{Hr(t).add(e)});var Hr;const qr=(t=>(e,n,i=0,r=0)=>{const s=e[i];if(void 0===s)throw t();return St(n)?s.connect(n,0,r):s.connect(n,0)})(q),Wr=(t=>(e,n)=>{t(e).delete(n)})(Br),Kr=(t=>(e,n,i,r=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?qt(t,e,n).disconnect():St(n)?void 0===i?e.forEach((t=>t.disconnect(n))):void 0===r?qt(t,e,i).disconnect(n,0):qt(t,e,i).disconnect(n,0,r):void 0===i?e.forEach((t=>t.disconnect(n))):qt(t,e,i).disconnect(n,0))(q),zr=new WeakMap,Jr=(Gr=zr,Yr=I,t=>Yr(Gr,t));var Gr,Yr;const $r=((t,e,n,i,r,s,o,a,u,c,l,h,d)=>(p,f,g,m)=>{if(0===m.numberOfInputs&&0===m.numberOfOutputs)throw u();const v=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(v.some((t=>t<1)))throw u();if(v.length!==m.numberOfOutputs)throw e();if("explicit"!==m.channelCountMode)throw u();const y=m.channelCount*m.numberOfInputs,_=v.reduce(((t,e)=>t+e),0),w=void 0===g.parameterDescriptors?0:g.parameterDescriptors.length;if(y+w>6||_>6)throw u();const b=new MessageChannel,x=[],S=[];for(let t=0;t<m.numberOfInputs;t+=1)x.push(o(p,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),S.push(r(p,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));const T=[];if(void 0!==g.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:i}of g.parameterDescriptors){const r=s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==m.parameterData[i]?m.parameterData[i]:void 0===t?0:t});Object.defineProperties(r.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?34028234663852886e22:e},minValue:{get:()=>void 0===n?-34028234663852886e22:n}}),T.push(r)}const C=i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+w)}),E=ue(f,p.sampleRate),A=a(p,E,y+w,Math.max(1,_)),k=r(p,{channelCount:Math.max(1,_),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,_)}),F=[];for(let t=0;t<m.numberOfOutputs;t+=1)F.push(i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[t]}));for(let t=0;t<m.numberOfInputs;t+=1){x[t].connect(S[t]);for(let e=0;e<m.channelCount;e+=1)S[t].connect(C,e,t*m.channelCount+e)}const P=new kt(void 0===g.parameterDescriptors?[]:g.parameterDescriptors.map((({name:t},e)=>{const n=T[e];return n.connect(C,0,y+e),n.start(0),[t,n.offset]})));C.connect(A);let R=m.channelInterpretation,I=null;const D=0===m.numberOfOutputs?[A]:F,O={get bufferSize(){return E},get channelCount(){return m.channelCount},set channelCount(t){throw n()},get channelCountMode(){return m.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return R},set channelInterpretation(t){for(const e of x)e.channelInterpretation=t;R=t},get context(){return A.context},get inputs(){return x},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get onprocessorerror(){return I},set onprocessorerror(t){"function"==typeof I&&O.removeEventListener("processorerror",I),I="function"==typeof t?t:null,"function"==typeof I&&O.addEventListener("processorerror",I)},get parameters(){return P},get port(){return b.port2},addEventListener:(...t)=>A.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,D),disconnect:c.bind(null,D),dispatchEvent:(...t)=>A.dispatchEvent(t[0]),removeEventListener:(...t)=>A.removeEventListener(t[0],t[1],t[2])},M=new Map;var N,L;b.port1.addEventListener=(N=b.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=M.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{l(p.currentTime,p.sampleRate,(()=>e(t)))},M.set(e,t[1]))}}return N.call(b.port1,t[0],t[1],t[2])}),b.port1.removeEventListener=(L=b.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=M.get(t[1]);void 0!==e&&(M.delete(t[1]),t[1]=e)}return L.call(b.port1,t[0],t[1],t[2])});let j=null;Object.defineProperty(b.port1,"onmessage",{get:()=>j,set:t=>{"function"==typeof j&&b.port1.removeEventListener("message",j),j="function"==typeof t?t:null,"function"==typeof j&&(b.port1.addEventListener("message",j),b.port1.start())}}),g.prototype.port=b.port1;let B=null;he(p,O,g,m).then((t=>B=t));const U=It(m.numberOfInputs,m.channelCount),V=It(m.numberOfOutputs,v),H=void 0===g.parameterDescriptors?[]:g.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let q=!0;const W=()=>{m.numberOfOutputs>0&&A.disconnect(k);for(let t=0,e=0;t<m.numberOfOutputs;t+=1){const n=F[t];for(let i=0;i<v[t];i+=1)k.disconnect(n,e+i,i);e+=v[t]}},K=new Map;A.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==B){const n=h(O);for(let i=0;i<E;i+=128){for(let e=0;e<m.numberOfInputs;e+=1)for(let n=0;n<m.channelCount;n+=1)Pt(t,U[e],n,n,i);void 0!==g.parameterDescriptors&&g.parameterDescriptors.forEach((({name:e},n)=>{Pt(t,H,e,y+n,i)}));for(let t=0;t<m.numberOfInputs;t+=1)for(let e=0;e<v[t];e+=1)0===V[t][e].byteLength&&(V[t][e]=new Float32Array(128));try{const t=U.map(((t,e)=>{if(n[e].size>0)return K.set(e,E/128),t;const i=K.get(e);return void 0===i?[]:(t.every((t=>t.every((t=>0===t))))&&(1===i?K.delete(e):K.set(e,i-1)),t)})),r=l(p.currentTime+i/p.sampleRate,p.sampleRate,(()=>B.process(t,V,H)));q=r;for(let t=0,n=0;t<m.numberOfOutputs;t+=1){for(let r=0;r<v[t];r+=1)Rt(e,V[t],r,n+r,i);n+=v[t]}}catch(t){q=!1,O.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!q){for(let t=0;t<m.numberOfInputs;t+=1){x[t].disconnect(S[t]);for(let e=0;e<m.channelCount;e+=1)S[i].disconnect(C,e,t*m.channelCount+e)}if(void 0!==g.parameterDescriptors){const t=g.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=T[e];t.disconnect(C,0,y+e),t.stop()}}C.disconnect(A),A.onaudioprocess=null,z?W():Y();break}}}};let z=!1;const J=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),G=()=>A.connect(J).connect(p.destination),Y=()=>{A.disconnect(J),J.disconnect()};return G(),d(O,(()=>{if(q){Y(),m.numberOfOutputs>0&&A.connect(k);for(let t=0,e=0;t<m.numberOfOutputs;t+=1){const n=F[t];for(let i=0;i<v[t];i+=1)k.connect(n,e+i,i);e+=v[t]}}z=!0}),(()=>{q&&(G(),W()),z=!1}))})(qr,q,zt,li,fe,mi,ve,we,be,Kr,sr,Jr,oi),Xr=((t,e,n,i,r)=>(s,o,a,u,c,l)=>{if(null!==a)try{const e=new a(s,u,l),i=new Map;let o=null;if(Object.defineProperties(e,{channelCount:{get:()=>l.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>o,set:t=>{"function"==typeof o&&e.removeEventListener("processorerror",o),o="function"==typeof t?t:null,"function"==typeof o&&e.addEventListener("processorerror",o)}}}),e.addEventListener=(d=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=i.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},i.set(e,t[1]))}}return d.call(e,"error",t[1],t[2]),d.call(e,...t)}),e.removeEventListener=(h=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=i.get(t[1]);void 0!==e&&(i.delete(t[1]),t[1]=e)}return h.call(e,"error",t[1],t[2]),h.call(e,t[0],t[1],t[2])}),0!==l.numberOfOutputs){const t=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(s.destination);return r(e,(()=>t.disconnect()),(()=>t.connect(s.destination)))}return e}catch(t){if(11===t.code)throw i();throw t}var h,d;if(void 0===c)throw i();return ae(l),e(s,o,c,l)})(zt,$r,ve,be,oi),Zr=((t,e,n,i,r,s,o,a,u,c,l,h,d,p,f,g)=>(m,v,y)=>{const _=new WeakMap;let w=null;return{render(b,x){a(x,b);const S=_.get(x);return void 0!==S?Promise.resolve(S):(async(a,b)=>{let x=l(a),S=null;const T=V(x,b),C=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(null===h){const t=C.reduce(((t,e)=>t+e),0),n=r(b,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),s=[];for(let t=0;t<a.numberOfOutputs;t+=1)s.push(i(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[t]}));const c=o(b,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});c.connect=e.bind(null,s),c.disconnect=u.bind(null,s),S=[n,s,c]}else T||(x=new h(b,m));if(_.set(b,null===S?x:S[2]),null!==S){if(null===w){if(void 0===y)throw new Error("Missing the processor constructor.");if(null===d)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,n=t+e,u=async()=>{const u=new d(n,128*Math.ceil(a.context.length/128),b.sampleRate),c=[],l=[];for(let t=0;t<v.numberOfInputs;t+=1)c.push(o(u,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),l.push(r(u,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const h=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=s(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await p(u,t,e.offset),e}))),m=i(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<v.numberOfInputs;t+=1){c[t].connect(l[t]);for(let e=0;e<v.channelCount;e+=1)l[t].connect(m,e,t*v.channelCount+e)}for(const[e,n]of h.entries())n.connect(m,0,t+e),n.start(0);return m.connect(u.destination),await Promise.all(c.map((t=>f(a,u,t)))),g(u)};w=Ot(a,0===n?null:await u(),b,v,C,y,c)}const t=await w,e=n(b,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[u,l,h]=S;null!==t&&(e.buffer=t,e.start(0)),e.connect(u);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=l[t];for(let i=0;i<C[t];i+=1)u.connect(n,e+i,i);e+=C[t]}return h}if(T)for(const[e,n]of a.parameters.entries())await t(b,n,x.parameters.get(e));else for(const[t,e]of a.parameters.entries())await p(b,e,x.parameters.get(t));return await f(a,b,x),x})(b,x)}}})(Bn,qr,Vn,li,fe,mi,ve,Wr,Kr,sr,vt,wn,cn,qn,en,Ri),Qr=(ts=or,t=>ts.get(t));var ts;const es=(t=>(e,n)=>{t.set(e,n)})(zr),ns=rr?((t,e,n,i,r,s,o,a,u,c,l,h,d,p)=>class extends e{constructor(e,p,f){var g;const m=a(e),v=u(m),y=l({...Ft,...f});d(y);const _=T.get(m),w=null==_?void 0:_.get(p),b=v||"closed"!==m.state?m:null!==(g=o(m))&&void 0!==g?g:m,x=r(b,v?null:e.baseLatency,c,p,w,y);super(e,!0,x,v?i(p,y,w):null);const S=[];x.parameters.forEach(((t,e)=>{const i=n(this,v,t);S.push([e,i])})),this._nativeAudioWorkletNode=x,this._onprocessorerror=null,this._parameters=new kt(S),v&&t(m,this);const{activeInputs:C}=s(this);h(x,C)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?p(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(Vr,bn,Kn,Zr,Xr,tt,Qr,an,ln,wn,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),es,(t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}}),Le):void 0,is=(((t,e,n,i,r)=>{})(zt,be,Ae,Li,gn),((t,e)=>(n,i,r)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(be,cn)),rs=((t,e,n,i,r,s,o,a)=>(u,c)=>n(u).render(u,c).then((()=>Promise.all(Array.from(i(c)).map((t=>n(t).render(t,c)))))).then((()=>r(c))).then((n=>("function"!=typeof n.copyFromChannel?(o(n),W(n)):e(s,(()=>s(n)))||a(n),t.add(n),n))))(Tn,ze,Qe,Br,Ri,H,kn,Fn),ss=(((t,e,n,i,r)=>{})(ze,zt,is,Li,rs),((t,e,n,i,r)=>class extends t{constructor(t,n,r){let s;if("number"==typeof t&&void 0!==n&&void 0!==r)s={length:n,numberOfChannels:t,sampleRate:r};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");s=t}const{length:o,numberOfChannels:a,sampleRate:u}={...xe,...s},c=i(a,o,u);e(Zt,(()=>Zt(c)))||c.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(c.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(c,a),this._length=o,this._nativeOfflineAudioContext=c,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,it(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(dr,ze,zt,is,rs)),os=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(b,mn),as=(us=y,cs=yn,t=>us.has(t)||cs(t));var us,cs;const ls=(hs=w,ds=_n,t=>hs.has(t)||ds(t));var hs,ds;const ps=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(b,ln);function fs(t,e){if(!t)throw new Error(e)}function gs(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function ms(t){t.isOffline||"running"===t.state||_s('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let vs=console;function ys(...t){vs.log(...t)}function _s(...t){vs.warn(...t)}function ws(t){return void 0===t}function bs(t){return!ws(t)}function xs(t){return"number"==typeof t}function Ss(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function Ts(t){return"boolean"==typeof t}function Cs(t){return Array.isArray(t)}function Es(t){return"string"==typeof t}function As(t){return Es(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function ks(t){return new jr(t)}const Fs="object"==typeof self?self:null,Ps=Fs&&(Fs.hasOwnProperty("AudioContext")||Fs.hasOwnProperty("webkitAudioContext"));function Rs(t,e,n){return fs(bs(ns),"This node only works in a secure context (https or localhost)"),new ns(t,e,n)}function Is(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o}function Ds(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))}Object.create;Object.create;class Os{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function Ms(t){return ls(t)}function Ns(t){return as(t)}function Ls(t){return ps(t)}function js(t){return os(t)}function Bs(t){return t instanceof AudioBuffer}function Us(t,e){return"value"===t||Ms(e)||Ns(e)||Bs(e)}function Vs(t,...e){if(!e.length)return t;const n=e.shift();if(Ss(t)&&Ss(n))for(const e in n)Us(e,n[e])?t[e]=n[e]:Ss(n[e])?(t[e]||Object.assign(t,{[e]:{}}),Vs(t[e],n[e])):Object.assign(t,{[e]:n[e]});return Vs(t,...e)}function Hs(t,e,n=[],i){const r={},s=Array.from(e);if(Ss(s[0])&&i&&!Reflect.has(s[0],i)){Object.keys(s[0]).some((e=>Reflect.has(t,e)))||(Vs(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())}if(1===s.length&&Ss(s[0]))Vs(r,s[0]);else for(let t=0;t<n.length;t++)bs(s[t])&&(r[n[t]]=s[t]);return Vs(t,r)}function qs(t,e){return ws(t)?e:t}function Ws(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}class Ks{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||Fs&&this.toString()===Fs.TONE_DEBUG_CLASS)&&ys(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Ks.version="14.7.77";function zs(t,e){return t>e+1e-6}function Js(t,e){return zs(t,e)||Ys(t,e)}function Gs(t,e){return t+1e-6<e}function Ys(t,e){return Math.abs(t-e)<1e-6}function $s(t,e,n){return Math.max(Math.min(t,n),e)}class Xs extends Ks{constructor(){super(),this.name="Timeline",this._timeline=[];const t=Hs(Xs.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(fs(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];fs(Js(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Ys(this._timeline[e].time,t)){for(let n=e;n>=0&&Ys(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&Js(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let r=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<r;){let i=Math.floor(n+(r-n)/2);const s=this._timeline[i],o=this._timeline[i+1];if(Ys(s[e],t)){for(let n=i;n<this._timeline.length;n++){if(!Ys(this._timeline[n][e],t))break;i=n}return i}if(Gs(s[e],t)&&zs(o[e],t))return i;zs(s[e],t)?r=i:n=i+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),r=this._search(e);return-1!==i&&-1!==r?(this._timeline[i].time!==t&&(i+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&Ys(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&Ys(this._timeline[e].time,t);e--)i=e;this._iterate((t=>{e(t)}),i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Zs=[];function Qs(t){Zs.push(t)}const to=[];function eo(t){to.push(t)}class no extends Ks{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{ws(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(ws(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(ws(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(no.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class io extends no{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class ro extends io{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Xs,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=Hs(ro.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=ks({latencyHint:t.latencyHint}),this._ticker=new Os(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,Zs.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){fs(js(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaElementSource(t){fs(js(this._context),"Not available if OfflineAudioContext");return this._context.createMediaElementSource(t)}createMediaStreamDestination(){fs(js(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){fs(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){fs(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){fs(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){fs(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return Rs(this.rawContext,t,e)}addAudioWorkletModule(t,e){return Ds(this,void 0,void 0,(function*(){fs(bs(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return Ds(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Es(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return js(this._context)?this._context.resume():Promise.resolve()}close(){return Ds(this,void 0,void 0,(function*(){var t;js(this._context)&&(yield this._context.close()),this._initialized&&(t=this,to.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const r=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:r+e})};return i(),n}}function so(t,e){Cs(e)?e.forEach((e=>so(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function oo(t,e){Cs(e)?e.forEach((e=>oo(t,e))):Object.defineProperty(t,e,{writable:!0})}const ao=()=>{};class uo extends Ks{constructor(){super(),this.name="ToneAudioBuffer",this.onload=ao;const t=Hs(uo.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&Bs(t.url)||t.url instanceof uo?this.set(t.url):Es(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:ao,onload:ao,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:po().sampleRate}set(t){return t instanceof uo?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return Ds(this,void 0,void 0,(function*(){const e=uo.load(t).then((t=>{this.set(t),this.onload(this)}));uo.downloads.push(e);try{yield e}finally{const t=uo.downloads.indexOf(e);uo.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=Cs(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,r=po(),s=r.createBuffer(n,i,r.sampleRate),o=e||1!==n?t:[t];for(let t=0;t<n;t++)s.copyToChannel(o[t],t);return this._buffer=s,this}toMono(t){if(xs(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(xs(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);fs(n<i,"The start time must be less than the end time");const r=i-n,s=po().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)s.copyToChannel(this.getChannelData(t).subarray(n,i),t);return new uo(s)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new uo).fromArray(t)}static fromUrl(t){return Ds(this,void 0,void 0,(function*(){const e=new uo;return yield e.load(t)}))}static load(t){return Ds(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(uo.supportsType(t)){i=t;break}t=t.replace(e[0],i)}const n=""===uo.baseUrl||uo.baseUrl.endsWith("/")?uo.baseUrl:uo.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error(`could not load url: ${t}`);const r=yield i.arrayBuffer();return yield po().decodeAudioData(r)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return Ds(this,void 0,void 0,(function*(){for(yield Promise.resolve();uo.downloads.length;)yield uo.downloads[0]}))}}uo.baseUrl="",uo.downloads=[];class co extends ro{constructor(){var t,e,n;super({clockSource:"offline",context:Ls(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new ss(t,e,n)),lookAhead:0,updateInterval:Ls(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Ls(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Ds(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return Ds(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new uo(e)}))}close(){return Promise.resolve()}}const lo=new class extends io{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return Ds(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let ho=lo;function po(){return ho===lo&&Ps&&fo(new ro),ho}function fo(t){ho=js(t)?new ro(t):Ls(t)?new co(t):t}if(Fs&&!Fs.TONE_SILENCE_LOGGING){let t="v";0;const e=` * Tone.js ${t}14.7.77 * `;console.log(`%c${e}`,"background: #000; color: #fff")}class go extends Ks{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=Hs(go.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:ao,onload:ao,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return fs(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=ao,i=ao){return Es(e)?this._buffers.set(t.toString(),new uo(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new uo(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}function mo(t){return Math.pow(10,t/20)}function vo(t){return Math.log(t)/Math.LN10*20}function yo(t){return Math.pow(2,t/12)}let _o=440;function wo(t){_o=t}function bo(t){return Math.round(xo(t))}function xo(t){return 69+12*Math.log2(t/_o)}function So(t){return _o*Math.pow(2,(t-69)/12)}class To extends Ks{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof To&&this.fromType(this._val),ws(this._val))return this._noArg();if(Es(this._val)&&ws(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Ss(this._val)){let t=0;for(const e in this._val)if(bs(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(bs(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return Es(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class Co extends To{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Co(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],i=new Co(this.context,e[0]).toSeconds();return e.forEach((e=>{const r=new Co(this.context,e).toSeconds();Math.abs(r-t)<Math.abs(i-t)&&(n=e,i=r)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const r=i.toString();r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3)));return[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return bo(this.toFrequency())}_now(){return this.context.now()}}class Eo extends Co{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return _o}static set A4(t){wo(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:Eo.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=Ao[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:Eo.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new Eo(this.context,this.valueOf()*yo(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return bo(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Eo.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);i<0&&(n+=-12*i);return ko[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return So(t)}static ftom(t){return bo(t)}}const Ao={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},ko=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class Fo extends Co{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Po extends Ks{constructor(){super();const t=Hs(Po.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:po()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new Co(this.context,t).toSeconds()}toFrequency(t){return new Eo(this.context,t).toFrequency()}toTicks(t){return new Fo(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{ws(t[n])&&delete e[n]})),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];bs(n)&&bs(n.value)&&bs(n.setValueAtTime)?t[e]=n.value:n instanceof Po?t[e]=n._getPartialProperties(t[e]):Cs(n)||xs(n)||Es(n)||Ts(n)?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&bs(this[e])&&(this[e]&&bs(this[e].value)&&bs(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof Po?this[e].set(t[e]):this[e]=t[e])})),this}}class Ro extends Po{constructor(){super(Hs(Ro.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=Hs(Ro.getDefaults(),arguments,["param","units","convert"]);for(fs(bs(t.param)&&(Ms(t.param)||t.param instanceof Ro),"param must be an AudioParam");!Ms(t.param);)t.param=t.param._param;this._swappable=!!bs(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Xs(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,bs(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Po.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return bs(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return bs(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return bs(this.maxValue)&&bs(this.minValue)&&gs(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?mo(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?vo(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return fs(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else r=i.value;else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,n,i.value,i.constant,e))}return this._toType(r)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return fs(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Ys(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(e);return fs(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);fs(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(e);return this._assertRange(i),fs(isFinite(i)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(i,r,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const r=this._fromType(t[0])*i;this.setValueAtTime(this._toType(r),e);const s=n/(t.length-1);for(let n=1;n<t.length;n++){const r=this._fromType(t[n])*i;this.linearRampToValueAtTime(this._toType(r),e+n*s)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return fs(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));fs(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),r=this._events.getAfter(e);return i&&Ys(i.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),r=i?i.time:e+2,s=(r-e)/10;for(let n=e;n<r;n+=s)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){fs(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)}_linearInterpolate(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t))}}class Io extends Po{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return bs(this.input)?Ms(this.input)||this.input instanceof Ro?1:this.input.numberOfInputs:0}get numberOfOutputs(){return bs(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return bs(t)&&(t instanceof Io||Ns(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();fs(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return Oo(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return _s("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return Mo(this,t,e,n),this}chain(...t){return Do(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),bs(this.input)&&(this.input instanceof Io?this.input.dispose():Ns(this.input)&&this.input.disconnect()),bs(this.output)&&(this.output instanceof Io?this.output.dispose():Ns(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Do(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof Io?t.connect(e):Ns(t)&&Oo(t,e),e)),e)}function Oo(t,e,n=0,i=0){for(fs(bs(t),"Cannot connect from undefined node"),fs(bs(e),"Cannot connect to undefined node"),(e instanceof Io||Ns(e))&&fs(e.numberOfInputs>0,"Cannot connect to node with no inputs"),fs(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Io||e instanceof Ro;)bs(e.input)&&(e=e.input);for(;t instanceof Io;)bs(t.output)&&(t=t.output);Ms(e)?t.connect(e,n):t.connect(e,n,i)}function Mo(t,e,n=0,i=0){if(bs(e))for(;e instanceof Io;)e=e.input;for(;!Ns(t);)bs(t.output)&&(t=t.output);Ms(e)?t.disconnect(e,n):Ns(e)?t.disconnect(e,n,i):t.disconnect()}class No extends Io{constructor(){super(Hs(No.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=Hs(No.getDefaults(),arguments,["gain","units"]);this.gain=new Ro({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),so(this,"gain")}static getDefaults(){return Object.assign(Io.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Lo extends Io{constructor(t){super(t),this.onended=ao,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new No({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Io.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:ao})}_startGain(t,e=1){fs(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){fs(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==ao&&(this.onended(this),this.onended=ao,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),fs(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class jo extends Lo{constructor(){super(Hs(jo.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=Hs(jo.getDefaults(),arguments,["url","onload"]);Oo(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Ro({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new uo(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Lo.getDefaults(),{url:new uo,loop:!1,loopEnd:0,loopStart:0,onload:ao,onerror:ao,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){fs(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(t);this._startGain(r,i),e=this.loop?qs(e,this.loopStart):qs(e,0);let s=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;Js(s,t)&&(s=(s-e)%n+e),Ys(s,this.buffer.duration)&&(s=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Gs(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,s)),bs(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(r+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class Bo extends Po{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Xs,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Qs((t=>{t.draw=new Bo({context:t})})),eo((t=>{t.draw.dispose()}));class Uo extends Xs{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return gs(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class Vo extends Lo{constructor(){super(Hs(Vo.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=Hs(Vo.getDefaults(),arguments,["offset"]);Oo(this._source,this._gainNode),this.offset=new Ro({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Lo.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Ho extends Io{constructor(){super(Hs(Ho.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=Hs(Ho.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Vo({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Io.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return qo(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function qo(t,e,n,i){(e instanceof Ro||Ms(e)||e instanceof Ho&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Ho&&(e.overridden=!0)),Oo(t,e,n,i)}class Wo extends Ro{constructor(){super(Hs(Wo.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Xs(1/0),this._multiplier=1;const t=Hs(Wo.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ro.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),r=this._events.get(e),s=Math.round(Math.max(1/n,1));for(let t=0;t<=s;t++){const s=n*t+e,o=this._exponentialApproach(r.time,r.value,i,n,s);this.linearRampToValueAtTime(this._toType(o),s)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max(10*(e-i.time),1)),s=(e-i.time)/r;for(let t=0;t<=r;t++){const r=s*t+i.time,o=this._exponentialInterpolate(i.time,i.value,e,n,r);this.linearRampToValueAtTime(this._toType(o),r)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ws(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const r=this._events.get(e);return r&&r.time===e&&"setValueAtTime"===r.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),s=Math.sqrt(Math.pow(i,2)-2*r*(e.ticks-t)),o=(-i+s)/r,a=(-i-s)/r;return(o>0?o:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Ko extends Ho{constructor(){super(Hs(Ko.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=Hs(Ko.getDefaults(),arguments,["value"]);this.input=this._param=new Wo({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Ho.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class zo extends Po{constructor(){super(Hs(zo.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Uo,this._tickOffset=new Xs;const t=Hs(zo.getDefaults(),arguments,["frequency"]);this.frequency=new Ko({context:this.context,units:t.units,value:t.frequency}),so(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Po.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),bs(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let r=n,s=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=r.time;const n=this._tickOffset.get(t.time);n&&n.time>=r.time&&(s=n.ticks,e=n.time),"started"===r.state&&"started"!==t.state&&(s+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),r=t})),this._state.remove(i),s}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,r=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(r=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(r+=t.time-e),i=t})),this._state.remove(n),r}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),r=Math.max(n.time,i.time),s=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,(e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e}));let r=null;if(i&&"started"===i.state){const s=Math.max(i.time,t),o=this.frequency.getTicksAtTime(s),a=o-this.frequency.getTicksAtTime(i.time);let u=Math.ceil(a)-a;u=Ys(u,1)?0:u;let c=this.frequency.getTimeOfTick(o+u);for(;c<e;){try{n(c,Math.round(this.getTicksAtTime(c)))}catch(t){r=t;break}c+=this.frequency.getDurationOfTicks(1,c)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Jo extends Po{constructor(){super(Hs(Jo.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=ao,this._lastUpdate=0,this._state=new Uo("stopped"),this._boundLoop=this._loop.bind(this);const t=Hs(Jo.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new zo({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,so(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Po.getDefaults(),{callback:ao,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){ms(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}no.mixin(Jo);class Go extends Io{constructor(){super(Hs(Go.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=Hs(Go.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new Ro({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),so(this,"delayTime")}static getDefaults(){return Object.assign(Io.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class Yo extends Fo{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class $o extends Ks{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){fs(bs(t.time),"Events must have a time property"),fs(bs(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Xo(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class Xo{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Zo extends Io{constructor(){super(Hs(Zo.getDefaults(),arguments,["volume"])),this.name="Volume";const t=Hs(Zo.getDefaults(),arguments,["volume"]);this.input=this.output=new No({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,so(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Io.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Qo extends Io{constructor(){super(Hs(Qo.getDefaults(),arguments)),this.name="Destination",this.input=new Zo({context:this.context}),this.output=new No({context:this.context}),this.volume=this.input.volume;const t=Hs(Qo.getDefaults(),arguments);Do(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Io.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Do(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Qs((t=>{t.destination=new Qo({context:t})})),eo((t=>{t.destination.dispose()}));class ta extends Ks{constructor(t){super(),this.name="TimelineValue",this._timeline=new Xs({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class ea{constructor(t,e){this.id=ea._eventId++;const n=Object.assign(ea.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:ao,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}ea._eventId=0;class na extends ea{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(na.getDefaults(),e);this.duration=new Yo(t.context,n.duration).valueOf(),this._interval=new Yo(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},ea.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Yo(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Yo(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Yo(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class ia extends Po{constructor(){super(Hs(ia.getDefaults(),arguments)),this.name="Transport",this._loop=new ta(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Xs,this._repeatedEvents=new $o,this._syncedSignals=[],this._swingAmount=0;const t=Hs(ia.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Jo({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),so(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(Po.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new Yo(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new ea(this,{callback:t,time:new Fo(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){const r=new na(this,{callback:t,duration:new Co(this.context,i).toTicks(),interval:new Co(this.context,e).toTicks(),time:new Fo(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(t,e){const n=new ea(this,{callback:t,once:!0,time:new Fo(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new Yo(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return bs(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Cs(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Co(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Co(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new Yo(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new Yo(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}const n=new No(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),oo(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}no.mixin(ia),Qs((t=>{t.transport=new ia({context:t})})),eo((t=>{t.transport.dispose()}));class ra extends Io{constructor(t){super(t),this.input=void 0,this._state=new Uo("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=ao,this._syncedStop=ao,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Zo({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,so(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Io.getDefaults(),{mute:!1,onstop:ao,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=ws(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(qs(e,0)),t.duration=n?this.toSeconds(n):void 0);const r=this.context.transport.schedule((t=>{this._start(t,e,n)}),i);this._scheduled.push(r),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else ms(this.context),this._start(i,e,n);else fs(zs(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=ws(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||bs(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,r)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=ao,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class sa extends ra{constructor(){super(Hs(sa.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=Hs(sa.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ra.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(fs(t in aa,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=aa[this._type];this._source=new jo({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const oa={brown:null,pink:null,white:null},aa={get brown(){if(!oa.brown){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(220500);t[e]=n;let i=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;n[t]=(i+.02*e)/1.02,i=n[t],n[t]*=3.5}}oa.brown=(new uo).fromArray(t)}return oa.brown},get pink(){if(!oa.pink){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(220500);let i,r,s,o,a,u,c;t[e]=n,i=r=s=o=a=u=c=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;i=.99886*i+.0555179*e,r=.99332*r+.0750759*e,s=.969*s+.153852*e,o=.8665*o+.3104856*e,a=.55*a+.5329522*e,u=-.7616*u-.016898*e,n[t]=i+r+s+o+a+u+c+.5362*e,n[t]*=.11,c=.115926*e}}oa.pink=(new uo).fromArray(t)}return oa.pink},get white(){if(!oa.white){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(220500);t[e]=n;for(let t=0;t<220500;t++)n[t]=2*Math.random()-1}oa.white=(new uo).fromArray(t)}return oa.white}};function ua(t,e){return Ds(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,i=new co(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0);return(yield i.render()).getChannelData(0)}))}class ca extends Lo{constructor(){super(Hs(ca.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=Hs(ca.getDefaults(),arguments,["frequency","type"]);Oo(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Ro({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Ro({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),so(this,["frequency","detune"])}static getDefaults(){return Object.assign(Lo.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class la extends ra{constructor(){super(Hs(la.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=Hs(la.getDefaults(),arguments,["frequency","type"]);this.frequency=new Ho({context:this.context,units:"frequency",value:t.frequency}),so(this,"frequency"),this.detune=new Ho({context:this.context,units:"cents",value:t.detune}),so(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(ra.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new ca({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return la._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}))}{const t=la._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(bs(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),la._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),la._periodicWaveCache.length>100&&la._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){gs(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),r=new Float32Array(n);let s=1;if("custom"===t){if(s=this._partials.length+1,this._partialCount=this._partials.length,n=s,0===this._partials.length)return[i,r]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(s=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],s=Math.max(s,2),n=s):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=s?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(i[o]=-a*Math.sin(e*o),r[o]=a*Math.cos(e*o)):(i[o]=0,r[o]=0)}return[i,r]}_inverseFFT(t,e,n){let i=0;const r=t.length;for(let s=0;s<r;s++)i+=t[s]*Math.cos(s*n)+e[s]*Math.sin(s*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let r=0;r<32;r++)n=Math.max(this._inverseFFT(t,e,r/32*i),n);return $s(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return Ds(this,void 0,void 0,(function*(){return ua(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}la._periodicWaveCache=[];class ha extends Io{constructor(){super(Object.assign(Hs(ha.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return qo(this,t,e,n),this}}class da extends ha{constructor(){super(Object.assign(Hs(da.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=Hs(da.getDefaults(),arguments,["mapping","length"]);Cs(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Ho.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,r=e;i<r;i++){const e=i/(r-1)*2-1;n[i]=t(e,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){fs(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class pa extends ha{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new da({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class fa extends Ho{constructor(){super(Object.assign(Hs(fa.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=Hs(fa.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new No({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ho.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class ga extends ra{constructor(){super(Hs(ga.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new pa({context:this.context}),this._modulationNode=new No({context:this.context});const t=Hs(ga.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new la({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new la({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new fa({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),so(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(la.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Ds(this,void 0,void 0,(function*(){return ua(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class ma extends ra{constructor(){super(Hs(ma.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new No({context:this.context,gain:0});const t=Hs(ma.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new la({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Ho({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new la({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new fa({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new fa({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),so(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(la.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Ds(this,void 0,void 0,(function*(){return ua(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class va extends ra{constructor(){super(Hs(va.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new No({context:this.context,gain:0}),this._thresh=new da({context:this.context,mapping:t=>t<=0?-1:1});const t=Hs(va.getDefaults(),arguments,["frequency","width"]);this.width=new Ho({context:this.context,units:"audioRange",value:t.width}),this._triangle=new la({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),so(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(ra.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return Ds(this,void 0,void 0,(function*(){return ua(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class ya extends ra{constructor(){super(Hs(ya.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=Hs(ya.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Ho({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Ho({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,so(this,["frequency","detune"])}static getDefaults(){return Object.assign(la.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,i)=>t.detune.value=e+n*i))}}get count(){return this._oscillators.length}set count(t){if(gs(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new la({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):ao});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return Ds(this,void 0,void 0,(function*(){return ua(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class _a extends ra{constructor(){super(Hs(_a.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new fa({context:this.context,value:2});const t=Hs(_a.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new va({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new la({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),so(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(ra.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return Ds(this,void 0,void 0,(function*(){return ua(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const wa={am:ga,fat:ya,fm:ma,oscillator:la,pulse:va,pwm:_a};class ba extends ra{constructor(){super(Hs(ba.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=Hs(ba.getDefaults(),arguments,["frequency","type"]);this.frequency=new Ho({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Ho({context:this.context,units:"cents",value:t.detune}),so(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(la.getDefaults(),ma.getDefaults(),ga.getDefaults(),ya.getDefaults(),va.getDefaults(),_a.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=wa[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof wa[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&xs(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&xs(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Es(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return Ds(this,void 0,void 0,(function*(){return ua(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class xa extends Ho{constructor(){super(Object.assign(Hs(xa.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new No({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Do(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Ho.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class Sa extends ha{constructor(){super(Object.assign(Hs(Sa.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=Hs(Sa.getDefaults(),arguments,["min","max"]);this._mult=this.input=new fa({context:this.context,value:t.max-t.min}),this._add=this.output=new xa({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(ha.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class Ta extends ha{constructor(){super(Object.assign(Hs(Ta.getDefaults(),arguments))),this.name="Zero",this._gain=new No({context:this.context}),this.output=this._gain,this.input=void 0,Oo(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),Mo(this.context.getConstant(0),this._gain),this}}class Ca extends Io{constructor(){super(Hs(Ca.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=Ro.prototype._fromType,this._toType=Ro.prototype._toType,this._is=Ro.prototype._is,this._clampValue=Ro.prototype._clampValue;const t=Hs(Ca.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new la(t),this.frequency=this._oscillator.frequency,this._amplitudeGain=new No({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Ho({context:this.context,units:"audioRange",value:0}),this._zeros=new Ta({context:this.context}),this._a2g=new pa({context:this.context}),this._scaler=this.output=new Sa({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),so(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(la.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(t){this._oscillator.partials=t,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._setStoppedValue()}get units(){return this._units}set units(t){const e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}get state(){return this._oscillator.state}connect(t,e,n){return(t instanceof Ro||t instanceof Ho)&&(this.convert=t.convert,this.units=t.units),qo(this,t,e,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function Ea(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){gs(i,t,e),n.set(this,i)}})}}function Aa(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){gs(this.toSeconds(i),t,e),n.set(this,i)}})}}class ka extends ra{constructor(){super(Hs(ka.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=Hs(ka.getDefaults(),arguments,["url","onload"]);this._buffer=new uo({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ra.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:ao,onerror:ao,playbackRate:1,reverse:!1})}load(t){return Ds(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=ao){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?qs(e,this._loopStart):qs(e,0);const i=this.toSeconds(e),r=n;n=qs(n,Math.max(this._buffer.duration-i,0));let s=this.toSeconds(n);s/=this._playbackRate,t=this.toSeconds(t);const o=new jo({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+s),this._state.setStateAtTime("stopped",t+s,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&ws(r)?o.start(t,i):o.start(t,i,s-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&gs(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&gs(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}Is([Aa(0)],ka.prototype,"fadeIn",void 0),Is([Aa(0)],ka.prototype,"fadeOut",void 0);class Fa extends ha{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new da({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Pa extends Io{constructor(){super(Hs(Pa.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Ho({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=Hs(Pa.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Io.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Es(t))return t;{let n;for(n in Ra)if(Ra[n][e]===t)return n;return t}}_setCurve(t,e,n){if(Es(n)&&Reflect.has(Ra,n)){const i=Ra[n];Ss(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!Cs(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){fs(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),r=this.getValueAtTime(t);if(r>0){n=(1-r)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=r&&r<=i[t]){i=this._attackCurve.slice(t),i[0]=r;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){const r=e*this.sustain,s=t+n;this.log("decay",s),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(r,i+s):this._sig.exponentialApproachValueAtTime(r,s,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(fs(Cs(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return qo(this,t,e,n),this}asArray(t=1024){return Ds(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new co(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=i+this.toSeconds(this.release),s=.1*r,o=r+s,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(i+s)/o,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}Is([Aa(0)],Pa.prototype,"attack",void 0),Is([Aa(0)],Pa.prototype,"decay",void 0),Is([Ea(0,1)],Pa.prototype,"sustain",void 0),Is([Aa(0)],Pa.prototype,"release",void 0);const Ra=(()=>{const t=128;let e,n;const i=[];for(e=0;e<t;e++)i[e]=Math.sin(e/127*(Math.PI/2));const r=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;r[e]=t/10+.83*n}r[127]=1;const s=[];for(e=0;e<t;e++)s[e]=Math.ceil(e/127*5)/5;const o=[];for(e=0;e<t;e++)n=e/127,o[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,i=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(i*(1-n))}function u(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:u(a),Out:a},cosine:{In:i,Out:(c=i,c.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:r,Out:u(r)},sine:{In:o,Out:u(o)},step:{In:s,Out:u(s)}};var c})();class Ia extends Io{constructor(){super(Hs(Ia.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=Hs(Ia.getDefaults(),arguments);this._volume=this.output=new Zo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,so(this,"volume")}static getDefaults(){return Object.assign(Io.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const i=t[e],r=this.context.transport.schedule((i=>{t[e]=i,n.apply(this,t)}),i);this._scheduledEvents.push(r)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const r=this.toSeconds(n),s=this.toSeconds(e);return this.triggerAttack(t,r,i),this.triggerRelease(r+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Da extends Ia{constructor(){super(Hs(Da.getDefaults(),arguments));const t=Hs(Da.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Ia.getDefaults(),{detune:0,onsilence:ao,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof Eo?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}Is([Aa(0)],Da.prototype,"portamento",void 0);class Oa extends Pa{constructor(){super(Hs(Oa.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new No({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Ma extends Da{constructor(){super(Hs(Ma.getDefaults(),arguments)),this.name="Synth";const t=Hs(Ma.getDefaults(),arguments);this.oscillator=new ba(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Oa(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),so(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Da.getDefaults(),{envelope:Object.assign(Ws(Pa.getDefaults(),Object.keys(Io.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ws(ba.getDefaults(),[...Object.keys(ra.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Na extends Ma{constructor(){super(Hs(Na.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=Hs(Na.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,so(this,["oscillator","envelope"])}static getDefaults(){return Vs(Da.getDefaults(),Ma.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof Eo?t.toFrequency():t),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Is([Ea(0)],Na.prototype,"octaves",void 0),Is([Aa(0)],Na.prototype,"pitchDecay",void 0);const La=new Set;function ja(t){La.add(t)}function Ba(t,e){const n=`registerProcessor("${t}", ${e})`;La.add(n)}class Ua extends Io{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=ao;const e=URL.createObjectURL(new Blob([Array.from(La).join("\n")],{type:"text/javascript"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,n).then((()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))}))}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}ja('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');ja("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");ja("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");Ba("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class Va extends Ia{constructor(){super(Hs(Va.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=Hs(Va.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const i=parseInt(n,10);if(fs(As(n)||xs(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),As(n)){const i=new Eo(this.context,n).toMidi();e[i]=t.urls[n]}else xs(i)&&isFinite(i)&&(e[i]=t.urls[i])})),this._buffers=new go({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Ia.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:ao,onerror:ao,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const i=xo(new Eo(this.context,t).toFrequency()),r=Math.round(i),s=i-r,o=this._findClosest(r),a=r-o,u=this._buffers.get(a),c=yo(o+s),l=new jo({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:c}).connect(this.output);l.start(e,0,u.duration/c,n),Cs(this._activeSources.get(r))||this._activeSources.set(r,[]),this._activeSources.get(r).push(l),l.onended=()=>{if(this._activeSources&&this._activeSources.has(r)){const t=this._activeSources.get(r),e=t.indexOf(l);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new Eo(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){const r=this.toSeconds(n);return this.triggerAttack(t,r,i),Cs(e)?(fs(Cs(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,r+this.toSeconds(i))}))):this.triggerRelease(t,r+this.toSeconds(e)),this}add(t,e,n){if(fs(As(t)||isFinite(t),`note must be a pitch or midi: ${t}`),As(t)){const i=new Eo(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}Is([Aa(0)],Va.prototype,"attack",void 0),Is([Aa(0)],Va.prototype,"release",void 0);class Ha extends Io{constructor(){super(Object.assign(Hs(Ha.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new Fa({context:this.context}),this.a=new No({context:this.context,gain:0}),this.b=new No({context:this.context,gain:0}),this.output=new No({context:this.context}),this._internalChannels=[this.a,this.b];const t=Hs(Ha.getDefaults(),arguments,["fade"]);this.fade=new Ho({context:this.context,units:"normalRange",value:t.fade}),so(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Oo(this._split,this.a.gain,0),Oo(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(Io.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class qa extends Io{constructor(t){super(t),this.name="Effect",this._dryWet=new Ha({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new No({context:this.context}),this.effectReturn=new No({context:this.context}),this.input=new No({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],so(this,"wet")}static getDefaults(){return Object.assign(Io.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class Wa extends Io{constructor(){super(Object.assign(Hs(Wa.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=Hs(Wa.getDefaults(),arguments,["pan"]);this.pan=new Ro({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",so(this,"pan")}static getDefaults(){return Object.assign(Io.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}Ba("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class Ka extends qa{constructor(){super(Hs(Ka.getDefaults(),arguments,["bits"])),this.name="BitCrusher";const t=Hs(Ka.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new za({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(qa.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class za extends Ua{constructor(){super(Hs(za.getDefaults(),arguments)),this.name="BitCrusherWorklet";const t=Hs(za.getDefaults(),arguments);this.input=new No({context:this.context}),this.output=new No({context:this.context}),this.bits=new Ro({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(Ua.getDefaults(),{bits:12})}_audioWorkletName(){return"bit-crusher"}onReady(t){Do(this.input,t,this.output);const e=t.parameters.get("bits");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class Ja extends Io{constructor(){super(Hs(Ja.getDefaults(),arguments,["channels"])),this.name="Split";const t=Hs(Ja.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(Io.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class Ga extends Io{constructor(){super(Hs(Ga.getDefaults(),arguments,["channels"])),this.name="Merge";const t=Hs(Ga.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(Io.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Ya extends qa{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new No({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,so(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(qa.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class $a extends Ya{constructor(){super(Hs($a.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=Hs($a.getDefaults(),arguments,["pitch"]);this._frequency=new Ho({context:this.context}),this._delayA=new Go({maxDelay:1,context:this.context}),this._lfoA=new Ca({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new Go({maxDelay:1,context:this.context}),this._lfoB=new Ca({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new Ha({context:this.context}),this._crossFadeLFO=new Ca({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new Go({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,so(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(Ya.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=yo(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=yo(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class Xa extends qa{constructor(){super(Hs(Xa.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=Hs(Xa.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(qa.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){gs(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){gs(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return Ds(this,void 0,void 0,(function*(){const t=this.ready,e=new co(2,this._decay+this._preDelay,this.context.sampleRate),n=new sa({context:e}),i=new sa({context:e}),r=new Ga({context:e});n.connect(r,0,0),i.connect(r,0,1);const s=new No({context:e}).toDestination();r.connect(s),n.start(0),i.start(0),s.gain.setValueAtTime(0,0),s.gain.setValueAtTime(1,this._preDelay),s.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=e.render();return this.ready=o.then(ao),yield t,this._convolver.buffer=(yield o).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class Za extends Io{constructor(){super(Hs(Za.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=Hs(Za.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new No({context:this.context}),this._split=new Ja({context:this.context,channels:t.channels}),this.input.connect(this._split),gs(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(Io.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach(((t,e)=>{const n=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(n):"waveform"===this._type&&t.getFloatTimeDomainData(n)})),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach(((e,n)=>{e.fftSize=2*t,this._buffers[n]=new Float32Array(t)}))}get channels(){return this._analysers.length}get type(){return this._type}set type(t){fs("waveform"===t||"fft"===t,`Analyser: invalid type: ${t}`),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach((e=>e.smoothingTimeConstant=t))}dispose(){return super.dispose(),this._analysers.forEach((t=>t.disconnect())),this._split.dispose(),this._gain.dispose(),this}}class Qa extends Io{constructor(){super(Hs(Qa.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new Za({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class tu extends Qa{constructor(){super(Hs(tu.getDefaults(),arguments,["size"])),this.name="FFT";const t=Hs(tu.getDefaults(),arguments,["size"]);this.normalRange=t.normalRange,this._analyser.type="fft",this.size=t.size}static getDefaults(){return Object.assign(Io.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map((t=>this.normalRange?mo(t):t))}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return fs(0<=t&&t<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),t*this.context.sampleRate/(2*this.size)}}class eu extends Io{constructor(){super(Hs(eu.getDefaults(),arguments,["solo"])),this.name="Solo";const t=Hs(eu.getDefaults(),arguments,["solo"]);this.input=this.output=new No({context:this.context}),eu._allSolos.has(this.context)||eu._allSolos.set(this.context,new Set),eu._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Io.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),eu._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){eu._soloed.has(this.context)||eu._soloed.set(this.context,new Set),eu._soloed.get(this.context).add(this)}_removeSolo(){eu._soloed.has(this.context)&&eu._soloed.get(this.context).delete(this)}_isSoloed(){return eu._soloed.has(this.context)&&eu._soloed.get(this.context).has(this)}_noSolos(){return!eu._soloed.has(this.context)||eu._soloed.has(this.context)&&0===eu._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),eu._allSolos.get(this.context).delete(this),this._removeSolo(),this}}eu._allSolos=new Map,eu._soloed=new Map;class nu extends Io{constructor(){super(Hs(nu.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=Hs(nu.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Wa({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Zo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,so(this,["pan","volume"])}static getDefaults(){return Object.assign(Io.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class iu extends Io{constructor(){super(Hs(iu.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=Hs(iu.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new eu({solo:t.solo,context:this.context}),this._panVol=this.output=new nu({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),so(this,["pan","volume"])}static getDefaults(){return Object.assign(Io.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return iu.buses.has(t)||iu.buses.set(t,new No({context:this.context})),iu.buses.get(t)}send(t,e=0){const n=this._getBus(t),i=new No({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}iu.buses=new Map;class ru extends Io{constructor(){super(...arguments),this.name="Listener",this.positionX=new Ro({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Ro({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Ro({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Ro({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Ro({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Ro({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Ro({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Ro({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Ro({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Io.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Qs((t=>{t.listener=new ru({context:t})})),eo((t=>{t.listener.dispose()}));function su(){return po().now()}const ou=po().transport;po().destination,po().destination;po().listener;po().draw;po();function au(){return uo.loaded()}var uu={};("function"==typeof define&&define.amd?define:function(t,e){uu?uu=e(s("6KOho")):window.toastr=e(window.jQuery)})(["jquery"],(function(t){return function(){var e,n,i,r=0,s="error",o="info",a="success",u="warning",c={clear:function(n,i){var r=f();e||l(r),h(n,r,i)||function(n){for(var i=e.children(),r=i.length-1;r>=0;r--)h(t(i[r]),n)}(r)},remove:function(n){var i=f();e||l(i),n&&0===t(":focus",n).length?g(n):e.children().length&&e.remove()},error:function(t,e,n){return p({type:s,iconClass:f().iconClasses.error,message:t,optionsOverride:n,title:e})},getContainer:l,info:function(t,e,n){return p({type:o,iconClass:f().iconClasses.info,message:t,optionsOverride:n,title:e})},options:{},subscribe:function(t){n=t},success:function(t,e,n){return p({type:a,iconClass:f().iconClasses.success,message:t,optionsOverride:n,title:e})},version:"2.1.4",warning:function(t,e,n){return p({type:u,iconClass:f().iconClasses.warning,message:t,optionsOverride:n,title:e})}};return c;function l(n,i){return n||(n=f()),(e=t("#"+n.containerId)).length||i&&(e=function(n){return(e=t("<div/>").attr("id",n.containerId).addClass(n.positionClass)).appendTo(t(n.target)),e}(n)),e}function h(e,n,i){var r=!(!i||!i.force)&&i.force;return!(!e||!r&&0!==t(":focus",e).length||(e[n.hideMethod]({duration:n.hideDuration,easing:n.hideEasing,complete:function(){g(e)}}),0))}function d(t){n&&n(t)}function p(n){var s=f(),o=n.iconClass||s.iconClass;if(void 0!==n.optionsOverride&&(s=t.extend(s,n.optionsOverride),o=n.optionsOverride.iconClass||o),!function(t,e){if(t.preventDuplicates){if(e.message===i)return!0;i=e.message}return!1}(s,n)){r++,e=l(s,!0);var a=null,u=t("<div/>"),c=t("<div/>"),h=t("<div/>"),p=t("<div/>"),m=t(s.closeHtml),v={intervalId:null,hideEta:null,maxHideTime:null},y={toastId:r,state:"visible",startTime:new Date,options:s,map:n};return n.iconClass&&u.addClass(s.toastClass).addClass(o),function(){if(n.title){var t=n.title;s.escapeHtml&&(t=_(n.title)),c.append(t).addClass(s.titleClass),u.append(c)}}(),function(){if(n.message){var t=n.message;s.escapeHtml&&(t=_(n.message)),h.append(t).addClass(s.messageClass),u.append(h)}}(),s.closeButton&&(m.addClass(s.closeClass).attr("role","button"),u.prepend(m)),s.progressBar&&(p.addClass(s.progressClass),u.prepend(p)),s.rtl&&u.addClass("rtl"),s.newestOnTop?e.prepend(u):e.append(u),function(){var t="";switch(n.iconClass){case"toast-success":case"toast-info":t="polite";break;default:t="assertive"}u.attr("aria-live",t)}(),u.hide(),u[s.showMethod]({duration:s.showDuration,easing:s.showEasing,complete:s.onShown}),s.timeOut>0&&(a=setTimeout(w,s.timeOut),v.maxHideTime=parseFloat(s.timeOut),v.hideEta=(new Date).getTime()+v.maxHideTime,s.progressBar&&(v.intervalId=setInterval(S,10))),s.closeOnHover&&u.hover(x,b),!s.onclick&&s.tapToDismiss&&u.click(w),s.closeButton&&m&&m.click((function(t){t.stopPropagation?t.stopPropagation():void 0!==t.cancelBubble&&!0!==t.cancelBubble&&(t.cancelBubble=!0),s.onCloseClick&&s.onCloseClick(t),w(!0)})),s.onclick&&u.click((function(t){s.onclick(t),w()})),d(y),s.debug&&console&&console.log(y),u}function _(t){return null==t&&(t=""),t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function w(e){var n=e&&!1!==s.closeMethod?s.closeMethod:s.hideMethod,i=e&&!1!==s.closeDuration?s.closeDuration:s.hideDuration,r=e&&!1!==s.closeEasing?s.closeEasing:s.hideEasing;if(!t(":focus",u).length||e)return clearTimeout(v.intervalId),u[n]({duration:i,easing:r,complete:function(){g(u),clearTimeout(a),s.onHidden&&"hidden"!==y.state&&s.onHidden(),y.state="hidden",y.endTime=new Date,d(y)}})}function b(){(s.timeOut>0||s.extendedTimeOut>0)&&(a=setTimeout(w,s.extendedTimeOut),v.maxHideTime=parseFloat(s.extendedTimeOut),v.hideEta=(new Date).getTime()+v.maxHideTime)}function x(){clearTimeout(a),v.hideEta=0,u.stop(!0,!0)[s.showMethod]({duration:s.showDuration,easing:s.showEasing})}function S(){var t=(v.hideEta-(new Date).getTime())/v.maxHideTime*100;p.width(t+"%")}}function f(){return t.extend({},{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:void 0,closeMethod:!1,closeDuration:!1,closeEasing:!1,closeOnHover:!0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",escapeHtml:!1,target:"body",closeHtml:'<button type="button">&times;</button>',closeClass:"toast-close-button",newestOnTop:!0,preventDuplicates:!1,progressBar:!1,progressClass:"toast-progress",rtl:!1},c.options)}function g(t){e||(e=l()),t.is(":visible")||(t.remove(),t=null,0===e.children().length&&(e.remove(),i=void 0))}}()}));class cu{static async createFile(t){let e=t.substring(t.lastIndexOf("/")+1),n=await fetch(t),i=await n.blob();return new File([i],e)}static async getFileFromUrl(t,e,n="audio/mp3"){const i=await fetch(t),r=await i.blob();return new File([r],e,{type:r.type||n})}static async getFileFromUrl2(t,e="audio/mp3"){const n=await fetch(t),i=await n.blob();return new File([i],"test",{type:i.type||e})}static getFileName(t){return t.substring(t.lastIndexOf("/")+1)}static getCursorPosition(t,e){const n=t.getBoundingClientRect();return e.clientX-n.left}static getScaledValue(t,e,n,i,r){return(t-e)*(r-i)/(n-e)+i}static getColorValue(t){let e;switch(t){case"primary":e="#fffa29";break;case"pink":e="#ffb3b3";break;case"blue":e="#5684f5";break;case"green":e="#5bf099"}return e}}let lu;(lu||(lu={})).Error=class{static show(t){e(uu).error(t)}};class hu{delete=()=>{};render(t){return this.color||(this.color=cu.getColorValue("primary")),d("div",{class:"patch-panel"},d("div",{class:"patch-top-bar",style:`background:${this.color}`},d("h3",{class:"title"},this.name)),d("div",{class:"d-flex",style:"margin:10px;"},d("div",{class:"d-flex row"},t)))}}class du{delete=()=>{};render(t){return this.color||(this.color=cu.getColorValue("primary")),d("div",{class:"patch-panel d-block"},d("div",{class:"patch-top-bar",style:`background:${this.color}`},d("h3",{class:"title"},this.name)),d("div",{style:"padding:10px;"},t))}}class pu{render(t){return d("div",{class:"d-flex align-center mr-2"},t,d("p",{class:"text-align-center"},this.name))}}class fu{init(){return this.masterChannel=(new iu).toDestination(),this.FFT=new tu,this.masterChannel.connect(this.FFT),this.masterChannel}}class gu{constructor(t,e){this.parentObject=t,this.toMaster=e}setVolume(t){this.channel.volume.value=t}setPan(t){this.channel.pan.value=t}init(){return this.channel=new iu(0),1==this.toMaster?this.connectToParent(Uu.Application.masterChannel):this.connectToParent(this.parentObject.channel),this.channel}connectToParent(t){this.channel.connect(t)}setupDefaultUI(){this.color||(this.color="#fff");let t=d("input",{type:"range","data-diameter":"30",min:"-10",max:"10",value:"0",class:"input-knob mr-1","data-bgcolor":this.color});t.addEventListener("input",(t=>{let e=t.target,n=parseInt(e.value);this.setVolume(n)}));let e=d(pu,{name:"Volume"},t),n=d("input",{type:"range","data-diameter":"30",min:"-5",max:"5",value:"0",step:"0.1",class:"input-knob mr-1","data-bgcolor":this.color});n.addEventListener("input",(t=>{let e=t.target,n=parseInt(e.value);this.setPan(n)}));let i=d(pu,{name:"Pan"},n);return d(hu,{name:"Channel Mixer",color:this.color},e,i)}}class mu{PadColors=["primary","blue","green","pink"]}var vu={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let yu;const _u=new Uint8Array(16);function wu(){if(!yu&&(yu="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!yu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return yu(_u)}const bu=[];for(let t=0;t<256;++t)bu.push((t+256).toString(16).slice(1));function xu(t,e=0){return(bu[t[e+0]]+bu[t[e+1]]+bu[t[e+2]]+bu[t[e+3]]+"-"+bu[t[e+4]]+bu[t[e+5]]+"-"+bu[t[e+6]]+bu[t[e+7]]+"-"+bu[t[e+8]]+bu[t[e+9]]+"-"+bu[t[e+10]]+bu[t[e+11]]+bu[t[e+12]]+bu[t[e+13]]+bu[t[e+14]]+bu[t[e+15]]).toLowerCase()}var Su=function(t,e,n){if(vu.randomUUID&&!e&&!t)return vu.randomUUID();const i=(t=t||{}).random||(t.rng||wu)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=i[t];return e}return xu(i)};Array.prototype.max=function(){return Math.max.apply(null,this)};class Tu{static SoundCloudWaveform={settings:{canvas_width:453,canvas_height:66,bar_width:3,bar_gap:.2,wave_color:"#666",download:!1,onComplete:function(t,e){}},audioContext:new AudioContext,generate:function(t,e){this.settings.canvas=document.createElement("canvas"),this.settings.context=this.settings.canvas.getContext("2d"),this.settings.canvas.width=void 0!==e.canvas_width?parseInt(e.canvas_width):this.settings.canvas_width,this.settings.canvas.height=void 0!==e.canvas_height?parseInt(e.canvas_height):this.settings.canvas_height,this.settings.wave_color=void 0!==e.wave_color?e.wave_color:this.settings.wave_color,this.settings.bar_width=void 0!==e.bar_width?parseInt(e.bar_width):this.settings.bar_width,this.settings.bar_gap=void 0!==e.bar_gap?parseFloat(e.bar_gap):this.settings.bar_gap,this.settings.download=void 0!==e.download?e.download:this.settings.download,this.settings.onComplete=void 0!==e.onComplete?e.onComplete:this.settings.onComplete;var n=new FileReader;n.onload=function(t){Tu.SoundCloudWaveform.audioContext.decodeAudioData(t.target.result,(function(t){Tu.SoundCloudWaveform.extractBuffer(t)}))},n.readAsArrayBuffer(t)},extractBuffer:function(t){t=t.getChannelData(0);for(var e=this.settings.canvas.width,n=Math.floor(t.length/e),i=this.settings.canvas.height,r=[],s=0;s<e;s+=this.settings.bar_width)r.push(1e4*this.bufferMeasure(s*n,n,t));for(var o=0;o<e;o+=this.settings.bar_width){var a=i/r.max(),u=1e4*this.bufferMeasure(o*n,n,t);u*=a,u+=1,this.drawBar(o,u)}this.settings.download&&this.generateImage(),this.settings.onComplete(this.settings.canvas.toDataURL("image/png"),this.settings.context.getImageData(0,0,this.settings.canvas.width,this.settings.canvas.height)),this.settings.context.clearRect(0,0,this.settings.canvas.width,this.settings.canvas.height)},bufferMeasure:function(t,e,n){for(var i=0,r=t;r<=t+e-1;r++)i+=Math.pow(n[r],2);return Math.sqrt(i/n.length)},drawBar:function(t,e){this.settings.context.fillStyle=this.settings.wave_color;var n=this.settings.bar_width;0!==this.settings.bar_gap&&(n*=Math.abs(1-this.settings.bar_gap));var i=t+n/2,r=this.settings.canvas.height-e;this.settings.context.fillRect(i,r,n,e)},generateImage:function(){var t=this.settings.canvas.toDataURL("image/png"),e=document.createElement("a");e.href=t,e.setAttribute("download",""),e.click()}}}class Cu{render(t){return d("div",{class:"d-flex w-100 border-bottom"},d("div",{class:"d-flex flex-1",style:"padding:10px"},d("div",{class:"name-area d-flex flex-1 align-center"},d("p",{class:"text-align-center"},this.name)),d("div",{class:"module-effects-area"},t)))}}let Eu=["Reverb","BitCrush","PitchShift"];class Au{stack=[];delete=()=>{};toggleEffect(t,e){let n=t.target,i=!1;for(let t of this.stack.entries()){let n=t[0];t[1].name==e&&(i=!0,t[1].HTMLItem.remove(),this.stack.splice(n))}i?(this.disconnect(e),this.chain(),i=!1,n.classList.add("inactive")):(this.add(e),n.classList.remove("inactive"))}add(t){switch(t){case"Reverb":this.initReverb();break;case"BitCrush":this.initBitCrush();break;case"PitchShift":this.initPitchShift()}this.chain()}initPitchShift(){let t=d("input",{type:"range","data-diameter":"30",min:"-24",max:"24",value:"0",step:"0.1",class:"input-knob","data-bgcolor":this.color});t.addEventListener("change",(()=>{this.pitchShift.pitch=parseInt(t.value)}));let e=d(Cu,{name:"Pitch Shift"},d(pu,{name:"Pitch"},d("div",null,t)));this.effectsList.append(e),this.pitchShift=new $a(0),Oo(this.channel,this.pitchShift);let n={name:"PitchShift",node:this.pitchShift,HTMLItem:e};this.stack.push(n)}initReverb(){let t=d("input",{type:"range","data-diameter":"30",min:"1",max:"20",value:"1",class:"input-knob","data-bgcolor":this.color});t.addEventListener("change",(()=>{this.reverb.decay=t.value}));let e=d(Cu,{name:"Reverb"},d(pu,{name:"Decay"},d("div",null,t)));this.effectsList.append(e),this.reverb=new Xa(.1),Oo(this.channel,this.reverb);let n={name:"Reverb",node:this.reverb,HTMLItem:e};this.stack.push(n)}initBitCrush(){let t=d("input",{type:"range","data-diameter":"30",min:"1",max:"8",value:"1",class:"input-knob","data-bgcolor":this.color});t.addEventListener("change",(()=>{this.bitCrush.set({bits:parseInt(t.value)})}));let e=d(Cu,{name:"BitCrusher"},d(pu,{name:"Bits"},d("div",null,t)));this.effectsList.append(e),this.bitCrush=new Ka(1),Oo(this.channel,this.bitCrush);let n={name:"BitCrush",node:this.bitCrush,HTMLItem:e};this.stack.push(n)}chain(){let t=[],e=this.stack.entries();for(let n of e)n&&t.push(n[1].node);this.channel.connect(this.destination),this.channel.disconnect(this.destination),this.channel.chain(...t,this.destination)}disconnect(t){Mo(this.channel,t)}solo(){}setup(){let t=[];return Eu.forEach((e=>{let n=d("button",{class:"effect-button inactive",style:`background:${this.color}`,onclick:t=>{this.toggleEffect(t,e)}},e);t.push(n)})),d("div",{class:"effects-button-wrapper",style:`background:${this.color}40`},t)}render(t){let e=this.setup();return this.color||(this.color=cu.getColorValue("primary")),this.effectsList=d("div",{class:"d-flex column effects-item-list"}),d("div",{class:"patch-panel"},d("div",{class:"patch-top-bar",style:`background:${this.color}`},d("h3",{class:"title"},this.name)),d("div",{class:"d-flex effects-view-container"},this.effectsList,d("div",{class:"effects-button-list"},e)))}}let ku=["Single","PianoRoll"],Fu=["Sampler","Synth"];class Pu{padGroups=[];groupLimit=4;padColors=Uu.Application.config.PadColors;constructor(t){this.parent=t}async init(){this.buttonContainer=d("div",{class:"button-group-group"}),this.parent.append(this.buttonContainer);for(let t=0;t<this.groupLimit;t++){let e=new Ru(t,this.parent,this.buttonContainer,this.padColors[t]);await e.init(),e.groupButton.onclick=()=>{this.selectGroup(e)},this.padGroups.push(e)}return this.activeGroup=this.padGroups[0],document.querySelector(".group-button").classList.remove("inactive"),!0}selectGroup(t){this.render(t),this.activeGroup.padManager.activePad&&(this.activeGroup.padManager.activePad.padContext.classList.add("d-none"),this.activeGroup.padManager.activePad=null)}render(t){this.padGroups.forEach((t=>{t.groupContainer.classList.add("d-none")})),t.groupContainer.classList.remove("d-none")}}class Ru{constructor(t,e,n,i){this.index=t,this.parent=e,this.buttonParent=n,this.color=i,this.colorHex=cu.getColorValue(this.color)}contextContainer=document.getElementById("context-container");async init(){let t=new gu(Uu.Application.masterChannel,!0);t.color=this.colorHex;let e=t.setupDefaultUI();return this.channel=t.init(),this.groupContainer=d("div",{class:"group-container"}),this.parent.append(this.groupContainer),this.groupContext=d("div",{class:"pad-context d-none"}),this.groupContext.append(e),this.contextContainer.append(this.groupContext),this.padManager=new Iu(this.groupContainer,this.color),this.padManager.channel=this.channel,await this.padManager.init(),this.groupButton=d("button",{class:`group-button inactive ${this.color}`},`G${this.index+1}`),this.buttonParent.append(this.groupButton),this.groupButton.addEventListener("contextmenu",(t=>{t.preventDefault();this.padManager})),this.groupButton.addEventListener("click",(()=>{document.querySelectorAll(".group-button").forEach((t=>{t.classList.add("inactive")})),this.groupButton.classList.remove("inactive"),this.renderContext()})),this.initEffectsStack(),!0}renderContext(){document.querySelectorAll(".pad-context").forEach((t=>{t.classList.add("d-none")})),this.groupContext.classList.remove("d-none")}initEffectsStack(){this.effectsStack=new Mu(this.channel,this.groupContext,Uu.Application.masterChannel,this.color),this.effectsStack.render()}async render(){}}class Iu{type="PadManager";singlePadContainer=d("div",{class:"pad-array standard-sort"});singlePadArray=[];pianoPadContainer=d("div",{class:"pad-array reverse-sort",style:"display:none"});pianoPadArray=[];activePad=null;lastPad=null;mode="Single";keyList=["KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma"];renderedSingles=0;constructor(t,e){this.parent=t,this.color=e}async init(){this.parent.prepend(this.pianoPadContainer),this.parent.prepend(this.singlePadContainer),this.renderMode("Single"),ku.forEach((t=>{let e=d("button",{id:`${t}-mode-toggle`,class:`default-button ${this.color} mode-toggle inactive d-none`},t);e.addEventListener("click",(()=>{document.querySelectorAll(".mode-toggle").forEach((t=>{t.classList.add("inactive")})),e.classList.remove("inactive"),this.mode=t,this.renderMode(this.mode)})),this.parent.prepend(e)}));document.getElementById("Single-mode-toggle").classList.remove("inactive");for(let t=0;t<16;t++){this.addPad(t,"unloaded","Sampler")}return!0}addPad(t,e,n){let i=new Ou(t,n,this.singlePadContainer,e,this.channel,this.color,this);return i.init(),this.singlePadArray.push(i),this.bindPad(i),i}bindKeys(){this.singlePadArray.forEach(((t,e)=>{t.HTMLElement.dataset.key=this.keyList[e]})),this.singlePadArray.forEach(((t,e)=>{document.addEventListener("keypress",(n=>{if(n.code==this.keyList[e]){if(!t.activeComponent)return;if(!t.activeComponent.isReady)return;if(t.isPlaying)return;t.play()}})),document.addEventListener("keyup",(n=>{if(n.code==this.keyList[e]){if(!t.isPlaying)return;t.stop()}}))}))}unbindKeys(){}bindPad(t){t.HTMLElement.onmousedown=()=>{Uu.Application.activePad=t,console.log("Active Pad:",Uu.Application.activePad),this.activePad=t,this.render(t),t.renderContext(),Uu.Application.activePad.activeComponent?Uu.Application.toggleRightContent("Context"):Uu.Application.toggleRightContent("Explorer"),t.activeComponent&&t.activeComponent.isReady&&t.play()},t.HTMLElement.onmouseup=()=>{t.activeComponent&&t.activeComponent.isReady&&t.stop()},this.renderedSingles++,16==this.renderedSingles&&this.bindKeys()}render(t){document.querySelectorAll(".pad").forEach((t=>{t.classList.remove("selected")})),t.HTMLElement.classList.add("selected")}renderMode(t){if("Single"==t&&(this.singlePadContainer.style.display="flex",this.pianoPadContainer.style.display="none"),"PianoRoll"==t){if(!this.activePad)return void window.alert("Please select a Pad.");if(!this.activePad.activeComponent.isReady)return void window.alert("Please Load a patch");if(this.singlePadContainer.style.display="none",this.pianoPadContainer.style.display="flex",this.activePad){let t=16;this.pianoPadContainer.innerHTML="";let e=this.activePad.activeComponent.getContext(),n=(new $a).toDestination(),i=e.currentFile,r=URL.createObjectURL(i),s=new ka({url:r,loop:!0});au().then((t=>{s.connect(n),s.loopStart=e.loopStart}));let o=3;for(let e=0;e<t;e++){let t=o,e=d("button",{class:"pad"},"Pitch "+t.toString());this.pianoPadContainer.append(e),e.onmousedown=()=>{n.pitch=t,s.start()},e.onmouseup=()=>{s.stop()},o--}}}}}var Du;Du=new URL(s("27Lyk").resolve("h651o"),import.meta.url).toString();class Ou{type="Pad";contextContainer=document.getElementById("context-container");isReady=!1;isPlaying=!1;constructor(t,e,n,i,r,s,o){this.id=Su(),this.index=t,this.component=e,this.container=n,this.name=i,this.parentChannel=r,this.color=s,this.padManager=o}renderPad(){this.activeComponentContext=d("div",null),this.padContext=d("div",{class:"pad-context d-none"},this.activeComponentContext),this.contextContainer.append(this.padContext);let t=cu.getColorValue(this.color),e=t=>{let e=t.target;this.channel.volume.value=parseInt(e.value)},n=d("div",{class:"slider",style:"width:10%"},d("input",{type:"range",min:"-10",max:"10",value:this.channel.volume.value,class:"input-slider","data-width":"8","data-height":"140","data-bgcolor":`${t}20`,"data-fgcolor":t,oninput:t=>{e(t)}}));n.value=this.channel.volume.value.toString();let i=d("div",{class:"content",style:"width:90%;height: 100%;display: flex;justify-content: center;align-items: center;"},d("h3",{class:"pad-content-name"},this.name)),r=d("button",{"data-id":this.id,class:`pad ${this.color}`,"data-key":"",style:"display:flex; padding:0px"},i,n);this.HTMLElement=r,this.container.appendChild(this.HTMLElement),r.addEventListener("dragover",(t=>{t.preventDefault()}));let s=!1;r.addEventListener("dragenter",(t=>{if(1==s)return;s=!0;new URL(Du);let e=d("label",{class:"file-drop"},"Drop to Load");r.prepend(e),e.addEventListener("drop",(t=>{t.preventDefault();let n=t.dataTransfer.files;if(0===n.length)return;this.removeActiveComponent(this);let i=[...n],r=(this.index,new Nu(this,this.channel));r.addComponent(this.HTMLElement,this.activeComponentContext),this.activeComponent=r,this.isReady=!0,s=!1,e.remove(),r.registerFileToPlayer(i[0]).then((()=>{this.activeComponent.isReady=!0,console.warn("Context:",this.padContext),this.renderContext()}))})),e.addEventListener("dragleave",(()=>{s=!1,e.remove()})),setTimeout((()=>{s=!1,e.remove()}),1e3)}))}renderContext(){document.querySelectorAll(".pad-context").forEach((t=>{t.classList.add("d-none")})),this.padContext.classList.remove("d-none")}initContext(){}play(){this.activeComponent.play(),this.isPlaying=!0}stop(){this.activeComponent.stop(),this.isPlaying=!1,ou.stop()}init(){this.initChannel(),this.renderPad(),this.initContext(),this.HTMLElement.addEventListener("contextmenu",(t=>{t.preventDefault()}))}initEffectsStack(t){this.effectsStack=new Mu(t,this.padContext,this.channel,this.color),this.effectsStack.render()}initChannel(){this.channel=new gu(this.padManager,!1).init()}addComponent(t,e){}removeActiveComponent(t){if(null==t.activeComponent)return;delete t.activeComponent,t.activeComponent=null,t.activeComponentContext.innerHTML="",this.HTMLElement.classList.remove("loaded"),this.HTMLElement.querySelector(".content").textContent="unloaded"}renderComponentSelector(){let t=[];Fu.forEach((e=>{let n={type:e,element:d("button",null,e)};console.warn(n.element),t.push(n)})),t.forEach((t=>{let e=t.element;e.addEventListener("click",(()=>{console.warn(t.element),this.addComponent(t.type,this)})),Uu.Application.contextContainer.appendChild(e)}))}}class Mu{constructor(t,e,n,i){this.channel=t,this.context=e,this.destination=n,this.color=i}stack=[];render(){let t=d(Au,{channel:this.channel,destination:this.destination,context:this.context,color:cu.getColorValue(this.color),name:"Effects"});this.context.appendChild(t)}}class Nu{type="Sampler";isReady=!1;sliceStart=0;startTime=0;constructor(t,e){this.pad=t,this.channel=e}clone(t){const e=new t.constructor;return Object.assign(e,t),e}renderContext(){document.querySelectorAll(".pad-context").forEach((t=>{t.classList.add("d-none")})),this.padContext.classList.remove("d-none"),this.isReady}getContext(){return this.clone(this)}bindPad(){}unbindPad(){this.HTMLElement.onmousedown=()=>{},this.HTMLElement.onmouseup=()=>{}}async registerFileToPlayer(t){this.currentFile=t;let e=URL.createObjectURL(t),n=new ka({url:e}).connect(this.channel);au().then((async t=>{this.player=n,await this.drawSampler(this.player,this.padContext),this.pad.effectsStack||this.pad.initEffectsStack(this.player),this.HTMLElement.classList.add("loaded");let e=this.HTMLElement.querySelector(".content");e.innerHTML="";let i=d("h3",{class:"pad-content-name"},this.currentFile.name);e.prepend(i),this.isReady=!0}))}play(){this.player.start(0,this.startTime)}stop(){this.player.stop()}async drawSampler(t,e){let n=this,i=cu.getColorValue(this.pad.color),r=d("div",null),s=d("button",{class:`default-button ${this.pad.color}`},"Unload Component");this.padContext.prepend(s),s.addEventListener("click",(()=>{this.pad.removeActiveComponent(this.pad)}));let o=d(du,{name:"Sampler Component",color:i},s,r);this.padContext.append(o),Tu.SoundCloudWaveform.generate(this.currentFile,{onComplete:function(e,s){let o=document.createElement("canvas"),a=d("h3",null,"Kimbo ",d("span",{class:n.pad.color},"Slice"));r.appendChild(a),r.appendChild(o);let u=o.getContext("2d"),c=o.getBoundingClientRect().width,l=o.getBoundingClientRect().height;u.putImageData(s,0,0),u.fillStyle=i+"60",u.fillRect(n.sliceStart,0,c,l),o.addEventListener("mousedown",(e=>{let r=cu.getCursorPosition(o,e),a=t.buffer.length*t.sampleTime,h=cu.getScaledValue(r,0,c,0,a);u.fillStyle=i+"60",u.clearRect(0,0,o.width,o.height),u.putImageData(s,0,0),u.fillRect(r,0,c-r,l),n.sliceStart=r,n.startTime=h.toFixed(5),n.play()})),o.addEventListener("mouseup",(()=>{t.stop()})),n.isReady=!0}})}addComponent(t,e){this.padContext=e,this.HTMLElement=t,this.bindPad()}}var Lu;Lu=new URL(s("27Lyk").resolve("hA8qP"),import.meta.url).toString();var ju;ju=new URL(s("27Lyk").resolve("020Q8"),import.meta.url).toString();const Bu=s("chAV5");let Uu;window.AudioContext=window.AudioContext||window.AudioContext,function(t){class e{constructor(){}static config=new mu;static contextContainer=document.getElementById("context-container");static contextToggle=document.getElementById("context-button-show");static contextWrapper=document.getElementById("context-wrapper");static browserToggle=document.getElementById("resource-button-show");static browserWrapper=document.getElementById("browser-wrapper");async initVertex(){this._clientID="1212a395-b812-42de-a5c5-3fcace6b5c80",this._redirectURI="http://localhost:3000/",this.stackHost="vertx.cloud",Vertex.Globals.vertexStackUrl=this.stackHost,this.auth=new c,await this.auth.initAsync({vertxStackHost:this.stackHost,redirectUri:this._redirectURI,clientId:this._clientID});const t=await this.auth.getUserAsync();if(!!t&&!t.expired){let n=(e=/worldId=(.*)/.exec(window.location.href)[1],Vertex.Globals.spaceId=e,e);this.initVertex(t,n)}else await this.auth.redirectToSignIn({mode:"prompt"});var e;Vertex.Globals.bearerToken=t.access_token,Vertex.Globals.spaceId=spaceId,Vertex.Globals.event.on("vertex:registerComponentSystems",(async t=>{Vertex.Globals.event.fire("vertex:componentRegistrationComplete")}))}drawSythPadLegacy(){let t=document.getElementById("main-container"),e="3",n=(parseInt(e)+1).toString(),i=["C3","C#3","D3","D#3","E3","F3","F#3","G3","G#3","A3","A#3","B3",`C${n}`,`C#${n}`,`D${n}`,`D#${n}`].reverse(),r=d("div",{id:"pad-array",class:"pad-array"});for(let t=0;t<i.length;t++){let e=i[t],n=d("button",{class:"pad","data-note":e},e),s=(new Ma).toDestination(),o=!1,a=su();n.onmousedown=()=>{s.triggerAttack(e,a),o=!0,n.classList.add("active")},n.onmouseup=()=>{s.triggerRelease(),o=!1,n.classList.remove("active")},n.addEventListener,r.appendChild(n)}t.prepend(r)}setVersionNumber(){let t=document.getElementById("version-number"),e="v-"+Bu.version;t.innerText=e}static toggleRightContent(t){"Context"==t&&(Uu.Application.contextToggle.classList.remove("inactive"),Uu.Application.browserToggle.classList.add("inactive"),Uu.Application.contextWrapper.classList.remove("d-none"),Uu.Application.browserWrapper.classList.add("d-none")),"Explorer"==t&&(Uu.Application.contextToggle.classList.add("inactive"),Uu.Application.browserToggle.classList.remove("inactive"),Uu.Application.contextWrapper.classList.add("d-none"),Uu.Application.browserWrapper.classList.remove("d-none"))}async init(){let t=new fu;Uu.Application.masterChannel=t.init(),Uu.Application.masterFFT=t.FFT;let e=document.getElementById("main-container");Uu.Application.contextToggle.addEventListener("click",(()=>{Uu.Application.toggleRightContent("Context")})),Uu.Application.browserToggle.addEventListener("click",(()=>{Uu.Application.toggleRightContent("Explorer")}));Uu.Application.activePad;let n=new Pu(e);await n.init()&&n.selectGroup(n.padGroups[0])}}t.Application=e}(Uu||(Uu={}));const Vu=new Uu.Application;Vu.setVersionNumber(),Vu.init();
//# sourceMappingURL=index.98b81278.js.map
